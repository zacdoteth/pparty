<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>PREDICTION PARTY</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ═══════════════════════════════════════════════════════════════
       PREDICTION PARTY — The Turntable.fm for Crypto Prediction Markets
       Neo-Tokyo Underground Nightclub Aesthetic
    ═══════════════════════════════════════════════════════════════ */

    :root {
      /* Neo-Tokyo Palette — Black to match logo */
      --bg-dark: #000000;
      --bg-mid: #0a0a12;
      --bg-light: #0f0f1a;

      /* Neon Accents — Matching the logo colors! */
      --neon-cyan: #4da6ff;  /* Neon blue from logo */
      --neon-pink: #ff4b9b;  /* Neon pink from logo */
      --neon-red: #ff3366;
      --neon-green: #39ff14;
      --neon-purple: #bf00ff;
      --neon-gold: #ffd700;

      /* Kalshi Brand */
      --kalshi-teal: #00d46a;
      --kalshi-teal-dark: #00a854;

      /* Party Brand — Match logo neon colors */
      --party-yes: var(--neon-cyan);
      --party-no: var(--neon-pink);

      /* UI */
      --glass: rgba(255, 255, 255, 0.08);
      --glass-border: rgba(255, 255, 255, 0.15);
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.7);
      --text-muted: rgba(255, 255, 255, 0.4);

      /* Animation */
      --bounce: cubic-bezier(0.25, 1.5, 0.5, 1);
      --smooth: cubic-bezier(0.4, 0, 0.2, 1);
      --bpm: 128;
      --beat: calc(60s / var(--bpm));

      /* Safe Areas */
      --safe-top: env(safe-area-inset-top, 20px);
      --safe-bottom: env(safe-area-inset-bottom, 34px);

      /* Responsive Layout */
      --sidebar-width: 360px;
      --arena-min-width: 500px;
      --desktop-breakpoint: 769px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: 'Space Grotesk', -apple-system, sans-serif;
      /* Deep club gradient - seamless with the party */
      background: radial-gradient(ellipse at 50% 0%, #1a0a2e 0%, #0a0612 50%, #000000 100%);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
    }

    /* ═══════════════════════════════════════════════════════════════
       APP CONTAINER — Transparent so global lights shine through!
    ═══════════════════════════════════════════════════════════════ */
    .app {
      width: 100%;
      max-width: 500px; /* Mobile: centered narrow */
      height: 100vh;
      height: 100dvh;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
    }

    /* ═══════════════════════════════════════════════════════════════
       DESKTOP LAYOUT — Sidebar + Main Arena (turntable.fm vibes!)
    ═══════════════════════════════════════════════════════════════ */
    @media (min-width: 769px) {
      .app {
        max-width: 1400px;
        display: grid;
        grid-template-columns: var(--sidebar-width) 1fr;
        grid-template-rows: 1fr;
        gap: 0;
        margin: 0 auto;
      }

      /* Desktop: Home screen becomes sidebar - FIXED WIDTH! */
      .home-screen {
        position: relative;
        opacity: 1;
        pointer-events: auto;
        grid-column: 1;
        grid-row: 1;
        display: flex;
        flex-direction: column;
        padding-bottom: 0;
        border-right: 1px solid rgba(0, 245, 255, 0.15);
        background: linear-gradient(180deg, rgba(10, 6, 18, 0.98) 0%, rgba(5, 3, 10, 0.99) 100%);
        /* CRITICAL: Lock sidebar width so it doesn't stretch! */
        width: var(--sidebar-width);
        min-width: var(--sidebar-width);
        max-width: var(--sidebar-width);
        overflow-x: hidden;
      }

      /* Desktop: Arena is always visible on right */
      .arena-screen {
        position: relative;
        opacity: 1;
        pointer-events: auto;
        grid-column: 2;
        grid-row: 1;
        min-width: 0; /* Prevent grid blowout */
      }

      /* Desktop: NUKE the mobile tab bar - use !important to override inline styles */
      .tab-bar {
        display: none !important;
        visibility: hidden !important;
        pointer-events: none !important;
      }

      /* Desktop: Screen base styles don't apply */
      .screen {
        position: relative;
        inset: auto;
      }
    }

    /* Screens */
    .screen {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .screen.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* ═══════════════════════════════════════════════════════════════
       HOME SCREEN — Matching the logo's black background
    ═══════════════════════════════════════════════════════════════ */
    .home-screen {
      padding: calc(var(--safe-top)) 0 calc(80px + var(--safe-bottom));
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      background: transparent;
    }

    /* ═══════════════════════════════════════════════════════════════
       HOMEPAGE PARTY VIBES — Real Club Spotlights
    ═══════════════════════════════════════════════════════════════ */
    .home-party-vibes {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    /* Atmospheric Haze/Fog Layer */
    .home-haze {
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at 50% 0%, rgba(138, 43, 226, 0.08) 0%, transparent 60%),
                  radial-gradient(ellipse at 20% 50%, rgba(0, 245, 255, 0.05) 0%, transparent 50%),
                  radial-gradient(ellipse at 80% 50%, rgba(255, 0, 128, 0.05) 0%, transparent 50%);
      animation: haze-pulse 8s ease-in-out infinite;
    }

    @keyframes haze-pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* Stage Spotlight — Dramatic Conic Beams */
    .home-spotlight {
      position: absolute;
      top: -10%;
      width: 200px;
      height: 140%;
      transform-origin: 50% 0%;
      opacity: 0.35;
      mix-blend-mode: screen;
    }

    /* Spotlight Beam Shape — Wide cone */
    .home-spotlight::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 100%;
      background: inherit;
      clip-path: polygon(40% 0%, 60% 0%, 100% 100%, 0% 100%);
      filter: blur(2px);
    }

    /* Spotlight Glow Core */
    .home-spotlight::after {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 20px;
      background: inherit;
      border-radius: 50%;
      filter: blur(10px);
      opacity: 0.8;
    }

    /* Left Cyan Spotlight */
    .home-spotlight.cyan {
      left: 5%;
      background: linear-gradient(180deg,
        rgba(0, 245, 255, 1) 0%,
        rgba(0, 245, 255, 0.6) 20%,
        rgba(0, 245, 255, 0.2) 60%,
        transparent 100%
      );
      animation: spotlight-sweep-left 6s ease-in-out infinite;
    }

    .home-spotlight.cyan::before {
      background: linear-gradient(180deg,
        rgba(0, 245, 255, 0.9) 0%,
        rgba(0, 245, 255, 0.4) 40%,
        rgba(0, 245, 255, 0.1) 70%,
        transparent 100%
      );
      width: 100%;
    }

    /* Right Pink Spotlight */
    .home-spotlight.pink {
      right: 5%;
      left: auto;
      background: linear-gradient(180deg,
        rgba(255, 0, 128, 1) 0%,
        rgba(255, 0, 128, 0.6) 20%,
        rgba(255, 0, 128, 0.2) 60%,
        transparent 100%
      );
      animation: spotlight-sweep-right 7s ease-in-out infinite;
      animation-delay: -2s;
    }

    .home-spotlight.pink::before {
      background: linear-gradient(180deg,
        rgba(255, 0, 128, 0.9) 0%,
        rgba(255, 0, 128, 0.4) 40%,
        rgba(255, 0, 128, 0.1) 70%,
        transparent 100%
      );
      width: 100%;
    }

    /* Center Purple Spotlight */
    .home-spotlight.purple {
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(180deg,
        rgba(191, 0, 255, 1) 0%,
        rgba(191, 0, 255, 0.5) 20%,
        rgba(191, 0, 255, 0.15) 60%,
        transparent 100%
      );
      animation: spotlight-sweep-center 8s ease-in-out infinite;
      animation-delay: -4s;
      opacity: 0.25;
    }

    .home-spotlight.purple::before {
      background: linear-gradient(180deg,
        rgba(191, 0, 255, 0.8) 0%,
        rgba(191, 0, 255, 0.3) 40%,
        rgba(191, 0, 255, 0.1) 70%,
        transparent 100%
      );
      width: 100%;
    }

    /* Extra Gold Accent Spotlight */
    .home-spotlight.gold {
      left: 30%;
      background: linear-gradient(180deg,
        rgba(255, 215, 0, 0.9) 0%,
        rgba(255, 215, 0, 0.4) 20%,
        rgba(255, 215, 0, 0.1) 60%,
        transparent 100%
      );
      animation: spotlight-sweep-accent 9s ease-in-out infinite;
      animation-delay: -1s;
      opacity: 0.2;
      width: 150px;
    }

    .home-spotlight.gold::before {
      background: linear-gradient(180deg,
        rgba(255, 215, 0, 0.7) 0%,
        rgba(255, 215, 0, 0.2) 50%,
        transparent 100%
      );
      width: 100%;
    }

    @keyframes spotlight-sweep-left {
      0%, 100% {
        transform: rotate(-25deg);
        opacity: 0.25;
      }
      50% {
        transform: rotate(15deg);
        opacity: 0.4;
      }
    }

    @keyframes spotlight-sweep-right {
      0%, 100% {
        transform: rotate(25deg);
        opacity: 0.25;
      }
      50% {
        transform: rotate(-15deg);
        opacity: 0.4;
      }
    }

    @keyframes spotlight-sweep-center {
      0%, 100% {
        transform: translateX(-50%) rotate(-8deg);
        opacity: 0.2;
      }
      50% {
        transform: translateX(-50%) rotate(8deg);
        opacity: 0.3;
      }
    }

    @keyframes spotlight-sweep-accent {
      0%, 100% {
        transform: rotate(-15deg);
        opacity: 0.15;
      }
      30% {
        transform: rotate(20deg);
        opacity: 0.25;
      }
      70% {
        transform: rotate(-10deg);
        opacity: 0.2;
      }
    }

    /* Floor Glow — Light hitting the ground */
    .home-floor-glow {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 40%;
      background: linear-gradient(0deg,
        rgba(138, 43, 226, 0.1) 0%,
        transparent 100%
      );
      animation: floor-glow-pulse 4s ease-in-out infinite;
    }

    @keyframes floor-glow-pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 0.8; }
    }

    /* Disco Ball Reflections */
    .home-disco-dots {
      position: absolute;
      inset: 0;
      overflow: hidden;
    }

    .disco-dot {
      position: absolute;
      width: 6px;
      height: 6px;
      background: white;
      border-radius: 50%;
      opacity: 0;
      animation: disco-dot-float 4s ease-in-out infinite;
    }

    .disco-dot:nth-child(1) { left: 10%; top: 20%; animation-delay: 0s; }
    .disco-dot:nth-child(2) { left: 25%; top: 45%; animation-delay: -0.5s; }
    .disco-dot:nth-child(3) { left: 45%; top: 15%; animation-delay: -1s; }
    .disco-dot:nth-child(4) { left: 60%; top: 55%; animation-delay: -1.5s; }
    .disco-dot:nth-child(5) { left: 75%; top: 30%; animation-delay: -2s; }
    .disco-dot:nth-child(6) { left: 85%; top: 60%; animation-delay: -2.5s; }
    .disco-dot:nth-child(7) { left: 15%; top: 70%; animation-delay: -3s; }
    .disco-dot:nth-child(8) { left: 55%; top: 75%; animation-delay: -3.5s; }

    @keyframes disco-dot-float {
      0%, 100% {
        opacity: 0;
        transform: translate(0, 0) scale(0.5);
      }
      20% {
        opacity: 0.8;
        transform: translate(10px, -15px) scale(1);
      }
      40% {
        opacity: 0.4;
        transform: translate(25px, -5px) scale(0.8);
      }
      60% {
        opacity: 0.7;
        transform: translate(15px, 10px) scale(1.1);
      }
      80% {
        opacity: 0.3;
        transform: translate(5px, 5px) scale(0.6);
      }
    }

    /* Lens Flare — Top of screen */
    .home-lens-flare {
      position: absolute;
      top: 5%;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: 100px;
      background: radial-gradient(ellipse at center,
        rgba(255, 255, 255, 0.15) 0%,
        rgba(255, 255, 255, 0.05) 30%,
        transparent 70%
      );
      animation: lens-flare-pulse 5s ease-in-out infinite;
    }

    @keyframes lens-flare-pulse {
      0%, 100% { opacity: 0.3; transform: translateX(-50%) scale(1); }
      50% { opacity: 0.6; transform: translateX(-50%) scale(1.1); }
    }

    /* Secondary Spotlights */
    .home-spotlight.cyan-2 {
      left: 15%;
      background: linear-gradient(180deg,
        rgba(0, 200, 255, 0.9) 0%,
        rgba(0, 200, 255, 0.4) 30%,
        rgba(0, 200, 255, 0.1) 70%,
        transparent 100%
      );
      animation: spotlight-sweep-left 5s ease-in-out infinite;
      animation-delay: -1.5s;
      opacity: 0.25;
      width: 180px;
    }

    .home-spotlight.pink-2 {
      right: 15%;
      left: auto;
      background: linear-gradient(180deg,
        rgba(255, 50, 150, 0.9) 0%,
        rgba(255, 50, 150, 0.4) 30%,
        rgba(255, 50, 150, 0.1) 70%,
        transparent 100%
      );
      animation: spotlight-sweep-right 5.5s ease-in-out infinite;
      animation-delay: -0.5s;
      opacity: 0.25;
      width: 180px;
    }

    /* Home Laser Beams — Sharp Neon Lines */
    .home-laser {
      position: absolute;
      top: 0;
      width: 2px;
      height: 120%;
      transform-origin: 50% 0%;
      opacity: 0.5;
    }

    .home-laser::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      height: 100%;
      background: inherit;
      filter: blur(1px);
    }

    .home-laser.cyan-1 {
      left: 20%;
      background: linear-gradient(180deg, var(--neon-cyan), transparent 80%);
      box-shadow: 0 0 8px var(--neon-cyan), 0 0 20px var(--neon-cyan);
      animation: laser-sweep-1 3s ease-in-out infinite;
    }

    .home-laser.cyan-2 {
      left: 30%;
      background: linear-gradient(180deg, var(--neon-cyan), transparent 70%);
      box-shadow: 0 0 6px var(--neon-cyan);
      animation: laser-sweep-1 3.5s ease-in-out infinite;
      animation-delay: -1s;
      opacity: 0.35;
    }

    .home-laser.pink-1 {
      right: 20%;
      left: auto;
      background: linear-gradient(180deg, var(--neon-pink), transparent 80%);
      box-shadow: 0 0 8px var(--neon-pink), 0 0 20px var(--neon-pink);
      animation: laser-sweep-2 3.2s ease-in-out infinite;
    }

    .home-laser.pink-2 {
      right: 30%;
      left: auto;
      background: linear-gradient(180deg, var(--neon-pink), transparent 70%);
      box-shadow: 0 0 6px var(--neon-pink);
      animation: laser-sweep-2 4s ease-in-out infinite;
      animation-delay: -1.5s;
      opacity: 0.35;
    }

    .home-laser.purple {
      left: 50%;
      background: linear-gradient(180deg, var(--neon-purple), transparent 60%);
      box-shadow: 0 0 10px var(--neon-purple);
      animation: laser-sweep-3 5s ease-in-out infinite;
      opacity: 0.4;
    }

    @keyframes laser-sweep-1 {
      0%, 100% { transform: rotate(-20deg); }
      50% { transform: rotate(15deg); }
    }

    @keyframes laser-sweep-2 {
      0%, 100% { transform: rotate(20deg); }
      50% { transform: rotate(-15deg); }
    }

    @keyframes laser-sweep-3 {
      0%, 100% { transform: rotate(-8deg); }
      50% { transform: rotate(8deg); }
    }

    .home-screen::-webkit-scrollbar { width: 3px; }
    .home-screen::-webkit-scrollbar-track { background: transparent; }
    .home-screen::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 2px; }

    /* Hero Section — Sophisticated Logo Treatment */
    .hero {
      text-align: center;
      padding: 16px 0 8px 0;
      margin: 0 0 4px 0;
      position: relative;
      z-index: 1;
    }

    /* Logo Container — Premium Glass Treatment */
    .logo-container {
      position: relative;
      display: inline-block;
      padding: 12px 24px;
      margin: 0 auto;
      overflow: hidden; /* Contain the shine sweep */
      /* Subtle glass morphism - NOT overdone */
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.03) 0%,
        rgba(255, 255, 255, 0.01) 50%,
        rgba(0, 0, 0, 0.02) 100%
      );
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      /* Soft ambient glow */
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }

    /* Animated glow ring behind logo */
    .logo-container::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 80%;
      height: 80%;
      transform: translate(-50%, -50%);
      background: radial-gradient(
        ellipse at center,
        rgba(77, 166, 255, 0.15) 0%,
        rgba(255, 75, 155, 0.08) 40%,
        transparent 70%
      );
      filter: blur(20px);
      animation: logo-glow-pulse 4s ease-in-out infinite;
      pointer-events: none;
      z-index: -1;
    }

    @keyframes logo-glow-pulse {
      0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
      50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    }

    .logo-image {
      /* Sophisticated sizing - readable but refined */
      width: 180px;
      max-width: 200px;
      height: auto;
      display: block;
      margin: 0 auto;
      /* EXPERT BLENDING: Screen mode for luminous effect */
      mix-blend-mode: screen;
      /* Multi-layer glow for depth */
      filter:
        drop-shadow(0 0 2px rgba(255, 255, 255, 0.9))
        drop-shadow(0 0 8px rgba(77, 166, 255, 0.6))
        drop-shadow(0 0 20px rgba(77, 166, 255, 0.3))
        drop-shadow(0 0 40px rgba(255, 75, 155, 0.15));
      /* Slight contrast boost for crispness */
      image-rendering: -webkit-optimize-contrast;
    }

    /* Hover state for interactivity */
    .logo-container:hover .logo-image {
      filter:
        drop-shadow(0 0 2px rgba(255, 255, 255, 1))
        drop-shadow(0 0 12px rgba(77, 166, 255, 0.8))
        drop-shadow(0 0 30px rgba(77, 166, 255, 0.4))
        drop-shadow(0 0 50px rgba(255, 75, 155, 0.25));
      transition: filter 0.3s ease;
    }

    /* Premium shine sweep effect */
    .logo-container::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 60%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.08) 50%,
        transparent 100%
      );
      transform: skewX(-20deg);
      animation: logo-shine 6s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes logo-shine {
      0%, 100% { left: -100%; opacity: 0; }
      50% { opacity: 1; }
      80% { left: 150%; opacity: 0; }
    }

    /* Tagline styling if present */
    .hero .tagline {
      font-size: 11px;
      letter-spacing: 3px;
      text-transform: uppercase;
      color: rgba(255, 255, 255, 0.5);
      margin-top: 8px;
      font-weight: 500;
    }

    /* Section Headers */
    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 12px 0 10px;
      padding: 0 16px;
      position: relative;
      z-index: 1;
    }

    /* Desktop nav - hidden on mobile */
    .desktop-nav {
      display: none;
    }

    .section-title {
      font-size: 16px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #fff;
    }

    .section-title .icon {
      font-size: 18px;
      filter: drop-shadow(0 0 8px currentColor);
    }

    .see-all {
      font-size: 12px;
      color: var(--neon-cyan);
      background: rgba(0, 245, 255, 0.1);
      border: 1px solid rgba(0, 245, 255, 0.3);
      border-radius: 100px;
      padding: 6px 12px;
      cursor: pointer;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      transition: all 0.2s ease;
    }

    .see-all:active {
      transform: scale(0.95);
      background: rgba(0, 245, 255, 0.2);
    }

    /* Market Cards — Nightclub VIP Rooms */
    .market-grid {
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 0 16px;
      position: relative;
      z-index: 1;
    }

    .market-card {
      background: linear-gradient(135deg,
        rgba(20, 18, 35, 0.95) 0%,
        rgba(10, 8, 20, 0.98) 100%
      );
      border: 1px solid rgba(77, 166, 255, 0.15);
      border-radius: 16px;
      padding: 14px;
      cursor: pointer;
      transition: all 0.2s var(--bounce);
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5),
                  inset 0 1px 0 rgba(255, 255, 255, 0.03);
    }

    .market-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple));
      opacity: 0.6;
    }

    .market-card::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at 80% 20%, rgba(0, 245, 255, 0.1) 0%, transparent 50%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .market-card:active {
      transform: scale(0.98);
      border-color: var(--neon-cyan);
    }

    .market-card:active::after {
      opacity: 1;
    }

    .market-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .market-question {
      font-size: 14px;
      font-weight: 600;
      line-height: 1.4;
      flex: 1;
      padding-right: 12px;
      color: #fff;
    }

    .market-live {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 10px;
      color: var(--neon-green);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 4px 8px;
      background: rgba(57, 255, 20, 0.15);
      border-radius: 100px;
      border: 1px solid rgba(57, 255, 20, 0.3);
    }

    .live-dot {
      width: 5px;
      height: 5px;
      background: var(--neon-green);
      border-radius: 50%;
      animation: pulse 1s ease infinite;
      box-shadow: 0 0 8px var(--neon-green);
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); box-shadow: 0 0 8px var(--neon-green); }
      50% { opacity: 0.7; transform: scale(0.9); box-shadow: 0 0 4px var(--neon-green); }
    }

    .market-stats {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
    }

    .stat-pill {
      padding: 6px 14px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .stat-pill.yes {
      background: linear-gradient(135deg, rgba(0, 245, 255, 0.2), rgba(0, 200, 220, 0.15));
      color: var(--neon-cyan);
      border: 1px solid rgba(0, 245, 255, 0.3);
      box-shadow: 0 0 12px rgba(0, 245, 255, 0.2);
    }

    .stat-pill.no {
      background: linear-gradient(135deg, rgba(255, 0, 128, 0.2), rgba(200, 0, 100, 0.15));
      color: var(--neon-pink);
      border: 1px solid rgba(255, 0, 128, 0.3);
      box-shadow: 0 0 12px rgba(255, 0, 128, 0.2);
    }

    /* Card Progress Bars — Matching Arena Style */
    .card-scores {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 10px;
    }

    .card-score-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card-source-label {
      font-size: 8px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      width: 38px;
      text-align: right;
      color: var(--text-secondary);
    }

    .card-score-row.kalshi .card-source-label { color: var(--kalshi-teal); }
    .card-score-row.party .card-source-label { color: var(--party-yes); }

    .card-progress-bar {
      flex: 1;
      height: 12px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 6px;
      overflow: hidden;
      display: flex;
    }

    .card-fill-yes {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding-left: 6px;
      transition: width 0.5s var(--bounce);
      position: relative;
      overflow: hidden;
    }

    /* Card shimmer effect */
    .card-fill-yes::after,
    .card-fill-no::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.4) 50%,
        transparent 100%
      );
      animation: shimmer 2.5s ease-in-out infinite;
    }

    .card-fill-no {
      height: 100%;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 6px;
      position: relative;
      overflow: hidden;
    }

    .card-fill-no::after {
      animation-delay: 0.8s;
    }

    .card-percent {
      font-size: 8px;
      font-weight: 700;
      color: #fff;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
      position: relative;
      z-index: 1;
    }

    /* Kalshi style */
    .card-score-row.kalshi .card-fill-yes {
      background: linear-gradient(90deg, var(--kalshi-teal), #00b85a);
    }
    .card-score-row.kalshi .card-fill-no {
      background: linear-gradient(90deg, #008844, var(--kalshi-teal-dark));
      opacity: 0.5;
    }

    /* Party style - neon blue/pink matching logo */
    .card-score-row.party .card-fill-yes {
      background: linear-gradient(90deg, var(--party-yes), #00d0e8);
      box-shadow: 0 0 8px rgba(77, 166, 255, 0.3);
    }
    .card-score-row.party .card-fill-no {
      background: linear-gradient(90deg, var(--party-no), #e8005a);
    }

    .market-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .market-crowd {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .crowd-avatars {
      display: flex;
    }

    .crowd-avatars .mini-avatar {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      border: 2px solid var(--bg-dark);
      margin-left: -6px;
      box-shadow: 0 0 8px rgba(0, 245, 255, 0.3);
      background-color: #0a0a12; /* Dark fallback */
      position: relative;
    }

    /* Vignette for mini avatars too */
    .crowd-avatars .mini-avatar::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: radial-gradient(
        circle at center,
        transparent 35%,
        rgba(0, 0, 0, 0.4) 80%,
        rgba(0, 0, 0, 0.7) 100%
      );
      pointer-events: none;
    }

    .crowd-avatars .mini-avatar:first-child {
      margin-left: 0;
    }

    .crowd-count {
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .market-volume {
      font-size: 11px;
      color: var(--neon-gold);
      font-weight: 600;
    }

    .vol-label {
      font-size: 9px;
      color: var(--text-secondary);
      font-weight: 500;
      opacity: 0.7;
      margin-left: 2px;
    }

    /* Party Score Badge — VIP Status */
    .party-score {
      position: absolute;
      top: -1px;
      right: 12px;
      background: linear-gradient(180deg, var(--neon-green) 0%, #00a854 100%);
      color: #000;
      font-size: 10px;
      font-weight: 700;
      padding: 4px 10px 6px;
      border-radius: 0 0 8px 8px;
      display: flex;
      align-items: center;
      gap: 3px;
      box-shadow: 0 4px 12px rgba(57, 255, 20, 0.3);
    }

    /* ═══════════════════════════════════════════════════════════════
       NINTENDO JUICE — Bouncy, Playful, Delightful
    ═══════════════════════════════════════════════════════════════ */

    /* Staggered Card Entrance — Like Animal Crossing Menus */
    .market-card {
      opacity: 0;
      transform: translateY(30px) scale(0.95);
      animation: card-pop-in 0.5s var(--bounce) forwards;
    }

    .market-card:nth-child(1) { animation-delay: 0.05s; }
    .market-card:nth-child(2) { animation-delay: 0.1s; }
    .market-card:nth-child(3) { animation-delay: 0.15s; }
    .market-card:nth-child(4) { animation-delay: 0.2s; }
    .market-card:nth-child(5) { animation-delay: 0.25s; }
    .market-card:nth-child(6) { animation-delay: 0.3s; }

    @keyframes card-pop-in {
      0% {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
      }
      60% {
        opacity: 1;
        transform: translateY(-5px) scale(1.02);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Idle Breathing — Cards Feel Alive */
    .market-card {
      animation: card-pop-in 0.5s var(--bounce) forwards, card-breathe 4s ease-in-out infinite 1s;
    }

    @keyframes card-breathe {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-2px); }
    }

    /* Nintendo Hover — Bouncy Scale + Tilt */
    .market-card:hover {
      transform: scale(1.02) rotate(-0.5deg);
      box-shadow: 0 8px 30px rgba(0, 245, 255, 0.2),
                  0 0 20px rgba(0, 245, 255, 0.1);
      z-index: 10;
    }

    .market-card:hover::after {
      opacity: 1;
    }

    /* Shine Sweep on Hover — That Nintendo Polish */
    .market-card::before {
      transition: opacity 0.3s ease;
    }

    .market-card:hover::before {
      animation: shine-sweep 0.8s ease-out;
    }

    @keyframes shine-sweep {
      0% {
        opacity: 0.6;
        background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple));
      }
      50% {
        opacity: 1;
        background: linear-gradient(90deg, var(--neon-pink), var(--neon-cyan), var(--neon-pink));
      }
      100% {
        opacity: 0.6;
        background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink), var(--neon-purple));
      }
    }

    /* Press State — Satisfying Squish */
    .market-card:active {
      transform: scale(0.97) rotate(0deg) !important;
      transition: transform 0.1s ease !important;
    }

    /* Section Title — Playful Bounce */
    .section-title {
      animation: title-bounce 0.6s var(--bounce);
    }

    @keyframes title-bounce {
      0% { transform: translateX(-20px); opacity: 0; }
      60% { transform: translateX(5px); opacity: 1; }
      100% { transform: translateX(0); }
    }

    .section-title .icon {
      display: inline-block;
      animation: icon-wiggle 2s ease-in-out infinite;
    }

    @keyframes icon-wiggle {
      0%, 100% { transform: rotate(0deg) scale(1); }
      25% { transform: rotate(-10deg) scale(1.1); }
      75% { transform: rotate(10deg) scale(1.1); }
    }

    /* See All Button — Nintendo Bounce */
    .see-all {
      transition: all 0.2s var(--bounce);
      position: relative;
      overflow: hidden;
    }

    .see-all::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(0, 245, 255, 0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.4s ease, height 0.4s ease;
    }

    .see-all:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(0, 245, 255, 0.3);
    }

    .see-all:hover::before {
      width: 200%;
      height: 200%;
    }

    .see-all:active {
      transform: scale(0.95);
    }

    /* Party Score Badge — Bouncy Pop */
    .party-score {
      animation: badge-pop 0.4s var(--bounce) 0.3s both;
    }

    @keyframes badge-pop {
      0% { transform: translateY(-20px) scale(0); opacity: 0; }
      60% { transform: translateY(3px) scale(1.1); }
      100% { transform: translateY(0) scale(1); opacity: 1; }
    }

    /* Mini Avatars — Staggered Pop In */
    .crowd-avatars .mini-avatar {
      animation: avatar-pop 0.3s var(--bounce) both;
    }

    .crowd-avatars .mini-avatar:nth-child(1) { animation-delay: 0.4s; }
    .crowd-avatars .mini-avatar:nth-child(2) { animation-delay: 0.45s; }
    .crowd-avatars .mini-avatar:nth-child(3) { animation-delay: 0.5s; }

    @keyframes avatar-pop {
      0% { transform: scale(0); opacity: 0; }
      60% { transform: scale(1.2); }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Volume Text — Slide In */
    .market-volume {
      animation: slide-up 0.4s var(--bounce) 0.5s both;
    }

    @keyframes slide-up {
      0% { transform: translateY(10px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }

    /* Progress Bar Fill — Satisfying Grow */
    .card-fill-yes, .card-fill-no {
      animation: bar-grow 0.6s var(--bounce) 0.3s both;
      transform-origin: left center;
    }

    .card-fill-no {
      transform-origin: right center;
    }

    @keyframes bar-grow {
      0% { transform: scaleX(0); }
      100% { transform: scaleX(1); }
    }

    /* Logo — Refined Subtle Float */
    .logo-container {
      animation: logo-float 8s ease-in-out infinite;
    }

    @keyframes logo-float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
    }

    /* ═══════════════════════════════════════════════════════════════
       DESKTOP SIDEBAR — Markets List (Left Panel)
    ═══════════════════════════════════════════════════════════════ */
    @media (min-width: 769px) {
      /* Sidebar - NO scrollbar on whole sidebar! */
      .home-screen {
        overflow: hidden; /* Hide sidebar-level scroll */
        display: flex;
        flex-direction: column;
      }

      /* Only market-grid scrolls! */
      .market-grid {
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: rgba(77, 166, 255, 0.3) transparent;
      }

      .market-grid::-webkit-scrollbar {
        width: 6px;
      }

      .market-grid::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 3px;
      }

      .market-grid::-webkit-scrollbar-thumb {
        background: rgba(77, 166, 255, 0.4);
        border-radius: 3px;
      }

      .market-grid::-webkit-scrollbar-thumb:hover {
        background: rgba(77, 166, 255, 0.6);
      }

      /* Compact hero for sidebar - Logo stays in sidebar! */
      .hero {
        padding: 20px 16px 16px;
        flex-shrink: 0; /* Don't compress logo area */
        border-bottom: 1px solid rgba(77, 166, 255, 0.08);
        background: linear-gradient(180deg, rgba(15, 8, 30, 0.95) 0%, transparent 100%);
      }

      .hero .logo-container {
        padding: 10px 20px;
      }

      .hero .logo-image {
        width: 160px;
        max-width: 180px;
      }

      .hero .tagline {
        font-size: 10px;
        margin-top: 6px;
      }

      /* Market grid in sidebar */
      .market-grid {
        padding: 0 12px;
        gap: 10px;
        flex: 1;
      }

      /* More compact market cards */
      .market-card {
        padding: 12px;
        border-radius: 12px;
      }

      .market-question {
        font-size: 13px;
        line-height: 1.3;
      }

      .market-card-header {
        margin-bottom: 8px;
      }

      .market-stats {
        margin-bottom: 8px;
      }

      .stat-pill {
        padding: 4px 10px;
        font-size: 12px;
      }

      /* Selected market highlight */
      .market-card.active {
        border: 2px solid var(--neon-cyan);
        box-shadow: 0 0 25px rgba(0, 245, 255, 0.4),
                    0 0 50px rgba(0, 245, 255, 0.2),
                    inset 0 0 20px rgba(0, 245, 255, 0.1);
        transform: scale(1.02);
      }

      .market-card.active::before {
        opacity: 1;
        animation: active-glow 2s ease-in-out infinite;
      }

      @keyframes active-glow {
        0%, 100% { opacity: 0.8; }
        50% { opacity: 1; }
      }

      /* Section headers for sidebar */
      .section-header {
        padding: 12px 12px 8px;
      }

      .section-title {
        font-size: 14px;
      }

      /* Desktop navigation tabs at bottom of sidebar */
      .desktop-nav {
        display: flex;
        justify-content: space-around;
        padding: 12px 8px;
        border-top: 1px solid rgba(0, 245, 255, 0.15);
        background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
        margin-top: auto;
      }

      .desktop-nav .tab-btn {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        padding: 10px 8px;
        background: transparent;
        border: 1px solid transparent;
        border-radius: 10px;
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .desktop-nav .tab-btn:hover {
        background: rgba(77, 166, 255, 0.1);
        color: var(--text-primary);
      }

      .desktop-nav .tab-btn.active {
        background: rgba(77, 166, 255, 0.15);
        border-color: rgba(77, 166, 255, 0.3);
        color: var(--neon-cyan);
      }

      .desktop-nav .icon {
        font-size: 20px;
      }

      .desktop-nav .label {
        font-size: 10px;
        font-weight: 600;
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       DESKTOP ARENA — Epic Main Stage (Right Panel)
    ═══════════════════════════════════════════════════════════════ */
    @media (min-width: 769px) {
      .arena-screen {
        background: radial-gradient(ellipse at 50% 30%, #1a0a2e 0%, #0a0612 40%, #000000 100%);
        min-height: 100%;
      }

      /* DESKTOP: Hide the top header completely - info now in marquee! */
      .arena-header {
        display: none !important;
      }

      /* DESKTOP: Hide scores container - now integrated in marquee sign! */
      .scores-container {
        display: none !important;
      }

      .nav-btn {
        padding: 10px 16px;
        min-width: 70px;
      }

      .nav-icon {
        font-size: 22px;
      }

      .nav-label {
        font-size: 10px;
      }

      .market-title-bar .market-title {
        font-size: 20px;
      }

      /* ═══════════════════════════════════════════════════════════════
         EPIC DESKTOP % BARS — Nintendo-Level Visual Impact!
      ═══════════════════════════════════════════════════════════════ */
      .scores-container {
        gap: 10px;
        margin-bottom: 10px;
        padding: 0 24px;
      }

      .score-row {
        gap: 12px;
      }

      .score-source-label {
        font-size: 10px;
        width: 50px;
        letter-spacing: 1px;
      }

      .score-progress-bar {
        height: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3),
                    inset 0 1px 2px rgba(255, 255, 255, 0.1);
      }

      .score-percent {
        font-size: 11px;
        padding: 0 8px;
      }

      .score-fill-yes, .score-fill-no {
        box-shadow: 0 0 15px currentColor;
      }

      .score-row.party .score-fill-yes {
        box-shadow: 0 0 20px rgba(77, 166, 255, 0.6);
      }

      .score-row.party .score-fill-no {
        box-shadow: 0 0 15px rgba(255, 0, 128, 0.4);
      }

      /* HIDE the roof header on desktop - marquee IS the header! */
      .stage-roof {
        display: none !important;
      }

      /* OG Marquee sign - The SOULFUL one with chase lights! */
      .marquee-sign {
        top: 8px; /* Flush to top */
        transform: translateX(-50%);
      }

      .marquee-frame {
        border-radius: 16px;
        padding: 12px 24px;
      }

      .marquee-content {
        padding: 12px 24px;
        gap: 24px;
      }

      .marquee-center {
        min-width: 320px;
      }

      /* BIGGER text on marquee! */
      .marquee-question {
        font-size: 20px;
        letter-spacing: 1px;
      }

      .marquee-vote-icon {
        font-size: 32px;
      }

      /* Marquee bars - match sidebar style exactly */
      .marquee-bars {
        margin-top: 12px;
        gap: 8px;
      }

      .marquee-bar-row {
        gap: 12px;
      }

      .marquee-bar-label {
        font-size: 10px;
        width: 50px;
        font-weight: 700;
      }

      .marquee-bar-container {
        height: 14px;
        border-radius: 7px;
      }

      .marquee-bar-pct {
        font-size: 12px;
        font-weight: 800;
        width: 40px;
      }

      /* HIDE the sterile Jumbotron - we want the OG marquee! */
      .jumbotron {
        display: none !important;
      }

      /* DJ Booth — Below the marquee sign */
      .dj-booth-visual {
        top: 180px; /* Closer to marquee */
      }

      /* Nightclub takes full space */
      .nightclub {
        flex: 1;
      }

      /* ISOMETRIC DANCE FLOOR — Desktop Sizing */
      .dance-floor {
        top: 260px; /* Below DJ booth */
        bottom: 40px;
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        width: 85%;
        max-width: 700px;
        height: auto;
        max-height: none;
        padding: 0;
      }

      .iso-grid-wrapper {
        transform: rotateX(55deg) rotateZ(-45deg);
      }

      /* Larger zone labels */
      .zone-label {
        font-size: 18px;
        top: -50px;
      }

      .floor-score {
        font-size: 32px;
        bottom: -40px;
      }

      /* Bigger crowd avatars! */
      .villager-avatar {
        transform: scale(1.3);
      }

      .crowd-area {
        gap: 16px;
      }

      /* Larger player */
      .player-container {
        transform: scale(1.25) translateX(-40%);
      }

      .player-container.at-door {
        transform: scale(1.25) translateX(-40%);
      }

      /* Bigger player dock */
      .player-dock {
        width: 110px;
        height: 110px;
      }

      .drag-hint {
        font-size: 11px;
      }

      /* Control deck spacing */
      .control-deck {
        padding: 20px 24px 24px;
      }

      /* DJ booth more prominent */
      .dj-booth {
        padding: 20px 32px;
      }

      .booth-left-deck, .booth-right-deck {
        transform: scale(1.1);
      }

      .booth-center .market-question-display {
        font-size: 24px;
        max-width: 400px;
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       ULTRA-WIDE DESKTOP — Maximum Epic
    ═══════════════════════════════════════════════════════════════ */
    @media (min-width: 1200px) {
      /* Dance floor - even more spacious floating stage */
      .dance-floor {
        left: 32px;
        right: 32px;
        max-height: 800px;
        border-radius: 28px;
        padding: 20px;
        gap: 10px;
      }

      .floor-zone {
        border-radius: 20px;
      }

      .villager-avatar {
        transform: scale(1.5);
      }

      .crowd-area {
        gap: 24px;
        padding: 20px;
      }

      .zone-label {
        font-size: 40px;
      }

      .floor-score {
        font-size: 28px;
        padding: 12px 28px;
      }

      .booth-center .market-question-display {
        font-size: 28px;
        max-width: 500px;
      }

      .player-container {
        transform: scale(1.4) translateX(-36%);
      }

      .player-dock {
        width: 130px;
        height: 130px;
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       ARENA SCREEN — The Main Event
    ═══════════════════════════════════════════════════════════════ */
    .arena-screen {
      display: flex;
      flex-direction: column;
    }

    /* ═══════════════════════════════════════════════════════════════
       HABBO 2026: MAXIMUM MA — No nav, all room
       "The Roof is the Room. The Room is the World." — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .arena-header {
      display: none !important; /* GONE. Maximum Ma. */
    }

    .scores-container {
      display: none !important; /* Data lives on the wall screens now */
    }

    .nav-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      padding: 8px 12px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 12px;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s var(--bounce);
      min-width: 60px;
    }

    .nav-btn:active {
      transform: scale(0.92);
      background: rgba(255,255,255,0.15);
    }

    .nav-icon {
      font-size: 18px;
      line-height: 1;
    }

    .nav-label {
      font-size: 9px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-secondary);
    }

    /* HIDDEN: Title bar moved to marquee sign! */
    .market-title-bar {
      display: none; /* Info now shown in epic marquee sign */
    }

    .market-title-bar .market-title {
      font-size: 15px;
      font-weight: 700;
      line-height: 1.3;
      margin-bottom: 4px;
      background: linear-gradient(135deg, #fff, rgba(255,255,255,0.85));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .market-meta {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .live-indicator {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      background: rgba(255, 0, 128, 0.15);
      border: 1px solid rgba(255, 0, 128, 0.25);
      border-radius: 100px;
    }

    .live-indicator .live-dot {
      width: 5px;
      height: 5px;
      background: var(--neon-pink);
      border-radius: 50%;
      animation: pulse 1.5s ease infinite;
    }

    .live-text {
      font-size: 9px;
      font-weight: 700;
      color: var(--neon-pink);
      letter-spacing: 1px;
    }

    .countdown-clock {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      background: rgba(255, 215, 0, 0.15);
      border: 1px solid rgba(255, 215, 0, 0.25);
      border-radius: 100px;
    }

    .countdown-icon {
      font-size: 10px;
    }

    .countdown-time {
      font-size: 9px;
      font-weight: 700;
      color: var(--neon-gold);
      letter-spacing: 0.5px;
      font-family: 'SF Mono', 'Fira Code', monospace;
    }

    /* DJ Booth */
    .dj-booth {
      padding: calc(var(--safe-top) + 12px) 16px 16px;
      background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, transparent 100%);
      position: relative;
      z-index: 10;
    }

    .booth-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .back-btn {
      width: 40px;
      height: 40px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .back-btn:active {
      transform: scale(0.95);
      background: rgba(255,255,255,0.15);
    }

    .booth-live {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      background: rgba(255, 0, 128, 0.2);
      border: 1px solid rgba(255, 0, 128, 0.3);
      border-radius: 100px;
    }

    .booth-live-text {
      font-size: 12px;
      font-weight: 600;
      color: var(--neon-pink);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .booth-share {
      width: 40px;
      height: 40px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .market-info {
      text-align: center;
    }

    .market-title {
      font-size: 22px;
      font-weight: 700;
      line-height: 1.3;
      margin-bottom: 16px;
    }

    /* Score Display — Compact Progress Bars (Nintendo-Style) */
    .scores-container {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 4px;
      padding: 0 12px;
    }

    .score-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .score-source-label {
      font-size: 7px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      width: 32px;
      text-align: right;
      color: var(--text-secondary);
    }

    .score-source-label.kalshi { color: var(--kalshi-teal); }
    .score-source-label.party { color: var(--party-yes); }

    .score-progress-bar {
      flex: 1;
      height: 10px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 5px;
      overflow: hidden;
      display: flex;
      position: relative;
    }

    .score-fill-yes {
      height: 100%;
      background: linear-gradient(90deg, var(--neon-cyan), #00c8e0);
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding-left: 6px;
      transition: width 0.5s var(--bounce);
      position: relative;
      overflow: hidden;
    }

    /* ALIVE SHIMMER EFFECT! */
    .score-fill-yes::after,
    .score-fill-no::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.3) 50%,
        transparent 100%
      );
      animation: shimmer 2s ease-in-out infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 200%; }
    }

    .score-fill-no {
      height: 100%;
      flex: 1;
      background: linear-gradient(90deg, #d8006a, var(--neon-pink));
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 6px;
      position: relative;
      overflow: hidden;
    }

    .score-fill-no::after {
      animation-delay: 0.5s;
    }

    .score-percent {
      font-size: 8px;
      font-weight: 700;
      color: #fff;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
      position: relative;
      z-index: 1;
    }

    /* Kalshi style */
    .score-row.kalshi .score-fill-yes {
      background: linear-gradient(90deg, var(--kalshi-teal), #00b85a);
    }
    .score-row.kalshi .score-fill-no {
      background: linear-gradient(90deg, #008844, var(--kalshi-teal-dark));
      opacity: 0.6;
    }

    /* Party style - neon blue/pink matching logo */
    .score-row.party .score-fill-yes {
      background: linear-gradient(90deg, var(--party-yes), #00d0e8);
      box-shadow: 0 0 10px rgba(77, 166, 255, 0.4);
    }
    .score-row.party .score-fill-no {
      background: linear-gradient(90deg, var(--party-no), #e8005a);
    }

    /* Native Emoji with Juice */
    .emoji {
      display: inline-block;
      font-style: normal;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
      transform-origin: center;
      animation: emoji-bounce 2s ease-in-out infinite;
    }

    @keyframes emoji-bounce {
      0%, 100% { transform: scale(1) rotate(-2deg); }
      50% { transform: scale(1.05) rotate(2deg); }
    }

    .emoji.static {
      animation: none;
    }

    /* Legacy pill styles for market cards */
    .score-pills {
      display: flex;
      gap: 6px;
    }

    .score-pill {
      padding: 6px 14px;
      border-radius: 100px;
      font-size: 14px;
      font-weight: 700;
    }

    /* ═══════════════════════════════════════════════════════════════
       THE NIGHTCLUB — Turntable.fm Meets Miiverse
    ═══════════════════════════════════════════════════════════════ */
    .nightclub {
      flex: 1;
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, #1a1428 0%, #0d0a14 100%);
    }

    /* Ambient glow layer — shows through the glass floor! */
    .nightclub::after {
      content: '';
      position: absolute;
      inset: 0;
      background:
        radial-gradient(ellipse 50% 40% at 25% 60%, rgba(255, 0, 128, 0.12) 0%, transparent 60%),
        radial-gradient(ellipse 50% 40% at 75% 60%, rgba(0, 245, 255, 0.12) 0%, transparent 60%),
        radial-gradient(ellipse 80% 30% at 50% 30%, rgba(255, 215, 0, 0.06) 0%, transparent 50%);
      pointer-events: none;
      z-index: 1;
      animation: ambient-pulse 8s ease-in-out infinite;
    }

    @keyframes ambient-pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* ═══════════════════════════════════════════════════════════════
       WALL LIGHTS — Stage Spotlights
    ═══════════════════════════════════════════════════════════════ */
    .wall-lights {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      display: flex;
      justify-content: space-around;
      padding: 0 20px;
      z-index: 2; /* BEHIND the dance floor for that glow-through effect! */
    }

    .spotlight-mount {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .spotlight-arm {
      width: 4px;
      height: 20px;
      background: #333;
    }

    .spotlight-head {
      width: 20px;
      height: 14px;
      border-radius: 4px 4px 8px 8px;
      position: relative;
    }

    .spotlight-head.pink { background: linear-gradient(180deg, #ff0080, #cc0066); }
    .spotlight-head.cyan { background: linear-gradient(180deg, #00f5ff, #00c8d8); }
    .spotlight-head.gold { background: linear-gradient(180deg, #ffd700, #ffaa00); }

    .spotlight-beam {
      position: absolute;
      top: 14px;
      left: calc(50% - 40px); /* Center the beam */
      width: 80px;
      height: 500px; /* TALLER - goes behind the glass floor! */
      transform-origin: top center; /* Rotate from fixture connection point! */
      pointer-events: none;
    }

    .spotlight-beam.pink {
      background: linear-gradient(180deg, rgba(255, 0, 128, 0.4), transparent 80%);
      clip-path: polygon(40% 0%, 60% 0%, 100% 100%, 0% 100%);
      animation: beam-sway-1 4s ease-in-out infinite;
    }

    .spotlight-beam.cyan {
      background: linear-gradient(180deg, rgba(0, 245, 255, 0.4), transparent 80%);
      clip-path: polygon(40% 0%, 60% 0%, 100% 100%, 0% 100%);
      animation: beam-sway-2 5s ease-in-out infinite;
    }

    .spotlight-beam.gold {
      background: linear-gradient(180deg, rgba(255, 215, 0, 0.3), transparent 80%);
      clip-path: polygon(40% 0%, 60% 0%, 100% 100%, 0% 100%);
      animation: beam-sway-3 4.5s ease-in-out infinite;
    }

    @keyframes beam-sway-1 {
      0%, 100% { transform: rotate(-15deg); }
      50% { transform: rotate(15deg); }
    }

    @keyframes beam-sway-2 {
      0%, 100% { transform: rotate(10deg); }
      50% { transform: rotate(-20deg); }
    }

    @keyframes beam-sway-3 {
      0%, 100% { transform: rotate(-5deg); }
      50% { transform: rotate(25deg); }
    }

    /* ═══════════════════════════════════════════════════════════════
       MARQUEE SIGN — Turntable.fm Inspired "Now Playing" Display!
    ═══════════════════════════════════════════════════════════════ */
    .marquee-sign {
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 15;
      perspective: 800px;
    }

    .marquee-frame {
      background: linear-gradient(180deg, #1a1520 0%, #0d0a12 100%);
      border: 3px solid #2a2535;
      border-radius: 12px;
      padding: 6px 8px;
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.6),
        inset 0 2px 0 rgba(255, 255, 255, 0.05),
        0 0 40px rgba(255, 215, 0, 0.1);
      transform: rotateX(5deg);
      transform-origin: center bottom;
    }

    /* Chase lights around the frame */
    .marquee-lights {
      display: flex;
      justify-content: space-around;
      padding: 2px 4px;
      gap: 4px;
    }

    .marquee-lights span {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #ffd700;
      box-shadow: 0 0 8px #ffd700, 0 0 16px rgba(255, 215, 0, 0.5);
      animation: chase-lights 1.5s ease-in-out infinite;
    }

    .marquee-lights span:nth-child(1) { animation-delay: 0s; }
    .marquee-lights span:nth-child(2) { animation-delay: 0.1s; }
    .marquee-lights span:nth-child(3) { animation-delay: 0.2s; }
    .marquee-lights span:nth-child(4) { animation-delay: 0.3s; }
    .marquee-lights span:nth-child(5) { animation-delay: 0.4s; }
    .marquee-lights span:nth-child(6) { animation-delay: 0.5s; }
    .marquee-lights span:nth-child(7) { animation-delay: 0.6s; }
    .marquee-lights span:nth-child(8) { animation-delay: 0.7s; }
    .marquee-lights span:nth-child(9) { animation-delay: 0.8s; }
    .marquee-lights span:nth-child(10) { animation-delay: 0.9s; }

    .marquee-lights.bottom span {
      animation-direction: reverse;
    }

    @keyframes chase-lights {
      0%, 100% { opacity: 0.3; transform: scale(0.8); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    .marquee-content {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      background: linear-gradient(180deg, #1e1828 0%, #12101a 100%);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .marquee-vote-icon {
      font-size: 20px;
      filter: drop-shadow(0 0 8px currentColor);
      animation: vote-icon-pulse 2s ease-in-out infinite;
    }

    .marquee-vote-icon.no {
      color: var(--neon-pink);
    }

    .marquee-vote-icon.yes {
      color: var(--neon-cyan);
      animation-delay: 1s;
    }

    @keyframes vote-icon-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }

    .marquee-center {
      flex: 1;
      text-align: center;
      min-width: 150px;
    }

    .marquee-question {
      font-size: 11px;
      font-weight: 700;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      line-height: 1.2;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      /* Truncate long questions */
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .marquee-stats {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      margin-top: 4px;
      font-size: 9px;
      font-weight: 600;
    }

    .marquee-stat {
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .marquee-stat.no {
      color: var(--neon-pink);
    }

    .marquee-stat.yes {
      color: var(--neon-cyan);
    }

    /* LIVE badge + Countdown row */
    .marquee-live-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin-bottom: 4px;
    }

    .marquee-live {
      display: flex;
      align-items: center;
      gap: 4px;
      background: rgba(255, 0, 80, 0.2);
      padding: 2px 8px;
      border-radius: 10px;
      border: 1px solid rgba(255, 0, 80, 0.4);
      font-size: 9px;
      font-weight: 700;
      color: #ff4080;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .marquee-live .live-dot {
      width: 6px;
      height: 6px;
      background: #ff4080;
      border-radius: 50%;
      animation: live-pulse 1s ease-in-out infinite;
    }

    @keyframes live-pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.8); }
    }

    .marquee-countdown {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 10px;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.7);
    }

    .marquee-countdown .countdown-icon {
      font-size: 10px;
    }

    /* Stacked Progress Bars in Marquee — Kalshi + Party */
    .marquee-bars {
      margin-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .marquee-bar-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .marquee-bar-label {
      font-size: 7px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      width: 36px;
      color: rgba(255, 255, 255, 0.6);
    }

    .marquee-bar-row.kalshi .marquee-bar-label {
      color: var(--neon-gold);
    }

    .marquee-bar-row.party .marquee-bar-label {
      color: var(--neon-cyan);
    }

    .marquee-bar-container {
      display: flex;
      flex: 1;
      height: 8px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 4px;
      overflow: hidden;
      gap: 2px;
    }

    .marquee-bar {
      height: 100%;
      border-radius: 4px;
      transition: width 0.5s ease;
    }

    /* Party YES bar - Cyan/Blue (matches sidebar) */
    .marquee-bar.yes {
      background: linear-gradient(90deg, var(--neon-cyan), #00d4ff);
      box-shadow: 0 0 8px var(--neon-cyan);
    }

    /* Party NO bar - Pink (matches sidebar) */
    .marquee-bar.no {
      background: linear-gradient(90deg, #ff6090, var(--neon-pink));
      box-shadow: 0 0 6px var(--neon-pink);
    }

    /* Kalshi YES bar - Gold (matches sidebar) */
    .marquee-bar.yes.kalshi {
      background: linear-gradient(90deg, var(--neon-gold), #ffcc00);
      box-shadow: 0 0 8px var(--neon-gold);
    }

    /* Kalshi NO bar - Neutral gray (matches sidebar background) */
    .marquee-bar.kalshi-no {
      background: rgba(80, 80, 100, 0.6);
      box-shadow: none;
    }

    .marquee-bar-pct {
      font-size: 9px;
      font-weight: 800;
      width: 28px;
      text-align: right;
      color: var(--neon-cyan);
    }

    .marquee-bar-row.kalshi .marquee-bar-pct {
      color: var(--neon-gold);
    }

    /* Desktop: Bigger marquee */
    @media (min-width: 769px) {
      .marquee-sign {
        top: 12px;
      }

      .marquee-frame {
        padding: 8px 12px;
        border-radius: 16px;
      }

      .marquee-content {
        gap: 16px;
        padding: 10px 20px;
      }

      .marquee-center {
        min-width: 220px;
      }

      .marquee-question {
        font-size: 14px;
      }

      .marquee-stats {
        font-size: 11px;
        gap: 12px;
      }

      .marquee-stat .stat-pct {
        font-size: 13px;
      }

      .marquee-vote-icon {
        font-size: 28px;
      }

      .marquee-lights span {
        width: 8px;
        height: 8px;
      }
    }

    /* Ultra-wide: Even bigger */
    @media (min-width: 1200px) {
      .marquee-center {
        min-width: 300px;
      }

      .marquee-question {
        font-size: 16px;
      }

      .marquee-content {
        gap: 24px;
        padding: 12px 28px;
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       STAGE ARCHITECTURE — Toshiro's Nightclub Vision
       Roof → Jumbotron → DJ Booth → Crowd
    ═══════════════════════════════════════════════════════════════ */

    /* === THE ROOF === Compact Global Nav (60px) */
    .stage-roof {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.95) 0%, rgba(10, 5, 20, 0.9) 100%);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 16px;
      z-index: 100;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }

    .roof-back {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.12);
      border-radius: 12px;
      color: #fff;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s var(--bounce);
    }

    .roof-back:active {
      transform: scale(0.95);
      background: rgba(255, 255, 255, 0.15);
    }

    .roof-back-arrow {
      font-size: 18px;
    }

    .roof-live {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      background: rgba(255, 0, 80, 0.25);
      border: 2px solid rgba(255, 0, 80, 0.5);
      border-radius: 100px;
      animation: live-glow 2s ease-in-out infinite;
    }

    @keyframes live-glow {
      0%, 100% { box-shadow: 0 0 10px rgba(255, 0, 80, 0.3); }
      50% { box-shadow: 0 0 20px rgba(255, 0, 80, 0.6); }
    }

    .roof-live-dot {
      width: 8px;
      height: 8px;
      background: #ff3366;
      border-radius: 50%;
      animation: pulse 1s ease-in-out infinite;
    }

    .roof-live-text {
      font-size: 11px;
      font-weight: 800;
      color: #ff3366;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .roof-spacer {
      width: 100px; /* Balance the layout */
    }

    /* === THE JUMBOTRON === Massive LED Matrix Screen */
    .jumbotron {
      position: absolute;
      top: 60px; /* Below the roof */
      left: 50%;
      transform: translateX(-50%);
      width: calc(100% - 24px);
      max-width: 600px;
      z-index: 50;
      perspective: 1200px;
    }

    .jumbotron-screen {
      background: linear-gradient(180deg, #0a0515 0%, #050210 100%);
      border: 4px solid #1a1525;
      border-radius: 8px;
      padding: 16px 20px;
      position: relative;
      overflow: hidden;
      box-shadow:
        0 0 60px rgba(77, 166, 255, 0.15),
        0 0 100px rgba(255, 0, 128, 0.1),
        inset 0 0 40px rgba(0, 0, 0, 0.5),
        0 20px 60px rgba(0, 0, 0, 0.8);
      transform: rotateX(5deg);
      transform-origin: center bottom;
    }

    /* LED Matrix Pixel Grid Overlay */
    .jumbotron-pixels {
      position: absolute;
      inset: 0;
      background-image:
        linear-gradient(rgba(0, 0, 0, 0.15) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 0, 0, 0.15) 1px, transparent 1px);
      background-size: 4px 4px;
      pointer-events: none;
      z-index: 10;
      mix-blend-mode: overlay;
    }

    /* Scanline effect */
    .jumbotron-scanlines {
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.1) 2px,
        rgba(0, 0, 0, 0.1) 4px
      );
      pointer-events: none;
      z-index: 11;
      animation: scanline-scroll 8s linear infinite;
    }

    @keyframes scanline-scroll {
      0% { background-position: 0 0; }
      100% { background-position: 0 100px; }
    }

    /* LED Edge Glow */
    .jumbotron-glow {
      position: absolute;
      inset: -4px;
      border-radius: 12px;
      background: linear-gradient(90deg,
        var(--neon-pink) 0%,
        var(--neon-cyan) 50%,
        var(--neon-pink) 100%
      );
      opacity: 0.3;
      filter: blur(8px);
      z-index: -1;
      animation: jumbotron-edge-glow 4s ease-in-out infinite;
    }

    @keyframes jumbotron-edge-glow {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 0.4; }
    }

    /* Market Question - Giant Pixel Font */
    .jumbotron-question {
      font-size: 18px;
      font-weight: 800;
      color: #fff;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 2px;
      line-height: 1.3;
      text-shadow:
        0 0 10px var(--neon-cyan),
        0 0 20px var(--neon-cyan),
        0 0 40px rgba(77, 166, 255, 0.5);
      position: relative;
      z-index: 5;
      /* Pixel font feel */
      font-family: 'Space Grotesk', monospace;
      /* Clamp lines */
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    /* Stats Row */
    .jumbotron-stats {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 24px;
      margin-top: 12px;
      position: relative;
      z-index: 5;
    }

    .jumbotron-stat {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
    }

    .jumbotron-stat-label {
      font-size: 9px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      opacity: 0.6;
    }

    .jumbotron-stat-value {
      font-size: 24px;
      font-weight: 800;
      text-shadow: 0 0 15px currentColor;
    }

    .jumbotron-stat.no .jumbotron-stat-value {
      color: var(--neon-pink);
    }

    .jumbotron-stat.yes .jumbotron-stat-value {
      color: var(--neon-cyan);
    }

    .jumbotron-divider {
      width: 2px;
      height: 40px;
      background: linear-gradient(180deg, transparent, rgba(255,255,255,0.3), transparent);
    }

    /* Progress Bar in Jumbotron */
    .jumbotron-bar {
      margin-top: 12px;
      height: 12px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 6px;
      overflow: hidden;
      display: flex;
      position: relative;
      z-index: 5;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .jumbotron-bar-fill {
      height: 100%;
      transition: width 0.5s ease;
    }

    .jumbotron-bar-fill.no {
      background: linear-gradient(90deg, #ff0066, var(--neon-pink));
      box-shadow: 0 0 15px var(--neon-pink);
    }

    .jumbotron-bar-fill.yes {
      background: linear-gradient(90deg, var(--neon-cyan), #00d4ff);
      box-shadow: 0 0 15px var(--neon-cyan);
    }

    /* BET FLASH EFFECT */
    .jumbotron-flash {
      position: absolute;
      inset: 0;
      opacity: 0;
      pointer-events: none;
      z-index: 20;
      border-radius: 8px;
    }

    .jumbotron-flash.yes {
      background: radial-gradient(ellipse at center, var(--neon-cyan), transparent 70%);
    }

    .jumbotron-flash.no {
      background: radial-gradient(ellipse at center, var(--neon-pink), transparent 70%);
    }

    .jumbotron-flash.active {
      animation: jumbotron-flash-anim 0.6s ease-out;
    }

    @keyframes jumbotron-flash-anim {
      0% { opacity: 0.8; transform: scale(1); }
      100% { opacity: 0; transform: scale(1.1); }
    }

    /* === SPOTLIGHT CONE === From Jumbotron to DJ */
    .stage-spotlight-cone {
      position: absolute;
      top: 100%;
      left: 50%;
      width: 120px;
      height: 80px;
      transform: translateX(-50%);
      background: linear-gradient(180deg,
        rgba(255, 255, 255, 0.15) 0%,
        rgba(255, 255, 255, 0.05) 40%,
        transparent 100%
      );
      clip-path: polygon(35% 0%, 65% 0%, 100% 100%, 0% 100%);
      pointer-events: none;
      z-index: 40;
      animation: spotlight-flicker 3s ease-in-out infinite;
    }

    @keyframes spotlight-flicker {
      0%, 100% { opacity: 0.6; }
      25% { opacity: 0.8; }
      50% { opacity: 0.5; }
      75% { opacity: 0.9; }
    }

    /* Desktop: Bigger Jumbotron */
    @media (min-width: 769px) {
      .stage-roof {
        padding: 0 24px;
      }

      .jumbotron {
        max-width: 700px;
      }

      .jumbotron-screen {
        padding: 24px 32px;
        border-radius: 12px;
      }

      .jumbotron-question {
        font-size: 26px;
        letter-spacing: 3px;
      }

      .jumbotron-stat-value {
        font-size: 32px;
      }

      .jumbotron-bar {
        height: 16px;
        border-radius: 8px;
      }

      .stage-spotlight-cone {
        width: 180px;
        height: 100px;
      }
    }

    /* Ultra-wide: Maximum Impact */
    @media (min-width: 1200px) {
      .jumbotron {
        max-width: 800px;
      }

      .jumbotron-question {
        font-size: 32px;
      }

      .jumbotron-stat-value {
        font-size: 40px;
      }

      .stage-spotlight-cone {
        width: 220px;
        height: 120px;
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       DJ BOOTH — The Heart of the Party
    ═══════════════════════════════════════════════════════════════ */
    /* LEGACY DJ BOOTH — HIDDEN (replaced by .iso-dj-booth in 3D world) */
    .dj-booth-visual {
      display: none !important;
    }

    .dj-table {
      width: 120px;
      height: 50px;
      background: linear-gradient(180deg, #2a2a3a, #1a1a2a);
      border-radius: 8px;
      border: 2px solid #3a3a4a;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
    }

    .turntable {
      width: 32px;
      height: 32px;
      background: radial-gradient(circle, #222 60%, #111 100%);
      border-radius: 50%;
      border: 2px solid #444;
      position: relative;
      animation: spin-record 2s linear infinite;
    }

    .turntable::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 8px;
      height: 8px;
      background: var(--neon-cyan);
      border-radius: 50%;
      transform: translate(-50%, -50%);
    }

    @keyframes spin-record {
      to { transform: rotate(360deg); }
    }

    .mixer {
      width: 24px;
      height: 28px;
      background: linear-gradient(180deg, #333, #222);
      border-radius: 4px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 3px;
    }

    .mixer-slider {
      width: 3px;
      height: 12px;
      background: #444;
      border-radius: 2px;
      position: relative;
    }

    .mixer-slider::after {
      content: '';
      position: absolute;
      bottom: 2px;
      left: -1px;
      width: 5px;
      height: 4px;
      background: var(--neon-pink);
      border-radius: 1px;
    }

    .dj-character {
      position: absolute;
      top: -55px;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: dj-bounce 0.46875s ease-in-out infinite; /* 128 BPM */
    }

    @keyframes dj-bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
    }

    .dj-head {
      width: 28px;
      height: 28px;
      background: #ffd5b8;
      border-radius: 50%;
      position: relative;
      animation: dj-head-bob 0.9375s ease-in-out infinite; /* Half-time groove */
    }

    @keyframes dj-head-bob {
      0%, 100% { transform: rotate(-5deg); }
      50% { transform: rotate(5deg); }
    }

    /* DJ Body */
    .dj-body {
      width: 20px;
      height: 25px;
      background: linear-gradient(180deg, #1a1a2a, #0a0a1a);
      border-radius: 4px 4px 0 0;
      position: relative;
      margin-top: -2px;
    }

    /* DJ Arms - scratching the decks! */
    .dj-arm {
      position: absolute;
      width: 20px;
      height: 4px;
      background: #ffd5b8;
      border-radius: 2px;
      top: 8px;
      transform-origin: 0 50%;
    }

    .dj-arm.left {
      left: -18px;
      animation: dj-scratch-left 0.9375s ease-in-out infinite;
    }

    .dj-arm.right {
      right: -18px;
      transform-origin: 100% 50%;
      animation: dj-scratch-right 0.46875s ease-in-out infinite;
    }

    @keyframes dj-scratch-left {
      0%, 100% { transform: rotate(-20deg); }
      50% { transform: rotate(10deg); }
    }

    @keyframes dj-scratch-right {
      0%, 100% { transform: rotate(20deg); }
      50% { transform: rotate(-10deg); }
    }

    .dj-headphones {
      position: absolute;
      top: 4px;
      left: -4px;
      right: -4px;
      height: 20px;
      border: 3px solid #333;
      border-bottom: none;
      border-radius: 20px 20px 0 0;
    }

    .dj-headphones::before, .dj-headphones::after {
      content: '';
      position: absolute;
      bottom: -4px;
      width: 10px;
      height: 12px;
      background: #333;
      border-radius: 3px;
    }

    .dj-headphones::before { left: -3px; }
    .dj-headphones::after { right: -3px; }

    .dj-label {
      margin-top: 4px;
      padding: 2px 8px;
      background: rgba(0,0,0,0.6);
      border-radius: 4px;
      font-size: 9px;
      font-weight: 700;
      color: var(--neon-cyan);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* ═══════════════════════════════════════════════════════════════
       PULSATING SPEAKERS — Newgrounds Flash Vibes
    ═══════════════════════════════════════════════════════════════ */
    .dj-speakers {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      justify-content: space-between;
      width: 220px;
      left: 50%;
      margin-left: -110px;
      pointer-events: none;
    }

    .speaker {
      width: 36px;
      height: 56px;
      background: linear-gradient(180deg, #2a2a3a, #1a1a2a);
      border-radius: 6px;
      border: 2px solid #3a3a4a;
      position: relative;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }

    .speaker::before {
      content: '';
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 24px;
      height: 24px;
      background: radial-gradient(circle, #222 40%, #111 100%);
      border-radius: 50%;
      border: 2px solid #444;
    }

    .speaker::after {
      content: '';
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 14px;
      height: 14px;
      background: radial-gradient(circle, #333 40%, #1a1a1a 100%);
      border-radius: 50%;
      border: 1px solid #444;
    }

    .speaker .speaker-cone {
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 24px;
      height: 24px;
      border-radius: 50%;
      animation: speaker-pulse 0.46875s ease-in-out infinite;
    }

    .speaker.left .speaker-cone {
      box-shadow: 0 0 0 2px var(--neon-pink), 0 0 15px var(--neon-pink);
    }

    .speaker.right .speaker-cone {
      box-shadow: 0 0 0 2px var(--neon-cyan), 0 0 15px var(--neon-cyan);
    }

    @keyframes speaker-pulse {
      0%, 100% {
        transform: translateX(-50%) scale(1);
        opacity: 0.8;
      }
      50% {
        transform: translateX(-50%) scale(1.15);
        opacity: 1;
      }
    }

    /* Speaker bass waves - Newgrounds flash style */
    .speaker .bass-wave {
      position: absolute;
      top: 8px;
      left: 50%;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      transform: translateX(-50%);
      animation: bass-ripple 0.9375s ease-out infinite;
      pointer-events: none;
    }

    .speaker.left .bass-wave {
      border: 2px solid var(--neon-pink);
    }

    .speaker.right .bass-wave {
      border: 2px solid var(--neon-cyan);
    }

    .speaker .bass-wave:nth-child(2) {
      animation-delay: 0.3125s;
    }

    .speaker .bass-wave:nth-child(3) {
      animation-delay: 0.625s;
    }

    @keyframes bass-ripple {
      0% {
        transform: translateX(-50%) scale(1);
        opacity: 0.8;
      }
      100% {
        transform: translateX(-50%) scale(2.5);
        opacity: 0;
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       NINTENDO CHARM — Stage Decorations!
    ═══════════════════════════════════════════════════════════════ */
    .stage-decorations {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 25;
    }

    /* === DISCO BALL — Spinning Sparkle Machine === */
    .disco-ball {
      position: absolute;
      top: 8px;
      right: 24px;
      z-index: 30;
    }

    .disco-ball-top {
      width: 2px;
      height: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
      margin: 0 auto;
      border-radius: 1px;
    }

    .disco-ball-sphere {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg,
        #555 0%,
        #888 20%,
        #aaa 40%,
        #666 60%,
        #999 80%,
        #777 100%
      );
      position: relative;
      animation: disco-spin 8s linear infinite;
      box-shadow:
        0 0 20px rgba(255, 255, 255, 0.3),
        0 0 40px rgba(255, 200, 100, 0.2),
        inset -4px -4px 8px rgba(0,0,0,0.3),
        inset 4px 4px 8px rgba(255,255,255,0.3);
    }

    .disco-facet {
      position: absolute;
      width: 6px;
      height: 6px;
      background: linear-gradient(135deg, #fff 0%, #ddd 50%, #aaa 100%);
      border-radius: 1px;
      box-shadow: 0 0 4px rgba(255,255,255,0.8);
    }

    .disco-facet:nth-child(1) { top: 6px; left: 8px; }
    .disco-facet:nth-child(2) { top: 12px; left: 18px; }
    .disco-facet:nth-child(3) { top: 20px; left: 6px; }
    .disco-facet:nth-child(4) { top: 18px; left: 20px; }

    .disco-ball-reflection {
      position: absolute;
      top: 40px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 100px;
      background: radial-gradient(circle,
        rgba(255, 255, 255, 0.15) 0%,
        transparent 70%
      );
      animation: disco-reflection 4s ease-in-out infinite;
    }

    @keyframes disco-spin {
      0% { transform: rotateY(0deg); }
      100% { transform: rotateY(360deg); }
    }

    @keyframes disco-reflection {
      0%, 100% { opacity: 0.5; transform: translateX(-50%) scale(1); }
      50% { opacity: 0.8; transform: translateX(-50%) scale(1.2); }
    }

    /* === VELVET ROPES — VIP Treatment === */
    .velvet-rope {
      position: absolute;
      top: 100px;
      z-index: 22;
    }

    .velvet-rope.left {
      left: 8px;
    }

    .velvet-rope.right {
      right: 8px;
    }

    .rope-post {
      width: 8px;
      height: 60px;
      background: linear-gradient(180deg,
        #d4af37 0%,
        #f0d060 20%,
        #d4af37 40%,
        #b8960c 60%,
        #d4af37 80%,
        #f0d060 100%
      );
      border-radius: 4px 4px 2px 2px;
      box-shadow:
        0 0 10px rgba(212, 175, 55, 0.4),
        inset 1px 0 0 rgba(255,255,255,0.3);
      position: relative;
    }

    .rope-post::before {
      content: '';
      position: absolute;
      top: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: linear-gradient(135deg, #f0d060, #d4af37);
      box-shadow: 0 0 8px rgba(212, 175, 55, 0.6);
    }

    .rope-cord {
      position: absolute;
      top: 20px;
      width: 40px;
      height: 8px;
      background: linear-gradient(180deg,
        #8b0000 0%,
        #b22222 30%,
        #8b0000 70%,
        #5c0000 100%
      );
      border-radius: 4px;
      box-shadow:
        0 2px 4px rgba(0,0,0,0.3),
        inset 0 2px 2px rgba(255,255,255,0.1);
    }

    .velvet-rope.left .rope-cord {
      left: 4px;
    }

    .velvet-rope.right .rope-cord {
      right: 4px;
    }

    /* === STAGE EDGE LIGHTS — Chase Light Effect === */
    .stage-edge-lights {
      position: absolute;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 12px;
      z-index: 23;
    }

    .stage-edge-lights span {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--neon-gold);
      box-shadow:
        0 0 8px var(--neon-gold),
        0 0 16px var(--neon-gold),
        0 0 24px rgba(255, 200, 100, 0.5);
      animation: stage-light-chase 2s ease-in-out infinite;
    }

    .stage-edge-lights span:nth-child(1) { animation-delay: 0s; }
    .stage-edge-lights span:nth-child(2) { animation-delay: 0.1s; }
    .stage-edge-lights span:nth-child(3) { animation-delay: 0.2s; }
    .stage-edge-lights span:nth-child(4) { animation-delay: 0.3s; }
    .stage-edge-lights span:nth-child(5) { animation-delay: 0.4s; }
    .stage-edge-lights span:nth-child(6) { animation-delay: 0.5s; }
    .stage-edge-lights span:nth-child(7) { animation-delay: 0.6s; }
    .stage-edge-lights span:nth-child(8) { animation-delay: 0.7s; }
    .stage-edge-lights span:nth-child(9) { animation-delay: 0.8s; }
    .stage-edge-lights span:nth-child(10) { animation-delay: 0.9s; }

    @keyframes stage-light-chase {
      0%, 100% {
        opacity: 0.3;
        transform: scale(0.8);
        background: var(--neon-gold);
        box-shadow: 0 0 4px var(--neon-gold);
      }
      50% {
        opacity: 1;
        transform: scale(1.2);
        background: #fff;
        box-shadow:
          0 0 12px var(--neon-gold),
          0 0 24px var(--neon-gold),
          0 0 36px rgba(255, 200, 100, 0.6);
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       HABBO 2026 — THE ISOMETRIC ROOM
       A full 3D room with floor, walls, and architectural depth
       "A User is a Resident. A Page is a Room." — Toshiro
    ═══════════════════════════════════════════════════════════════ */

    /* ═══════════════════════════════════════════════════════════════
       THE ISOMETRIC ENGINE — True Nintendo/Habbo 2:1 Pixel Ratio
       "The floor tilts. The walls stand. The avatars FACE YOU." — Toshiro
    ═══════════════════════════════════════════════════════════════ */

    /* ═══════════════════════════════════════════════════════════════
       LAYER 1: THE HUD (Z-999) — Clean 2D Overlay
       "Strictly separate 2D HUD from 3D World. No overlap glitches." — Toshiro

       This is a FIXED 2D neon panel. It never intersects the 3D world.
    ═══════════════════════════════════════════════════════════════ */
    .ceiling-sign {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      z-index: 999; /* LAYER 1: Above EVERYTHING */
      display: flex;
      flex-direction: column;
      align-items: center;
      pointer-events: none;
    }

    /* The Chains — Hanging cables from ceiling */
    .ceiling-chains {
      display: flex;
      justify-content: space-between;
      width: 180px;
      height: 30px;
    }

    .chain {
      width: 3px;
      height: 100%;
      background: repeating-linear-gradient(
        180deg,
        #666 0px,
        #666 3px,
        #444 3px,
        #444 6px
      );
      border-radius: 2px;
      box-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    }

    /* The Sign Board — Neon bordered */
    .sign-board {
      position: relative;
      background: linear-gradient(180deg,
        #1a1a2a 0%,
        #0f0f1a 100%
      );
      border: 3px solid transparent;
      border-radius: 8px;
      padding: 12px 20px;
      text-align: center;
      box-shadow:
        0 0 20px rgba(255, 0, 85, 0.4),
        0 0 20px rgba(0, 240, 255, 0.4),
        0 8px 30px rgba(0, 0, 0, 0.6);
      animation: sign-sway 5s ease-in-out infinite;
    }

    /* Neon border effect */
    .sign-board::before {
      content: '';
      position: absolute;
      inset: -3px;
      border-radius: 10px;
      background: linear-gradient(90deg, #FF0055, #FFD700, #00F0FF);
      z-index: -1;
    }

    .sign-board::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 6px;
      background: linear-gradient(180deg, #1a1a2a 0%, #0f0f1a 100%);
      z-index: -1;
    }

    @keyframes sign-sway {
      0%, 100% { transform: rotate(-0.5deg); }
      50% { transform: rotate(0.5deg); }
    }

    .sign-question {
      font-size: clamp(16px, 4vw, 24px);
      font-weight: 900;
      letter-spacing: 2px;
      color: #fff;
      text-shadow:
        0 0 15px rgba(255, 255, 255, 0.8),
        0 0 30px rgba(255, 255, 255, 0.4);
      margin-bottom: 10px;
    }

    /* Progress bar under the question */
    .sign-progress-bar {
      display: flex;
      width: 100%;
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
      background: rgba(0, 0, 0, 0.6);
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    .sign-progress-no {
      height: 100%;
      background: linear-gradient(90deg, #FF0055, #FF3377);
      transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 8px #FF0055;
    }

    .sign-progress-yes {
      height: 100%;
      background: linear-gradient(90deg, #00CCFF, #00F0FF);
      transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 8px #00F0FF;
    }

    .sign-live {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 2px;
      color: #FF3366;
      text-shadow: 0 0 10px #FF3366;
      margin-top: 8px;
    }

    .sign-live-dot {
      width: 6px;
      height: 6px;
      background: #FF3366;
      border-radius: 50%;
      box-shadow: 0 0 6px #FF3366;
      animation: live-pulse 1s ease-in-out infinite;
    }

    @keyframes live-pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.3; transform: scale(0.6); }
    }

    /* Legacy HUD - hidden */
    .hud-question { display: none; }
    .hud-progress-bar { display: none; }
    .hud-live { display: none; }

    /* ═══════════════════════════════════════════════════════════════
       LAYER 2: THE 3D WORLD (The Stage)
       "140px margin-top clearance for the God Sign." — Toshiro V11
    ═══════════════════════════════════════════════════════════════ */
    .iso-room {
      position: absolute;
      /* V12: 180px clearance — Sign CLEARLY above DJ head */
      top: 180px;
      bottom: 40px;
      left: 0;
      right: 0;
      width: 100%;
      z-index: 5;
      /* CRITICAL: 1200px perspective reduces sprite warping */
      perspective: 1200px;
      perspective-origin: 50% 50%;
      transform-style: preserve-3d;
      overflow: visible;
    }

    /* ═══════════════════════════════════════════════════════════════
       VOLUMETRIC LIGHT BEAMS — Pink NO / Cyan YES
       "The lasers cut through the 3D space like a nightclub" — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .volumetric-lights {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .light-beam {
      position: absolute;
      top: -20%;
      width: 120px;
      height: 150%;
      opacity: 0.15;
      mix-blend-mode: screen;
      filter: blur(20px);
      animation: beam-sway 8s ease-in-out infinite;
    }

    .light-beam.pink {
      left: 20%;
      background: linear-gradient(
        180deg,
        transparent 0%,
        rgba(255, 0, 85, 0.6) 30%,
        rgba(255, 0, 85, 0.3) 70%,
        transparent 100%
      );
      transform: rotate(-15deg);
      animation-delay: 0s;
    }

    .light-beam.pink-2 {
      left: 30%;
      background: linear-gradient(
        180deg,
        transparent 0%,
        rgba(255, 0, 85, 0.4) 40%,
        rgba(255, 0, 85, 0.2) 80%,
        transparent 100%
      );
      transform: rotate(-8deg);
      animation-delay: -2s;
      width: 80px;
    }

    .light-beam.cyan {
      right: 20%;
      background: linear-gradient(
        180deg,
        transparent 0%,
        rgba(0, 240, 255, 0.6) 30%,
        rgba(0, 240, 255, 0.3) 70%,
        transparent 100%
      );
      transform: rotate(15deg);
      animation-delay: -4s;
    }

    .light-beam.cyan-2 {
      right: 30%;
      background: linear-gradient(
        180deg,
        transparent 0%,
        rgba(0, 240, 255, 0.4) 40%,
        rgba(0, 240, 255, 0.2) 80%,
        transparent 100%
      );
      transform: rotate(8deg);
      animation-delay: -6s;
      width: 80px;
    }

    @keyframes beam-sway {
      0%, 100% { transform: rotate(var(--beam-angle, 0deg)) translateX(0); }
      50% { transform: rotate(var(--beam-angle, 0deg)) translateX(30px); }
    }

    .light-beam.pink { --beam-angle: -15deg; }
    .light-beam.pink-2 { --beam-angle: -8deg; }
    .light-beam.cyan { --beam-angle: 15deg; }
    .light-beam.cyan-2 { --beam-angle: 8deg; }

    /* THE WORLD DIV — STRAIGHT-ON Isometric View (No Z rotation = faces viewer!) */
    .iso-world {
      position: absolute;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      /* PICTO-PARTY FIX: rotateX only — faces VIEWER directly like PictoChat/Habbo */
      /* No rotateZ means NO/YES zones face you straight on! */
      transform: rotateX(55deg);
      transform-origin: center center;
    }

    /* ═══════════════════════════════════════════════════════════════
       THE TETRIS FLOOR — Dynamic Territory Based on Market Probability
       "The floor tells the story. 70% NO = 70% Pink territory." — Toshiro

       Layout: [NO Zone (Pink/Left)] [YES Zone (Cyan/Right)]
       Walls are CHILDREN of zones, so they resize together.
    ═══════════════════════════════════════════════════════════════ */
    .iso-floor {
      position: absolute;
      /* PICTO-PARTY: BIGGER floor fills viewport! */
      width: 90vw;
      max-width: 700px;
      height: 50vh;
      max-height: 400px;
      left: 50%;
      top: 55%;
      transform: translate(-50%, -50%);
      transform-style: preserve-3d;
      display: flex;
      flex-direction: row; /* NO (left) | YES (right) */
      gap: 6px;
      /* Dynamic ratios set by JS — with 20% MINIMUM (Minimum Viable Dancefloor!) */
      --yes-ratio: 0.5;
      --no-ratio: 0.5;
    }

    /* Floor Zone Containers — Width driven by market ratio */
    .floor-zone {
      position: relative;
      transform-style: preserve-3d;
      transition: flex 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: visible; /* Allow walls to extend upward */
      display: flex;
      flex-direction: column;
    }

    /* NO Zone on LEFT (Pink) */
    .floor-zone.no {
      flex: var(--no-ratio);
      order: 1; /* First (left) */
    }

    /* YES Zone on RIGHT (Cyan) */
    .floor-zone.yes {
      flex: var(--yes-ratio);
      order: 2; /* Second (right) */
    }

    /* Zone Wall — Child of zone, sits "North" of floor tiles */
    .zone-wall {
      position: absolute;
      bottom: 100%; /* Sits above the floor */
      left: 0;
      right: 0;
      height: 140px;
      transform: rotateX(-90deg);
      transform-origin: bottom center;
      transform-style: preserve-3d;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 8px;
      overflow: hidden;
    }

    /* NO Wall (Pink) */
    .zone-wall.no {
      background: linear-gradient(180deg, #1a0515 0%, #0f030a 100%);
      border: 2px solid rgba(255, 0, 85, 0.4);
      box-shadow:
        inset 0 0 60px rgba(255, 0, 85, 0.2),
        0 0 30px rgba(255, 0, 85, 0.15);
    }

    /* YES Wall (Cyan) */
    .zone-wall.yes {
      background: linear-gradient(180deg, #051520 0%, #030a0f 100%);
      border: 2px solid rgba(0, 240, 255, 0.4);
      box-shadow:
        inset 0 0 60px rgba(0, 240, 255, 0.2),
        0 0 30px rgba(0, 240, 255, 0.15);
    }

    /* Wall pixel grid texture */
    .zone-wall::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image:
        linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 6px 6px;
      pointer-events: none;
    }

    /* Wall scanlines */
    .zone-wall::after {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent 0px,
        transparent 2px,
        rgba(0, 0, 0, 0.08) 2px,
        rgba(0, 0, 0, 0.08) 4px
      );
      pointer-events: none;
    }

    /* Wall content */
    .wall-label {
      font-size: 32px;
      font-weight: 900;
      letter-spacing: 4px;
      text-shadow: 0 0 20px currentColor, 0 0 40px currentColor;
      z-index: 2;
    }

    .zone-wall.no .wall-label { color: #FF0055; }
    .zone-wall.yes .wall-label { color: #00F0FF; }

    .wall-odds {
      font-size: 48px;
      font-weight: 900;
      text-shadow: 0 0 30px currentColor;
      z-index: 2;
    }

    .zone-wall.no .wall-odds { color: #FF0055; }
    .zone-wall.yes .wall-odds { color: #00F0FF; }

    /* The Tile Surface within each zone */
    .zone-tiles {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(20px, 1fr));
      grid-auto-rows: 1fr;
      gap: 2px;
      transform-style: preserve-3d;
    }

    /* The Tile Grid within each zone — WIDER tiles, fewer rows */
    .iso-tile-grid {
      display: grid;
      /* PICTO-PARTY: 4x4 grid for WIDER, more realistic tiles */
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 3px;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
    }

    /* Individual Floor Tile — 3D extruded slab */
    .iso-tile {
      position: relative;
      background: #1a1a2a;
      border: 1px solid rgba(255, 255, 255, 0.08);
      transform-style: preserve-3d;
      transition: background-color 0.15s ease-out,
                  box-shadow 0.15s ease-out;
    }

    /* Tile Depth — Front face (bottom edge) */
    .iso-tile::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: #0a0a12;
      transform: rotateX(-90deg) translateZ(0px);
      transform-origin: bottom;
    }

    /* Tile Depth — Right face (side edge) */
    .iso-tile::after {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      right: 0;
      width: 6px;
      background: #0f0f1a;
      transform: rotateY(90deg) translateZ(0px);
      transform-origin: right;
    }

    /* YES Zone Tiles — Cyan/Blue tint */
    .floor-zone.yes .iso-tile {
      background: linear-gradient(135deg, #0a1a25 0%, #0f2530 100%);
      border-color: rgba(0, 240, 255, 0.12);
    }
    .floor-zone.yes .iso-tile::before { background: #051015; }
    .floor-zone.yes .iso-tile::after { background: #08181f; }

    /* NO Zone Tiles — Pink/Red tint */
    .floor-zone.no .iso-tile {
      background: linear-gradient(135deg, #1a0a15 0%, #250f1a 100%);
      border-color: rgba(255, 0, 85, 0.12);
    }
    .floor-zone.no .iso-tile::before { background: #100510; }
    .floor-zone.no .iso-tile::after { background: #180812; }

    /* Zone hover glow */
    /* HOVER FEEDBACK — Entire zone glows WHITE when player hovers */
    .floor-zone.hovering {
      filter: brightness(1.4);
    }

    .floor-zone.hovering .iso-tile {
      box-shadow:
        inset 0 0 30px rgba(255, 255, 255, 0.3),
        0 0 20px rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.4) !important;
    }

    .floor-zone.hovering .zone-wall {
      filter: brightness(1.3);
      box-shadow:
        inset 0 0 80px rgba(255, 255, 255, 0.2),
        0 0 40px rgba(255, 255, 255, 0.3) !important;
    }

    /* "BILLIE JEAN" EFFECT — Tile Flash States */
    .iso-tile.flash-cyan {
      background: #00F0FF !important;
      box-shadow:
        0 0 15px #00F0FF,
        0 0 30px rgba(0, 240, 255, 0.5),
        inset 0 0 10px rgba(255, 255, 255, 0.4);
      border-color: #00F0FF;
    }

    .iso-tile.flash-pink {
      background: #FF0055 !important;
      box-shadow:
        0 0 15px #FF0055,
        0 0 30px rgba(255, 0, 85, 0.5),
        inset 0 0 10px rgba(255, 255, 255, 0.4);
      border-color: #FF0055;
    }

    /* ═══════════════════════════════════════════════════════════════
       HOLOGRAM ZONES — DELETED (Redundant with HUD sign)
       "One Sign. Clean Architecture." — Toshiro V11
    ═══════════════════════════════════════════════════════════════ */
    .energy-curtain, .hologram-label, .hologram-percent { display: none; }

    /* ═══════════════════════════════════════════════════════════════
       THE CORNER WALLS — Two massive SCREENS meeting at 120° angle
       Left Wall = Pink (NO) Screen | Right Wall = Cyan (YES) Screen
       "These walls are not walls. They are JUMBOTRONS." — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .iso-wall {
      position: absolute;
      transform-style: preserve-3d;
    }

    /* BACK-LEFT WALL — The NO Screen (Pink) */
    .iso-wall.back-left {
      width: 180px;
      height: 160px;
      left: calc(50% - 180px);
      top: calc(50% - 200px);
      transform: rotateX(-90deg) translateZ(0px);
      transform-origin: bottom center;
      background: linear-gradient(180deg, #1a0515 0%, #0f030a 100%);
      border: 2px solid rgba(255, 0, 85, 0.4);
      box-shadow:
        inset 0 0 80px rgba(255, 0, 85, 0.15),
        0 0 40px rgba(255, 0, 85, 0.2);
      overflow: hidden;
    }

    /* Pixel grid texture on wall screens */
    .iso-wall::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image:
        linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 8px 8px;
      pointer-events: none;
    }

    /* Screen glow emission */
    .iso-wall::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100px;
      background: linear-gradient(0deg, currentColor, transparent);
      opacity: 0.15;
      pointer-events: none;
    }

    .iso-wall.back-left::after { color: #FF0055; }
    .iso-wall.back-right::after { color: #00F0FF; }

    /* BACK-RIGHT WALL — The YES Screen (Cyan) */
    .iso-wall.back-right {
      width: 180px;
      height: 160px;
      right: calc(50% - 180px);
      top: calc(50% - 200px);
      transform: rotateX(-90deg) translateZ(0px);
      transform-origin: bottom center;
      background: linear-gradient(180deg, #051520 0%, #030a0f 100%);
      border: 2px solid rgba(0, 240, 255, 0.4);
      box-shadow:
        inset 0 0 80px rgba(0, 240, 255, 0.15),
        0 0 40px rgba(0, 240, 255, 0.2);
      overflow: hidden;
    }

    /* Wall Screen Content Container */
    .wall-screen-content {
      position: absolute;
      inset: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      z-index: 2;
    }

    /* Wall Screen Label */
    .wall-screen-label {
      font-size: 28px;
      font-weight: 900;
      letter-spacing: 4px;
      text-shadow: 0 0 20px currentColor, 0 0 40px currentColor;
    }

    .iso-wall.back-left .wall-screen-label { color: #FF0055; }
    .iso-wall.back-right .wall-screen-label { color: #00F0FF; }

    /* Wall Screen Stats */
    .wall-screen-stat {
      font-size: 14px;
      font-weight: 700;
      opacity: 0.8;
      letter-spacing: 1px;
    }

    .wall-screen-odds {
      font-size: 48px;
      font-weight: 900;
      text-shadow: 0 0 30px currentColor;
      line-height: 1;
    }

    /* Scanlines overlay */
    .wall-scanlines {
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent 0px,
        transparent 2px,
        rgba(0, 0, 0, 0.1) 2px,
        rgba(0, 0, 0, 0.1) 4px
      );
      pointer-events: none;
      z-index: 3;
    }

    /* Floor light bloom from wall screens */
    .wall-floor-bloom {
      position: absolute;
      width: 200px;
      height: 150px;
      bottom: -150px;
      left: 50%;
      transform: translateX(-50%) rotateX(90deg);
      transform-origin: top center;
      pointer-events: none;
    }

    .iso-wall.back-left .wall-floor-bloom {
      background: radial-gradient(ellipse at 50% 0%, rgba(255, 0, 85, 0.25) 0%, transparent 70%);
    }

    .iso-wall.back-right .wall-floor-bloom {
      background: radial-gradient(ellipse at 50% 0%, rgba(0, 240, 255, 0.25) 0%, transparent 70%);
    }

    /* ═══ THE JUMBOTRON — Wall-Mounted Screen ═══ */
    .iso-jumbotron {
      /* PICTO-PARTY: HIDDEN — Question moved to HUD above floor */
      display: none;
      position: absolute;
      width: 200px;
      height: 80px;
      left: 50%;
      top: calc(50% - 120px);
      transform: translateX(-50%) rotateX(-90deg) translateY(-20px);
      transform-origin: bottom center;
      transform-style: preserve-3d;
      z-index: 100;
    }

    .iso-jumbotron-frame {
      position: absolute;
      inset: -4px;
      background: linear-gradient(135deg, #333 0%, #1a1a1a 50%, #222 100%);
      border-radius: 4px;
      box-shadow:
        0 0 20px rgba(0, 0, 0, 0.8),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .iso-jumbotron-screen {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, #0a0a15 0%, #05050a 100%);
      border-radius: 2px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 8px;
    }

    /* Screen glow effect */
    .iso-jumbotron-screen::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at center,
        rgba(255, 200, 50, 0.15) 0%,
        transparent 70%
      );
      animation: screen-pulse 2s ease-in-out infinite;
    }

    @keyframes screen-pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* Scanlines */
    .iso-jumbotron-screen::after {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent 0px,
        transparent 2px,
        rgba(0, 0, 0, 0.1) 2px,
        rgba(0, 0, 0, 0.1) 4px
      );
      pointer-events: none;
    }

    .iso-jumbotron-question {
      font-size: 11px;
      font-weight: 800;
      color: #FFD700;
      text-align: center;
      text-shadow: 0 0 10px #FFD700, 0 0 20px rgba(255, 215, 0, 0.5);
      letter-spacing: 1px;
      z-index: 1;
      line-height: 1.2;
    }

    .iso-jumbotron-bar {
      display: flex;
      width: 90%;
      height: 12px;
      margin-top: 6px;
      border-radius: 6px;
      overflow: hidden;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }

    .iso-jumbotron-bar-yes {
      background: linear-gradient(90deg, #00C8FF, #00F0FF);
      box-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
      transition: width 0.5s ease;
    }

    .iso-jumbotron-bar-no {
      background: linear-gradient(90deg, #FF0055, #FF3377);
      box-shadow: 0 0 10px rgba(255, 0, 85, 0.5);
      transition: width 0.5s ease;
    }

    /* Volumetric light from jumbotron onto floor */
    .iso-jumbotron-light {
      position: absolute;
      width: 300px;
      height: 200px;
      left: 50%;
      top: 100%;
      transform: translateX(-50%) rotateX(90deg);
      transform-origin: top center;
      background: radial-gradient(ellipse at 50% 0%,
        rgba(255, 215, 0, 0.15) 0%,
        rgba(255, 200, 50, 0.08) 30%,
        transparent 70%
      );
      pointer-events: none;
    }

    /* ═══════════════════════════════════════════════════════════════
       THE DJ BOOTH — V12: Redesigned for new perspective
       "Clean booth at back. DJ CLEARLY visible below sign." — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .iso-dj-booth {
      position: absolute;
      left: 50%;
      /* V12: DJ positioned lower in the scene for clear sign separation */
      top: 5%;
      transform: translateX(-50%) scale(0.9);
      transform-style: preserve-3d;
      /* Z-index BEHIND dancers (50) but above floor tiles (10) */
      z-index: 25;
    }

    /* ═══════════════════════════════════════════════════════════════
       DJ PREDICT — V12 Xiao Xiao Style Thin Stick DJ
       "Same 2px lines as dancers. Golden glow. Iconic headphones." — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .stick-dj {
      position: absolute;
      left: 50%;
      bottom: 100%;
      /* Counter-rotate the 55deg world tilt */
      transform: translateX(-50%) rotateX(-55deg);
      transform-style: preserve-3d;
      width: 50px;
      height: 70px;
      display: flex;
      flex-direction: column;
      align-items: center;
      /* V12: Slightly larger but not overwhelming */
      scale: 1.2;
    }

    /* DJ HEAD — Circle with headphones */
    .stick-dj-head {
      width: 16px;
      height: 16px;
      background: #fff;
      border: 2px solid #FFD700;
      border-radius: 50%;
      position: relative;
      z-index: 3;
      box-shadow: 0 0 12px rgba(255, 215, 0, 0.6);
    }

    /* HEADPHONES — Thin lines */
    .stick-dj-headphones {
      position: absolute;
      top: -3px;
      left: -6px;
      right: -6px;
      height: 18px;
      border: 2px solid #FFD700;
      border-bottom: none;
      border-radius: 14px 14px 0 0;
      z-index: 4;
      box-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
    }

    /* Headphone ear cups - smaller */
    .stick-dj-headphones::before,
    .stick-dj-headphones::after {
      content: '';
      position: absolute;
      bottom: -4px;
      width: 6px;
      height: 8px;
      background: #FFD700;
      border-radius: 2px;
      box-shadow: 0 0 6px rgba(255, 215, 0, 0.5);
    }

    .stick-dj-headphones::before { left: -2px; }
    .stick-dj-headphones::after { right: -2px; }

    /* DJ BODY — 2px thin line like dancers */
    .stick-dj-body {
      width: 2px;
      height: 18px;
      background: #FFD700;
      margin-top: -2px;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
    }

    /* DJ ARMS — 2px thin reaching to decks */
    .stick-dj-arms {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 2px;
      background: #FFD700;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
      animation: dj-scratch 0.5s ease-in-out infinite alternate;
    }

    @keyframes dj-scratch {
      0% { transform: translateX(-50%) rotate(-8deg); }
      100% { transform: translateX(-50%) rotate(8deg); }
    }

    /* DJ LEGS — 2px thin */
    .stick-dj-legs {
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 20px;
    }

    .stick-dj-legs::before,
    .stick-dj-legs::after {
      content: '';
      position: absolute;
      width: 2px;
      height: 20px;
      background: #FFD700;
      top: 0;
      box-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
    }

    .stick-dj-legs::before { left: 4px; }
    .stick-dj-legs::after { right: 4px; }

    /* DJ Label — ABOVE the DJ */
    .stick-dj-label {
      position: absolute;
      top: -22px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 9px;
      font-weight: 900;
      letter-spacing: 1px;
      color: #FFD700;
      text-shadow: 0 0 10px #FFD700, 0 0 20px rgba(255, 215, 0, 0.5);
      white-space: nowrap;
      background: rgba(0, 0, 0, 0.7);
      padding: 2px 6px;
      border-radius: 8px;
    }

    /* DJ Booth Base — V12 Sleek console block */
    .dj-booth-block {
      position: relative;
      width: 90px;
      height: 35px;
      transform-style: preserve-3d;
    }

    /* TOP FACE — Clean console surface */
    .dj-booth-top {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1a1a25 0%, #12121a 100%);
      border: 2px solid rgba(255, 215, 0, 0.4);
      border-radius: 4px;
      box-shadow:
        inset 0 0 15px rgba(255, 215, 0, 0.15),
        0 0 20px rgba(255, 215, 0, 0.2);
    }

    /* FRONT-LEFT FACE — Visible in isometric view */
    .dj-booth-front-left {
      position: absolute;
      width: 100%;
      height: 30px;
      bottom: 0;
      background: linear-gradient(180deg, #151520 0%, #0a0a10 100%);
      transform: rotateX(-90deg);
      transform-origin: bottom;
      border-bottom: 2px solid rgba(255, 215, 0, 0.3);
      box-shadow: inset 0 -8px 20px rgba(255, 215, 0, 0.1);
    }

    /* LED strip on front face */
    .dj-booth-front-left::before {
      content: '';
      position: absolute;
      top: 6px;
      left: 8px;
      right: 8px;
      height: 3px;
      background: linear-gradient(90deg, #FF0055, #FFD700, #00F0FF);
      border-radius: 2px;
      box-shadow: 0 0 8px rgba(255, 215, 0, 0.6);
      animation: led-pulse 1s ease-in-out infinite alternate;
    }

    @keyframes led-pulse {
      0% { opacity: 0.7; }
      100% { opacity: 1; }
    }

    /* FRONT-RIGHT FACE — Side panel */
    .dj-booth-front-right {
      position: absolute;
      width: 30px;
      height: 100%;
      right: 0;
      background: linear-gradient(90deg, #121218 0%, #08080c 100%);
      transform: rotateY(90deg);
      transform-origin: right;
      border-right: 2px solid rgba(255, 215, 0, 0.3);
      box-shadow: inset 8px 0 20px rgba(255, 215, 0, 0.1);
    }

    /* DJ Turntables on top face — V12 smaller */
    .dj-turntables {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      gap: 20px;
      z-index: 2;
    }

    .dj-turntable {
      width: 18px;
      height: 18px;
      background: radial-gradient(circle, #222 0%, #0a0a0a 60%, #181818 100%);
      border-radius: 50%;
      border: 1px solid #444;
      box-shadow:
        inset 0 0 6px rgba(0, 0, 0, 0.9),
        0 0 8px rgba(255, 215, 0, 0.2);
      animation: spin-record 2s linear infinite;
    }

    /* Record label — golden center */
    .dj-turntable::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 6px;
      height: 6px;
      background: radial-gradient(circle, #FFD700, #FF8800);
      border-radius: 50%;
      box-shadow: 0 0 4px rgba(255, 215, 0, 0.5);
    }

    @keyframes spin-record {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Mixer in center — V12 smaller */
    .dj-mixer {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 14px;
      height: 22px;
      background: linear-gradient(180deg, #1a1a1a, #0a0a0a);
      border-radius: 2px;
      border: 1px solid rgba(255, 215, 0, 0.3);
      z-index: 1;
    }

    .dj-mixer-slider {
      position: absolute;
      width: 3px;
      height: 8px;
      background: linear-gradient(180deg, #FFD700, #FF8800);
      left: 50%;
      transform: translateX(-50%);
      border-radius: 1px;
      box-shadow: 0 0 4px rgba(255, 215, 0, 0.5);
      animation: mixer-slide 0.5s ease-in-out infinite alternate;
    }

    .dj-mixer-slider:first-child { top: 3px; }
    .dj-mixer-slider:last-child { bottom: 3px; animation-delay: 0.25s; }

    @keyframes mixer-slide {
      0% { transform: translateX(-50%) translateY(-1px); }
      100% { transform: translateX(-50%) translateY(1px); }
    }

    /* DJ Avatar (billboard sprite standing ON booth) */
    .dj-avatar {
      position: absolute;
      left: 50%;
      bottom: 100%;
      /* PICTO-PARTY: Counter-rotation now just rotateX(-55deg) since no Z rotation */
      transform: translateX(-50%) rotateX(-55deg) translateZ(30px);
      transform-style: preserve-3d;
    }

    /* DJ Head with photo */
    .dj-avatar-head {
      width: 28px;
      height: 28px;
      background: url('/tg/bandit.jpg') center/cover;
      border-radius: 50%;
      border: 2px solid #FFD700;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5), 0 4px 8px rgba(0, 0, 0, 0.5);
      position: relative;
      margin: 0 auto;
    }

    /* DJ Headphones */
    .dj-avatar-head::after {
      content: '';
      position: absolute;
      top: 2px;
      left: -6px;
      right: -6px;
      height: 8px;
      background: linear-gradient(90deg, #FF0055, #333 20%, #333 80%, #00F0FF);
      border-radius: 10px 10px 0 0;
    }

    /* DJ Body */
    .dj-avatar-body {
      width: 22px;
      height: 30px;
      background: linear-gradient(180deg, #1a1a25, #0f0f15);
      margin: -4px auto 0;
      border-radius: 4px 4px 0 0;
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    /* DJ Arms scratching */
    .dj-avatar-arms {
      position: absolute;
      top: 32px;
      left: 50%;
      transform: translateX(-50%);
      width: 50px;
      display: flex;
      justify-content: space-between;
    }

    .dj-arm {
      width: 5px;
      height: 18px;
      background: linear-gradient(180deg, #1a1a25, #0f0f15);
      border-radius: 3px;
      transform-origin: top center;
      animation: dj-scratch 0.5s ease-in-out infinite alternate;
    }

    .dj-arm.left { animation-delay: 0s; }
    .dj-arm.right { animation-delay: 0.25s; }

    @keyframes dj-scratch {
      0% { transform: rotate(-15deg); }
      100% { transform: rotate(15deg); }
    }

    /* ═══════════════════════════════════════════════════════════════
       THE STICK FIGURE ENGINE — Xiao Xiao / Newgrounds Era
       "A stick figure is not just lines; it is ATTITUDE." — Toshiro

       World rotation: rotateX(55deg) — STRAIGHT ON VIEW
       Counter-rotation: rotateX(-55deg) — Sprites face camera
    ═══════════════════════════════════════════════════════════════ */
    .crowd-area {
      position: absolute;
      inset: 0;
      z-index: 50;
      pointer-events: none;
      transform-style: preserve-3d;
    }

    /* Billboard Sprite — Counter-rotate to STAND UP and face camera */
    .iso-avatar {
      position: absolute;
      transform-style: preserve-3d;
      /* PICTO-PARTY: Just rotateX(-55deg) since no Z rotation in world */
      transform: rotateX(-55deg) translateZ(15px);
      pointer-events: auto;
      cursor: pointer;
    }

    /* SKY DROP ANIMATION — Characters fall from sky on spawn */
    .iso-avatar.sky-drop {
      animation: sky-drop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    @keyframes sky-drop {
      0% {
        transform: rotateX(-55deg) translateZ(15px) translateY(-400px);
        opacity: 0;
      }
      60% {
        transform: rotateX(-55deg) translateZ(15px) translateY(10px);
        opacity: 1;
      }
      80% {
        transform: rotateX(-55deg) translateZ(15px) translateY(-5px);
      }
      100% {
        transform: rotateX(-55deg) translateZ(15px) translateY(0);
      }
    }

    /* SQUIRCLE SHADOW — Separate element, stays FLAT on floor */
    .iso-avatar-shadow {
      position: absolute;
      width: 32px;
      height: 14px;
      bottom: -8px; /* Shadow at ground level where feet land */
      left: 50%;
      /* Shadow lies flat on the tilted floor — DO NOT counter-rotate */
      transform: translateX(-50%) translateZ(-15px);
      background: radial-gradient(ellipse, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.25) 60%, transparent 100%);
      border-radius: 50%;
      pointer-events: none;
      z-index: -1;
    }

    /* ═══════════════════════════════════════════════════════════════
       STICK FIGURE SPRITE — Pure CSS Xiao Xiao Style
       "Head: White circle. Body: Thick black lines. ATTITUDE." — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .iso-avatar-sprite {
      width: 40px;
      height: 70px; /* Taller to fit full body + legs */
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      /* Push sprite UP so feet touch the ground plane */
      margin-top: -10px;
    }

    /* STICK FIGURE HEAD — Larger for TG photos to be visible! */
    .stick-head {
      width: 28px;
      height: 28px;
      background: #fff;
      border: 3px solid #111;
      border-radius: 50%;
      position: relative;
      z-index: 3;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* AVATAR PHOTO — Circular crop inside the head */
    .avatar-photo {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }

    /* ═══════════════════════════════════════════════════════════════
       SPEECH BUBBLE — Shows their VOTE! (YES! / NO!)
       "Way cooler than names. They're SHOUTING their votes!" — User Feedback
    ═══════════════════════════════════════════════════════════════ */
    .vote-bubble {
      position: absolute;
      top: -32px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      font-weight: 900;
      white-space: nowrap;
      letter-spacing: 1px;
      z-index: 200;
      pointer-events: none;
      padding: 4px 10px;
      border-radius: 12px;
      animation: bubble-bounce 2s ease-in-out infinite;
    }

    /* Speech bubble tail pointing down */
    .vote-bubble::after {
      content: '';
      position: absolute;
      bottom: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
    }

    @keyframes bubble-bounce {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(-3px); }
    }

    /* YES BUBBLE — Cyan with glow */
    .iso-avatar.bet-yes .vote-bubble {
      background: linear-gradient(135deg, #00F0FF, #00C8FF);
      color: #000;
      text-shadow: none;
      box-shadow: 0 0 15px rgba(0, 240, 255, 0.6), 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    .iso-avatar.bet-yes .vote-bubble::after {
      border-top: 8px solid #00F0FF;
    }

    /* NO BUBBLE — Pink with glow */
    .iso-avatar.bet-no .vote-bubble {
      background: linear-gradient(135deg, #FF0055, #FF4B9B);
      color: #fff;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      box-shadow: 0 0 15px rgba(255, 0, 85, 0.6), 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    .iso-avatar.bet-no .vote-bubble::after {
      border-top: 8px solid #FF0055;
    }

    /* Small name under the bubble */
    .vote-name {
      position: absolute;
      top: -44px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 8px;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.8);
      white-space: nowrap;
      z-index: 199;
      pointer-events: none;
    }

    /* ═══════════════════════════════════════════════════════════════
       XIAO XIAO STYLE — Thin 2px Line Bodies (Newgrounds Classic!)
       "Pure lines. High energy. Flash animation polish." — Toshiro V11
    ═══════════════════════════════════════════════════════════════ */

    /* STICK FIGURE BODY — Thin 2px Torso Line */
    .stick-body {
      width: 2px;
      height: 18px;
      background: #fff;
      margin-top: -1px;
      position: relative;
      z-index: 2;
      border-radius: 1px;
    }

    /* STICK ARMS — Thin 2px Line (spread like fighting stance) */
    .stick-arms {
      position: absolute;
      top: 22px;
      left: 50%;
      transform: translateX(-50%);
      width: 36px;
      height: 2px;
      background: #fff;
      z-index: 1;
      border-radius: 1px;
    }

    /* STICK LEGS — Thin 2px Lines (slightly bent for fighting stance) */
    .stick-legs {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 24px;
      height: 22px;
    }

    .stick-legs::before,
    .stick-legs::after {
      content: '';
      position: absolute;
      width: 2px;
      height: 22px;
      background: #fff;
      top: 0;
      border-radius: 1px;
    }

    .stick-legs::before {
      left: 4px;
      transform: rotate(-12deg);
      transform-origin: top center;
    }

    .stick-legs::after {
      right: 4px;
      transform: rotate(12deg);
      transform-origin: top center;
    }

    /* ═══════════════════════════════════════════════════════════════
       STICK FIGURE STATES — Neon Glow Lines (Xiao Xiao Style)
       "Neutral = White. YES = Cyan. NO = Pink. Pure neon energy." — Toshiro
    ═══════════════════════════════════════════════════════════════ */

    /* NEUTRAL STATE — White lines, just observing */
    .iso-avatar.neutral .stick-head { border-color: #fff; }
    .iso-avatar.neutral .stick-body,
    .iso-avatar.neutral .stick-arms,
    .iso-avatar.neutral .stick-legs::before,
    .iso-avatar.neutral .stick-legs::after {
      background: #fff;
    }

    /* YES BET STATE — Cyan Neon Glow */
    .iso-avatar.bet-yes .stick-head {
      border-color: #00F0FF;
      box-shadow: 0 0 15px #00F0FF, 0 0 30px rgba(0, 240, 255, 0.6);
    }
    .iso-avatar.bet-yes .stick-body,
    .iso-avatar.bet-yes .stick-arms,
    .iso-avatar.bet-yes .stick-legs::before,
    .iso-avatar.bet-yes .stick-legs::after {
      background: #00F0FF;
      box-shadow: 0 0 10px #00F0FF, 0 0 20px rgba(0, 240, 255, 0.5);
    }

    /* NO BET STATE — Pink Neon Glow */
    .iso-avatar.bet-no .stick-head {
      border-color: #FF0055;
      box-shadow: 0 0 15px #FF0055, 0 0 30px rgba(255, 0, 85, 0.6);
    }
    .iso-avatar.bet-no .stick-body,
    .iso-avatar.bet-no .stick-arms,
    .iso-avatar.bet-no .stick-legs::before,
    .iso-avatar.bet-no .stick-legs::after {
      background: #FF0055;
      box-shadow: 0 0 10px #FF0055, 0 0 20px rgba(255, 0, 85, 0.5);
    }

    /* ═══════════════════════════════════════════════════════════════
       🥋 FIGHTING STANCE — Default High-Energy Idle (Xiao Xiao Style!)
       "Knees bent. Arms ready. Stick Figure ATTITUDE." — Toshiro V11

       This is the BASE stance — all dancers have this energy even when idle.
       Reference: Newgrounds stick fights. Ready for action!
    ═══════════════════════════════════════════════════════════════ */

    /* Fighting Stance Base — Subtle ready-to-fight sway */
    .iso-avatar .stick-body {
      animation: stance-body 1.5s ease-in-out infinite;
    }
    @keyframes stance-body {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-1px); }
    }

    /* Arms ready — subtle tension sway */
    .iso-avatar .stick-arms {
      animation: stance-arms 1.2s ease-in-out infinite;
      transform-origin: center;
    }
    @keyframes stance-arms {
      0%, 100% { transform: translateX(-50%) rotate(-5deg); }
      50% { transform: translateX(-50%) rotate(5deg); }
    }

    /* Legs in fighting stance — knees slightly bent, ready to spring */
    .iso-avatar .stick-legs::before {
      animation: stance-leg-l 1.3s ease-in-out infinite;
    }
    .iso-avatar .stick-legs::after {
      animation: stance-leg-r 1.3s ease-in-out infinite;
    }
    @keyframes stance-leg-l {
      0%, 100% { transform: rotate(-15deg) translateY(0); }
      50% { transform: rotate(-10deg) translateY(-1px); }
    }
    @keyframes stance-leg-r {
      0%, 100% { transform: rotate(15deg) translateY(0); }
      50% { transform: rotate(10deg) translateY(-1px); }
    }

    /* ═══════════════════════════════════════════════════════════════
       🕺 FORTNITE-LEVEL EPIC DANCE ANIMATIONS — 10 Unique Moves! 🕺
       "Make them SMILE like Miyamoto-san taught us." — Toshiro

       Each dance OVERRIDES the fighting stance with full expression!
    ═══════════════════════════════════════════════════════════════ */

    /* ═══ DANCE 1: THE BOUNCE — Classic Jump! ═══ */
    .iso-avatar.dance-bounce {
      animation: dance-bounce 0.45s ease-in-out infinite;
    }
    @keyframes dance-bounce {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) translateY(0) scale(1); }
      50% { transform: rotateX(-55deg) translateZ(15px) translateY(-15px) scale(1.05); }
    }
    .iso-avatar.dance-bounce .stick-arms {
      animation: bounce-arms 0.45s ease-in-out infinite;
    }
    @keyframes bounce-arms {
      0%, 100% { transform: translateX(-50%) rotate(0deg); width: 32px; }
      50% { transform: translateX(-50%) rotate(-30deg); width: 40px; }
    }
    .iso-avatar.dance-bounce .stick-legs::before { animation: bounce-leg-l 0.45s ease-in-out infinite; }
    .iso-avatar.dance-bounce .stick-legs::after { animation: bounce-leg-r 0.45s ease-in-out infinite; }
    @keyframes bounce-leg-l {
      0%, 100% { transform: rotate(-10deg); }
      50% { transform: rotate(-25deg) translateY(-5px); }
    }
    @keyframes bounce-leg-r {
      0%, 100% { transform: rotate(10deg); }
      50% { transform: rotate(25deg) translateY(-5px); }
    }

    /* ═══ DANCE 2: THE FLOSS — Fortnite Classic! ═══ */
    .iso-avatar.dance-floss {
      animation: dance-floss 0.6s ease-in-out infinite;
    }
    @keyframes dance-floss {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) translateX(-8px); }
      50% { transform: rotateX(-55deg) translateZ(15px) translateX(8px); }
    }
    .iso-avatar.dance-floss .stick-arms {
      animation: floss-arms 0.3s ease-in-out infinite;
    }
    @keyframes floss-arms {
      0%, 100% { transform: translateX(-50%) rotate(-45deg) scaleX(1.4); }
      50% { transform: translateX(-50%) rotate(45deg) scaleX(1.4); }
    }
    .iso-avatar.dance-floss .stick-body {
      animation: floss-hips 0.3s ease-in-out infinite;
    }
    @keyframes floss-hips {
      0%, 100% { transform: rotate(-10deg); }
      50% { transform: rotate(10deg); }
    }

    /* ═══ DANCE 3: THE ROBOT — Mechanical Precision! ═══ */
    .iso-avatar.dance-robot {
      animation: dance-robot 1.2s steps(4) infinite;
    }
    @keyframes dance-robot {
      0%, 25% { transform: rotateX(-55deg) translateZ(15px) rotate(0deg); }
      25%, 50% { transform: rotateX(-55deg) translateZ(15px) rotate(15deg) translateY(-5px); }
      50%, 75% { transform: rotateX(-55deg) translateZ(15px) rotate(-15deg) translateY(-5px); }
      75%, 100% { transform: rotateX(-55deg) translateZ(15px) rotate(0deg); }
    }
    .iso-avatar.dance-robot .stick-arms {
      animation: robot-arms 1.2s steps(4) infinite;
    }
    @keyframes robot-arms {
      0%, 25% { transform: translateX(-50%) rotate(90deg); }
      25%, 50% { transform: translateX(-50%) rotate(0deg); }
      50%, 75% { transform: translateX(-50%) rotate(-90deg); }
      75%, 100% { transform: translateX(-50%) rotate(0deg); }
    }

    /* ═══ DANCE 4: THE WAVE — Smooth Body Roll! ═══ */
    .iso-avatar.dance-wave {
      animation: dance-wave 1.5s ease-in-out infinite;
    }
    @keyframes dance-wave {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) translateY(0) scaleY(1); }
      25% { transform: rotateX(-55deg) translateZ(15px) translateY(-8px) scaleY(1.1); }
      50% { transform: rotateX(-55deg) translateZ(15px) translateY(0) scaleY(0.95); }
      75% { transform: rotateX(-55deg) translateZ(15px) translateY(5px) scaleY(1.05); }
    }
    .iso-avatar.dance-wave .stick-arms {
      animation: wave-arms 1.5s ease-in-out infinite;
    }
    @keyframes wave-arms {
      0%, 100% { transform: translateX(-50%) rotate(0deg) translateY(0); }
      25% { transform: translateX(-50%) rotate(30deg) translateY(-10px); }
      50% { transform: translateX(-50%) rotate(0deg) translateY(0); }
      75% { transform: translateX(-50%) rotate(-30deg) translateY(5px); }
    }

    /* ═══ DANCE 5: JUMPING JACKS — High Energy! ═══ */
    .iso-avatar.dance-jumpjack {
      animation: dance-jumpjack 0.5s ease-in-out infinite;
    }
    @keyframes dance-jumpjack {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) translateY(0); }
      50% { transform: rotateX(-55deg) translateZ(20px) translateY(-20px); }
    }
    .iso-avatar.dance-jumpjack .stick-arms {
      animation: jumpjack-arms 0.5s ease-in-out infinite;
    }
    @keyframes jumpjack-arms {
      0%, 100% { transform: translateX(-50%) rotate(0deg); width: 32px; }
      50% { transform: translateX(-50%) rotate(-90deg); width: 50px; }
    }
    .iso-avatar.dance-jumpjack .stick-legs::before { animation: jumpjack-leg-l 0.5s ease-in-out infinite; }
    .iso-avatar.dance-jumpjack .stick-legs::after { animation: jumpjack-leg-r 0.5s ease-in-out infinite; }
    @keyframes jumpjack-leg-l {
      0%, 100% { transform: rotate(-10deg); }
      50% { transform: rotate(-40deg); }
    }
    @keyframes jumpjack-leg-r {
      0%, 100% { transform: rotate(10deg); }
      50% { transform: rotate(40deg); }
    }

    /* ═══ DANCE 6: HEADBANG — Rock On! ═══ */
    .iso-avatar.dance-headbang {
      animation: dance-headbang 0.25s ease-in-out infinite;
    }
    @keyframes dance-headbang {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) rotate(0deg); }
      50% { transform: rotateX(-55deg) translateZ(15px) rotate(15deg) translateY(8px); }
    }
    .iso-avatar.dance-headbang .stick-head {
      animation: headbang-head 0.25s ease-in-out infinite;
    }
    @keyframes headbang-head {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(6px) scale(0.95); }
    }
    .iso-avatar.dance-headbang .stick-arms {
      animation: headbang-arms 0.5s ease-in-out infinite;
    }
    @keyframes headbang-arms {
      0%, 100% { transform: translateX(-50%) rotate(30deg); }
      50% { transform: translateX(-50%) rotate(-30deg); }
    }

    /* ═══ DANCE 7: DISCO POINT — Saturday Night Fever! ═══ */
    .iso-avatar.dance-disco {
      animation: dance-disco 1s ease-in-out infinite;
    }
    @keyframes dance-disco {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) rotate(-5deg); }
      25% { transform: rotateX(-55deg) translateZ(20px) translateY(-10px) rotate(5deg); }
      50% { transform: rotateX(-55deg) translateZ(15px) rotate(-5deg); }
      75% { transform: rotateX(-55deg) translateZ(20px) translateY(-10px) rotate(5deg); }
    }
    .iso-avatar.dance-disco .stick-arms {
      animation: disco-arms 1s ease-in-out infinite;
    }
    @keyframes disco-arms {
      0%, 50% { transform: translateX(-50%) rotate(-60deg) scaleX(1.2); }
      25% { transform: translateX(-30%) rotate(60deg) scaleX(1.3); }
      75% { transform: translateX(-70%) rotate(60deg) scaleX(1.3); }
      100% { transform: translateX(-50%) rotate(-60deg) scaleX(1.2); }
    }

    /* ═══ DANCE 8: RUNNING MAN — Classic Hip Hop! ═══ */
    .iso-avatar.dance-runman {
      animation: dance-runman 0.4s ease-in-out infinite;
    }
    @keyframes dance-runman {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) translateY(0); }
      50% { transform: rotateX(-55deg) translateZ(15px) translateY(-8px); }
    }
    .iso-avatar.dance-runman .stick-legs::before { animation: runman-leg-l 0.4s ease-in-out infinite; }
    .iso-avatar.dance-runman .stick-legs::after { animation: runman-leg-r 0.4s ease-in-out infinite; }
    @keyframes runman-leg-l {
      0%, 100% { transform: rotate(-30deg) translateY(0); height: 20px; }
      50% { transform: rotate(20deg) translateY(-10px); height: 15px; }
    }
    @keyframes runman-leg-r {
      0%, 100% { transform: rotate(20deg) translateY(-10px); height: 15px; }
      50% { transform: rotate(-30deg) translateY(0); height: 20px; }
    }
    .iso-avatar.dance-runman .stick-arms {
      animation: runman-arms 0.4s ease-in-out infinite;
    }
    @keyframes runman-arms {
      0%, 100% { transform: translateX(-50%) rotate(20deg); }
      50% { transform: translateX(-50%) rotate(-20deg); }
    }

    /* ═══ DANCE 9: THE DAB — Iconic Move! ═══ */
    .iso-avatar.dance-dab {
      animation: dance-dab 1.5s ease-in-out infinite;
    }
    @keyframes dance-dab {
      0%, 70%, 100% { transform: rotateX(-55deg) translateZ(15px) rotate(0deg); }
      35% { transform: rotateX(-55deg) translateZ(20px) rotate(-25deg) translateY(-5px); }
    }
    .iso-avatar.dance-dab .stick-arms {
      animation: dab-arms 1.5s ease-in-out infinite;
    }
    @keyframes dab-arms {
      0%, 70%, 100% { transform: translateX(-50%) rotate(0deg); width: 32px; }
      35% { transform: translateX(-30%) rotate(-60deg) scaleX(1.8); width: 45px; }
    }
    .iso-avatar.dance-dab .stick-head {
      animation: dab-head 1.5s ease-in-out infinite;
    }
    @keyframes dab-head {
      0%, 70%, 100% { transform: rotate(0deg); }
      35% { transform: rotate(-30deg) translateX(-5px); }
    }

    /* ═══ DANCE 10: THE TWIST — Classic 60s! ═══ */
    .iso-avatar.dance-twist {
      animation: dance-twist 0.5s ease-in-out infinite;
    }
    @keyframes dance-twist {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) rotate(-15deg) translateY(0); }
      50% { transform: rotateX(-55deg) translateZ(15px) rotate(15deg) translateY(-5px); }
    }
    .iso-avatar.dance-twist .stick-body {
      animation: twist-body 0.5s ease-in-out infinite;
    }
    @keyframes twist-body {
      0%, 100% { transform: rotate(-10deg); }
      50% { transform: rotate(10deg); }
    }
    .iso-avatar.dance-twist .stick-arms {
      animation: twist-arms 0.5s ease-in-out infinite;
    }
    @keyframes twist-arms {
      0%, 100% { transform: translateX(-50%) rotate(20deg); }
      50% { transform: translateX(-50%) rotate(-20deg); }
    }
    .iso-avatar.dance-twist .stick-legs::before,
    .iso-avatar.dance-twist .stick-legs::after {
      animation: twist-legs 0.25s ease-in-out infinite;
    }
    @keyframes twist-legs {
      0%, 100% { transform: rotate(0deg); }
      50% { transform: rotate(20deg); }
    }

    /* ═══ DANCE 11: THE SHUFFLE — Melbourne Shuffle! ═══ */
    .iso-avatar.dance-shuffle {
      animation: dance-shuffle 0.6s ease-in-out infinite;
    }
    @keyframes dance-shuffle {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) translateX(0); }
      25% { transform: rotateX(-55deg) translateZ(18px) translateX(-8px) translateY(-3px); }
      50% { transform: rotateX(-55deg) translateZ(15px) translateX(0); }
      75% { transform: rotateX(-55deg) translateZ(18px) translateX(8px) translateY(-3px); }
    }
    .iso-avatar.dance-shuffle .stick-legs::before {
      animation: shuffle-leg-l 0.3s ease-in-out infinite;
    }
    .iso-avatar.dance-shuffle .stick-legs::after {
      animation: shuffle-leg-r 0.3s ease-in-out infinite;
    }
    @keyframes shuffle-leg-l {
      0%, 100% { transform: rotate(-30deg) translateY(0); }
      50% { transform: rotate(15deg) translateY(-8px); }
    }
    @keyframes shuffle-leg-r {
      0%, 100% { transform: rotate(15deg) translateY(-8px); }
      50% { transform: rotate(-30deg) translateY(0); }
    }
    .iso-avatar.dance-shuffle .stick-arms {
      animation: shuffle-arms 0.6s ease-in-out infinite;
    }
    @keyframes shuffle-arms {
      0%, 50%, 100% { transform: translateX(-50%) rotate(0deg); }
      25% { transform: translateX(-50%) rotate(20deg) translateY(-3px); }
      75% { transform: translateX(-50%) rotate(-20deg) translateY(-3px); }
    }

    /* ═══ DANCE 12: ORANGE JUSTICE — The Fortnite Classic! ═══ */
    .iso-avatar.dance-orange {
      animation: dance-orange 0.5s ease-in-out infinite;
    }
    @keyframes dance-orange {
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) rotate(-5deg); }
      50% { transform: rotateX(-55deg) translateZ(20px) rotate(5deg) translateY(-8px); }
    }
    .iso-avatar.dance-orange .stick-body {
      animation: orange-body 0.25s ease-in-out infinite;
    }
    @keyframes orange-body {
      0%, 100% { transform: rotate(-8deg); }
      50% { transform: rotate(8deg); }
    }
    .iso-avatar.dance-orange .stick-arms {
      animation: orange-arms 0.25s ease-in-out infinite;
    }
    @keyframes orange-arms {
      0%, 100% { transform: translateX(-30%) rotate(-45deg) scaleX(1.2); }
      50% { transform: translateX(-70%) rotate(45deg) scaleX(1.2); }
    }
    .iso-avatar.dance-orange .stick-legs::before {
      animation: orange-leg-l 0.25s ease-in-out infinite;
    }
    .iso-avatar.dance-orange .stick-legs::after {
      animation: orange-leg-r 0.25s ease-in-out infinite;
    }
    @keyframes orange-leg-l {
      0%, 100% { transform: rotate(-20deg); }
      50% { transform: rotate(30deg) translateY(-5px); }
    }
    @keyframes orange-leg-r {
      0%, 100% { transform: rotate(30deg) translateY(-5px); }
      50% { transform: rotate(-20deg); }
    }

    /* ═══════════════════════════════════════════════════════════════
       STICK FIGURE FACES — Punctuation Expressions!
       "Use simple punctuation faces: :) B) >:|" — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .stick-face {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 10px;
      font-weight: 900;
      color: #111;
      font-family: monospace;
      line-height: 1;
      white-space: nowrap;
    }

    /* Different face expressions */
    .stick-face.happy::before { content: ':)'; }
    .stick-face.cool::before { content: 'B)'; }
    .stick-face.angry::before { content: '>:|'; }
    .stick-face.surprised::before { content: ':O'; }
    .stick-face.wink::before { content: ';)'; }
    .stick-face.smirk::before { content: ':>'; }

    /* Avatar Head with photo */
    .iso-avatar-head {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #222;
      border: 2px solid rgba(255, 255, 255, 0.3);
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
      z-index: 2;
    }

    .iso-avatar-photo {
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
    }

    /* Avatar Body — Default neutral */
    .iso-avatar-body {
      width: 16px;
      height: 20px;
      background: linear-gradient(180deg, #2a2a35 0%, #1a1a22 100%);
      border-radius: 4px 4px 0 0;
      margin-top: -4px;
      z-index: 1;
      transition: background 0.3s ease;
    }

    /* ═══ BETSIDE OUTFIT COLORS — "Your clothes tell your story" ═══ */

    /* YES Team Outfit — Cyan */
    .iso-avatar.bet-yes .iso-avatar-body {
      background: linear-gradient(180deg, #00D0DD 0%, #008899 100%);
      box-shadow: 0 0 8px rgba(0, 240, 255, 0.4);
    }

    .iso-avatar.bet-yes .iso-avatar-head {
      border-color: #00F0FF;
      box-shadow: 0 0 12px rgba(0, 240, 255, 0.5), 0 2px 8px rgba(0, 0, 0, 0.5);
    }

    /* NO Team Outfit — Pink */
    .iso-avatar.bet-no .iso-avatar-body {
      background: linear-gradient(180deg, #DD0055 0%, #990033 100%);
      box-shadow: 0 0 8px rgba(255, 0, 85, 0.4);
    }

    .iso-avatar.bet-no .iso-avatar-head {
      border-color: #FF0055;
      box-shadow: 0 0 12px rgba(255, 0, 85, 0.5), 0 2px 8px rgba(0, 0, 0, 0.5);
    }

    /* Party Hat / Aura — The "Drip" */
    .iso-avatar-aura {
      position: absolute;
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 14px;
      filter: drop-shadow(0 0 4px currentColor);
      z-index: 3;
    }

    .iso-avatar-aura.yes { color: #00F0FF; }
    .iso-avatar-aura.no { color: #FF0055; }

    /* Avatar Bounce — Dancing to the beat */
    .iso-avatar.dancing {
      animation: avatar-bounce 0.468s ease-in-out infinite;
    }

    @keyframes avatar-bounce {
      /* PICTO-PARTY: Simple rotateX(-55deg) counter-rotation */
      0%, 100% { transform: rotateX(-55deg) translateZ(15px) translateY(0); }
      50% { transform: rotateX(-55deg) translateZ(15px) translateY(-5px); }
    }

    /* Zone Labels — REMOVED from 3D space, now in HUD */
    .iso-zone-label {
      display: none; /* Labels now on wall screens */
    }

    .iso-zone-label.yes,
    .iso-zone-label.no {
      display: none;
    }

    /* Zone Scores — HIDDEN (now on wall screens) */
    .iso-zone-score {
      display: none; /* Scores now on wall screens */
    }

    .iso-zone-score.yes,
    .iso-zone-score.no {
      display: none;
    }

    /* ═══ PLAYER AVATAR — Liftable with floor shadow ═══ */
    .iso-player {
      position: absolute;
      z-index: 200;
      transform-style: preserve-3d;
      cursor: grab;
      touch-action: none;
    }

    .iso-player:active { cursor: grabbing; }

    /* Player sprite — CORRECT counter-rotation to stand up */
    .iso-player-sprite {
      /* PICTO-PARTY: Simple rotateX(-55deg) counter-rotation */
      transform: rotateX(-55deg);
      transform-origin: center bottom;
      transition: transform 0.2s ease;
    }

    /* Lifted state — Player floats up */
    .iso-player.lifted .iso-player-sprite {
      transform: rotateX(-55deg) translateZ(40px) scale(1.1);
      filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.5));
    }

    /* Floor Shadow — Stays on ground while player lifts */
    .iso-player-shadow {
      position: absolute;
      width: 30px;
      height: 10px;
      background: radial-gradient(ellipse, rgba(0, 0, 0, 0.5) 0%, transparent 70%);
      left: 50%;
      bottom: -5px;
      transform: translateX(-50%);
      transition: all 0.2s ease;
    }

    .iso-player.lifted .iso-player-shadow {
      width: 40px;
      height: 15px;
      opacity: 0.7;
      bottom: -20px;
    }

    /* Player Head */
    .iso-player-head {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #fff;
      border: 3px solid #FFD700;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      margin: 0 auto;
    }

    .iso-player-photo {
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
    }

    /* Player Body */
    .iso-player-body {
      width: 20px;
      height: 24px;
      background: linear-gradient(180deg, #fff 0%, #ddd 100%);
      border-radius: 6px 6px 0 0;
      margin: -6px auto 0;
    }

    /* Player Crown — You're the star */
    .iso-player-crown {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 16px;
      filter: drop-shadow(0 0 8px #FFD700);
      animation: crown-float 2s ease-in-out infinite;
    }

    @keyframes crown-float {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(-3px); }
    }

    /* Hide old floor-tiles */
    .floor-tiles,
    .dance-floor {
      display: none !important;
    }

    /* ═══════════════════════════════════════════════════════════════
       DISCO BALL — "After Effects" Light Sweep Shimmer
       Static ball with dynamic light reflections
    ═══════════════════════════════════════════════════════════════ */
    .disco-ball {
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 30;
    }

    .disco-ball-top {
      width: 2px;
      height: 20px;
      background: linear-gradient(180deg, rgba(255,255,255,0.4), rgba(255,255,255,0.1));
      margin: 0 auto;
      border-radius: 1px;
    }

    .disco-ball-sphere {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      position: relative;
      overflow: hidden;
      /* Metallic base */
      background: radial-gradient(ellipse at 30% 30%,
        #888 0%,
        #555 30%,
        #333 60%,
        #222 100%
      );
      box-shadow:
        0 4px 20px rgba(0,0,0,0.6),
        inset 0 -10px 20px rgba(0,0,0,0.4),
        inset 0 5px 10px rgba(255,255,255,0.2);
    }

    /* Mirror Facet Grid Pattern */
    .disco-ball-sphere::before {
      content: '';
      position: absolute;
      inset: 2px;
      border-radius: 50%;
      background-image:
        linear-gradient(0deg, transparent 48%, rgba(255,255,255,0.4) 49%, rgba(255,255,255,0.4) 51%, transparent 52%),
        linear-gradient(90deg, transparent 48%, rgba(255,255,255,0.4) 49%, rgba(255,255,255,0.4) 51%, transparent 52%),
        linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.2) 49%, rgba(255,255,255,0.2) 51%, transparent 52%),
        linear-gradient(-45deg, transparent 48%, rgba(255,255,255,0.2) 49%, rgba(255,255,255,0.2) 51%, transparent 52%);
      background-size: 6px 6px;
      opacity: 0.8;
    }

    /* THE LIGHT SWEEP — Shimmer Effect (No Rotation!) */
    .disco-ball-sphere::after {
      content: '';
      position: absolute;
      inset: -50%;
      background: radial-gradient(ellipse 30% 50% at 50% 50%,
        rgba(255, 255, 255, 0.9) 0%,
        rgba(255, 255, 255, 0.4) 30%,
        transparent 70%
      );
      animation: disco-light-sweep 0.9375s ease-in-out infinite; /* 128 BPM = 2 beats */
      pointer-events: none;
    }

    @keyframes disco-light-sweep {
      0% {
        transform: translate(-80%, -80%) scale(0.5);
        opacity: 0.3;
      }
      25% {
        opacity: 1;
      }
      50% {
        transform: translate(80%, 80%) scale(0.8);
        opacity: 0.5;
      }
      75% {
        opacity: 0.8;
      }
      100% {
        transform: translate(-80%, -80%) scale(0.5);
        opacity: 0.3;
      }
    }

    /* Sparkle Points on the ball */
    .disco-facet {
      position: absolute;
      width: 4px;
      height: 4px;
      background: #fff;
      border-radius: 50%;
      animation: facet-sparkle 0.46875s ease-in-out infinite; /* 128 BPM */
    }

    .disco-facet:nth-child(1) { top: 20%; left: 25%; animation-delay: 0s; }
    .disco-facet:nth-child(2) { top: 35%; left: 65%; animation-delay: -0.117s; }
    .disco-facet:nth-child(3) { top: 55%; left: 30%; animation-delay: -0.234s; }
    .disco-facet:nth-child(4) { top: 70%; left: 60%; animation-delay: -0.351s; }

    @keyframes facet-sparkle {
      0%, 100% {
        opacity: 0.2;
        transform: scale(0.5);
        box-shadow: 0 0 2px #fff;
      }
      50% {
        opacity: 1;
        transform: scale(1.5);
        box-shadow: 0 0 10px #fff, 0 0 20px rgba(255,255,255,0.5);
      }
    }

    /* Reflection Scatter — Light dots on the room */
    .disco-ball-reflection {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 100px;
      pointer-events: none;
    }

    .disco-ball-reflection::before,
    .disco-ball-reflection::after {
      content: '';
      position: absolute;
      width: 6px;
      height: 6px;
      background: #fff;
      border-radius: 50%;
      animation: scatter-dot 2s ease-in-out infinite;
    }

    .disco-ball-reflection::before {
      top: 20px;
      left: 30%;
      box-shadow:
        40px 10px 0 #00F0FF,
        -20px 30px 0 #FF0055,
        60px 40px 0 #fff,
        -40px 15px 0 #FFD700;
      animation-delay: -0.5s;
    }

    .disco-ball-reflection::after {
      top: 35px;
      left: 60%;
      box-shadow:
        -30px 5px 0 #00F0FF,
        20px 25px 0 #FF0055,
        -10px 40px 0 #fff;
      animation-delay: -1s;
    }

    @keyframes scatter-dot {
      0%, 100% {
        opacity: 0.3;
        transform: scale(0.8);
      }
      50% {
        opacity: 0.8;
        transform: scale(1.2);
      }
    }

    .floor-zone.no .floor-score {
      color: var(--neon-pink);
    }

    .floor-zone.yes .floor-score {
      color: var(--neon-cyan);
    }

    /* Crowd Container - PARTY SPREAD! Villagers fill the zone */
    .crowd-area {
      position: absolute;
      top: 35px; /* Space for label */
      left: 8px;
      right: 8px;
      bottom: 45px; /* Space for score */
      z-index: 10;
      overflow: visible; /* Let speech bubbles overflow */
    }

    /* ═══════════════════════════════════════════════════════════════
       VILLAGERS — With Speech Bubbles Above Heads (Miiverse Style)
    ═══════════════════════════════════════════════════════════════ */
    .villager {
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: villager-dance 0.9375s ease-in-out infinite;
      animation-delay: var(--delay, 0s);
      position: relative;
    }

    /* Speech Bubble Above Head */
    .villager-speech {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      margin-bottom: 8px;
      padding: 6px 10px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      color: #333;
      white-space: nowrap;
      opacity: 0;
      animation: speech-pop 4s ease-in-out infinite;
      animation-delay: var(--speech-delay, 0s);
      z-index: 100;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .villager-speech::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: rgba(255, 255, 255, 0.95);
    }

    @keyframes speech-pop {
      0%, 70%, 100% { opacity: 0; transform: translateX(-50%) translateY(5px) scale(0.8); }
      10%, 60% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
    }

    /* Player Speech Bubble — Miiverse Style */
    .player-speech {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      margin-bottom: 10px;
      padding: 8px 14px;
      background: linear-gradient(135deg, #fff, #f8f8ff);
      border-radius: 16px;
      font-size: 12px;
      font-weight: 600;
      color: #333;
      white-space: nowrap;
      opacity: 0;
      z-index: 150;
      box-shadow: 0 4px 16px rgba(0,0,0,0.25), 0 0 0 2px rgba(255,255,255,0.1);
      pointer-events: none;
      transition: all 0.3s var(--bounce);
    }

    .player-speech::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 8px solid transparent;
      border-top-color: #fff;
    }

    .player-speech.visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0) scale(1);
      animation: speech-bounce 0.4s var(--bounce);
    }

    @keyframes speech-bounce {
      0% { transform: translateX(-50%) translateY(10px) scale(0.5); }
      50% { transform: translateX(-50%) translateY(-3px) scale(1.05); }
      100% { transform: translateX(-50%) translateY(0) scale(1); }
    }

    @keyframes villager-dance {
      0%, 100% { transform: translateY(0) rotate(-2deg); }
      25% { transform: translateY(-6px) rotate(0deg); }
      50% { transform: translateY(0) rotate(2deg); }
      75% { transform: translateY(-4px) rotate(0deg); }
    }

    .villager-head {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      position: relative;
      background: var(--skin, #ffd5b8);
      box-shadow: 0 2px 0 rgba(0,0,0,0.15);
    }

    /* Telegram Photo Avatar */
    .villager-photo {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      background-color: #0a0a12; /* Dark fallback for transparent images */
      border: 3px solid var(--neon-cyan);
      box-shadow: 0 0 12px var(--neon-cyan), 0 4px 8px rgba(0,0,0,0.4);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    /* Vignette overlay — blends bright backgrounds into dark theme */
    .villager-photo::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 50%;
      /* Radial vignette: dark edges, clear center */
      background: radial-gradient(
        circle at center,
        transparent 40%,
        rgba(0, 0, 0, 0.3) 70%,
        rgba(0, 0, 0, 0.6) 100%
      );
      pointer-events: none;
    }

    .villager:hover .villager-photo {
      transform: scale(1.1);
    }

    /* ═══════════════════════════════════════════════════════════════
       PLAYER PHOTO HEAD + STICK BODY — Like villagers but with your photo
    ═══════════════════════════════════════════════════════════════ */
    .player-photo-head {
      border-color: var(--neon-gold) !important;
      box-shadow: 0 0 15px var(--neon-gold), 0 4px 12px rgba(0,0,0,0.5) !important;
    }

    .player-stick-body {
      --body-color: #fff;
    }

    /* Team colors for player */
    .player.team-yes .player-photo-head {
      border-color: var(--neon-cyan) !important;
      box-shadow: 0 0 20px var(--neon-cyan), 0 4px 12px rgba(0,0,0,0.5) !important;
    }

    .player.team-yes .player-stick-body {
      --body-color: var(--neon-cyan);
    }

    .player.team-no .player-photo-head {
      border-color: var(--neon-pink) !important;
      box-shadow: 0 0 20px var(--neon-pink), 0 4px 12px rgba(0,0,0,0.5) !important;
    }

    .player.team-no .player-stick-body {
      --body-color: var(--neon-pink);
    }

    /* Player dancing when on team */
    .player.team-yes .villager-avatar,
    .player.team-no .villager-avatar {
      animation: habbo-bounce 0.46875s ease-in-out infinite;
    }

    .player.team-yes .stick-arm.left,
    .player.team-no .stick-arm.left {
      animation: arms-pump-left 0.46875s ease-in-out infinite;
    }

    .player.team-yes .stick-arm.right,
    .player.team-no .stick-arm.right {
      animation: arms-pump-right 0.46875s ease-in-out infinite;
    }

    .player.team-yes .stick-leg.left,
    .player.team-no .stick-leg.left {
      animation: legs-march-left 0.46875s ease-in-out infinite;
    }

    .player.team-yes .stick-leg.right,
    .player.team-no .stick-leg.right {
      animation: legs-march-right 0.46875s ease-in-out infinite;
    }

    /* At door - no dancing, standing still */
    .player.at-door .villager-avatar,
    .player.at-door .stick-arm,
    .player.at-door .stick-leg {
      animation: none !important;
    }

    /* GET ON DOWN! James Brown funk when player commits to a side */
    .player.team-yes .villager-avatar,
    .player.team-no .villager-avatar {
      animation: james-brown-head 0.3s ease-in-out infinite;
    }

    .player.team-yes .stick-arm.left,
    .player.team-no .stick-arm.left {
      animation: james-brown-arm-left 0.3s ease-in-out infinite !important;
    }

    .player.team-yes .stick-arm.right,
    .player.team-no .stick-arm.right {
      animation: james-brown-arm-right 0.3s ease-in-out infinite !important;
    }

    .player.team-yes .stick-leg.left,
    .player.team-no .stick-leg.left {
      animation: james-brown-leg-left 0.15s ease-in-out infinite !important;
    }

    .player.team-yes .stick-leg.right,
    .player.team-no .stick-leg.right {
      animation: james-brown-leg-right 0.15s ease-in-out infinite !important;
    }

    @keyframes james-brown-head {
      0%, 100% { transform: translateY(0) rotate(-3deg); }
      25% { transform: translateY(-3px) rotate(3deg); }
      50% { transform: translateY(0) rotate(-3deg); }
      75% { transform: translateY(-3px) rotate(3deg); }
    }

    @keyframes james-brown-arm-left {
      0%, 100% { transform: rotate(-70deg) translateY(0); }
      50% { transform: rotate(-30deg) translateY(-2px); }
    }

    @keyframes james-brown-arm-right {
      0%, 100% { transform: rotate(30deg) translateY(-2px); }
      50% { transform: rotate(70deg) translateY(0); }
    }

    @keyframes james-brown-leg-left {
      0%, 100% { transform: rotate(20deg); }
      50% { transform: rotate(-10deg); }
    }

    @keyframes james-brown-leg-right {
      0%, 100% { transform: rotate(-10deg); }
      50% { transform: rotate(20deg); }
    }

    .villager-hair {
      position: absolute;
      top: -3px;
      left: 50%;
      transform: translateX(-50%);
      width: 24px;
      height: 12px;
      border-radius: 12px 12px 0 0;
      background: var(--hair, #4a3728);
    }

    .villager-hair.spiky {
      width: 30px;
      height: 10px;
      top: -5px;
      clip-path: polygon(10% 100%, 0% 40%, 15% 100%, 25% 20%, 35% 100%, 50% 0%, 65% 100%, 75% 20%, 85% 100%, 100% 40%, 90% 100%);
      border-radius: 0;
    }

    .villager-eyes {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 5px;
    }

    .villager-eye {
      width: 4px;
      height: 5px;
      background: #1a1a1a;
      border-radius: 50%;
    }

    .villager-body {
      width: 26px;
      height: 20px;
      background: var(--shirt, #fff);
      border-radius: 6px 6px 4px 4px;
      margin-top: -4px;
      box-shadow: 0 2px 0 rgba(0,0,0,0.1);
    }

    .villager-feet {
      display: flex;
      gap: 3px;
      margin-top: -2px;
    }

    .villager-foot {
      width: 8px;
      height: 5px;
      background: #333;
      border-radius: 2px;
    }

    .villager-name {
      font-size: 7px;
      font-weight: 600;
      color: rgba(255,255,255,0.8);
      margin-top: 3px;
      text-align: center;
      max-width: 40px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Center Stage removed - player now directly on floor */
    .zone-label-old {
      position: absolute;
      top: 16px;
      font-size: 14px;
      font-weight: 700;
      letter-spacing: 4px;
      text-transform: uppercase;
      opacity: 0.7;
      text-shadow: 0 0 20px currentColor;
    }

    .zone.no .zone-label { left: 20px; color: var(--neon-pink); }
    .zone.yes .zone-label { right: 20px; color: var(--neon-cyan); }

    /* Center Divider — Neon Line */
    .floor-divider {
      position: absolute;
      left: 50%;
      top: 0;
      bottom: 120px;
      width: 2px;
      background: linear-gradient(180deg,
        transparent,
        var(--neon-purple) 20%,
        var(--neon-purple) 80%,
        transparent
      );
      transform: translateX(-50%);
      box-shadow: 0 0 10px var(--neon-purple), 0 0 20px var(--neon-purple);
      z-index: 2;
    }

    /* ═══════════════════════════════════════════════════════════════
       GRUNGY TECHNO FILTER — Underground Club Vibes
    ═══════════════════════════════════════════════════════════════ */
    .grunge-overlay {
      position: absolute;
      inset: 0;
      z-index: 4;
      pointer-events: none;
      overflow: hidden;
      opacity: 0.6;
    }

    /* Film Grain — Animated Noise Texture */
    .grunge-grain {
      position: absolute;
      inset: -50%;
      width: 200%;
      height: 200%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.02;
      animation: grain-shift 0.5s steps(10) infinite;
      mix-blend-mode: overlay;
    }

    @keyframes grain-shift {
      0%, 100% { transform: translate(0, 0); }
      10% { transform: translate(-2%, -2%); }
      20% { transform: translate(2%, 2%); }
      30% { transform: translate(-1%, 3%); }
      40% { transform: translate(3%, -1%); }
      50% { transform: translate(-3%, 1%); }
      60% { transform: translate(1%, -3%); }
      70% { transform: translate(-2%, 2%); }
      80% { transform: translate(2%, -2%); }
      90% { transform: translate(-1%, -1%); }
    }

    /* CRT Scanlines — VHS Techno Aesthetic */
    .grunge-scanlines {
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent 0px,
        transparent 3px,
        rgba(0, 0, 0, 0.08) 3px,
        rgba(0, 0, 0, 0.08) 6px
      );
      opacity: 0.25;
    }

    /* Vignette — Subtle Dark Edges */
    .grunge-vignette {
      position: absolute;
      inset: 0;
      background: radial-gradient(
        ellipse at center,
        transparent 50%,
        rgba(0, 0, 0, 0.15) 80%,
        rgba(0, 0, 0, 0.3) 100%
      );
    }

    /* Color Grade — Very Subtle Purple Hint */
    .grunge-color-grade {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        180deg,
        rgba(138, 43, 226, 0.03) 0%,
        rgba(75, 0, 130, 0.04) 50%,
        rgba(255, 0, 128, 0.02) 100%
      );
      mix-blend-mode: color;
    }

    /* Chromatic Aberration — RGB Split */
    .grunge-aberration {
      position: absolute;
      inset: 0;
      opacity: 0.4;
    }

    .grunge-aberration::before,
    .grunge-aberration::after {
      content: '';
      position: absolute;
      inset: 0;
      background: inherit;
    }

    .grunge-aberration::before {
      box-shadow: -1px 0 0 rgba(255, 0, 0, 0.15);
    }

    .grunge-aberration::after {
      box-shadow: 1px 0 0 rgba(0, 255, 255, 0.15);
    }

    /* Subtle Flicker — Barely Perceptible */
    .grunge-flicker {
      position: absolute;
      inset: 0;
      background: rgba(255, 255, 255, 0.01);
      animation: flicker 6s ease-in-out infinite;
    }

    @keyframes flicker {
      0%, 100% { opacity: 0; }
      50% { opacity: 0.01; }
      95% { opacity: 0; }
      96% { opacity: 0.015; }
      97% { opacity: 0; }
    }

    /* Glow Bloom — Dreamy Haze */
    .grunge-bloom {
      position: absolute;
      inset: 0;
      backdrop-filter: blur(0.3px);
      -webkit-backdrop-filter: blur(0.3px);
    }

    /* ═══════════════════════════════════════════════════════════════
       ARENA STAGE LIGHTS — Epic Club Experience (FULLSCREEN!)
    ═══════════════════════════════════════════════════════════════ */
    .arena-stage-lights {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 3;
      overflow: hidden;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    /* Only show when arena is active */
    .arena-screen.active .arena-stage-lights {
      opacity: 1;
    }

    /* Moving Stage Spotlights */
    .arena-spotlight {
      position: absolute;
      top: -20%;
      width: 250px;
      height: 160%;
      transform-origin: 50% 0%;
      mix-blend-mode: screen;
    }

    .arena-spotlight::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      height: 100%;
      clip-path: polygon(45% 0%, 55% 0%, 100% 100%, 0% 100%);
      filter: blur(3px);
      background: inherit;
    }

    /* Left Cyan Spotlight */
    .arena-spotlight.left-1 {
      left: -5%;
      background: linear-gradient(180deg,
        rgba(0, 245, 255, 1) 0%,
        rgba(0, 245, 255, 0.5) 30%,
        rgba(0, 245, 255, 0.1) 70%,
        transparent 100%
      );
      animation: arena-spot-left 4s ease-in-out infinite;
      opacity: 0.5;
    }

    .arena-spotlight.left-2 {
      left: 10%;
      background: linear-gradient(180deg,
        rgba(0, 200, 255, 0.9) 0%,
        rgba(0, 200, 255, 0.4) 30%,
        rgba(0, 200, 255, 0.1) 70%,
        transparent 100%
      );
      animation: arena-spot-left 5s ease-in-out infinite;
      animation-delay: -1.5s;
      opacity: 0.35;
      width: 180px;
    }

    /* Right Pink Spotlight */
    .arena-spotlight.right-1 {
      right: -5%;
      left: auto;
      background: linear-gradient(180deg,
        rgba(255, 0, 128, 1) 0%,
        rgba(255, 0, 128, 0.5) 30%,
        rgba(255, 0, 128, 0.1) 70%,
        transparent 100%
      );
      animation: arena-spot-right 4.5s ease-in-out infinite;
      animation-delay: -2s;
      opacity: 0.5;
    }

    .arena-spotlight.right-2 {
      right: 10%;
      left: auto;
      background: linear-gradient(180deg,
        rgba(255, 50, 150, 0.9) 0%,
        rgba(255, 50, 150, 0.4) 30%,
        rgba(255, 50, 150, 0.1) 70%,
        transparent 100%
      );
      animation: arena-spot-right 5.5s ease-in-out infinite;
      animation-delay: -0.5s;
      opacity: 0.35;
      width: 180px;
    }

    /* Center Purple Spotlight */
    .arena-spotlight.center {
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(180deg,
        rgba(191, 0, 255, 1) 0%,
        rgba(191, 0, 255, 0.4) 30%,
        rgba(191, 0, 255, 0.1) 70%,
        transparent 100%
      );
      animation: arena-spot-center 6s ease-in-out infinite;
      opacity: 0.3;
      width: 200px;
    }

    /* Gold VIP Spotlight */
    .arena-spotlight.gold {
      left: 35%;
      background: linear-gradient(180deg,
        rgba(255, 215, 0, 0.8) 0%,
        rgba(255, 180, 0, 0.3) 40%,
        transparent 100%
      );
      animation: arena-spot-gold 7s ease-in-out infinite;
      animation-delay: -3s;
      opacity: 0.25;
      width: 150px;
    }

    @keyframes arena-spot-left {
      0%, 100% { transform: rotate(-30deg); opacity: 0.4; }
      50% { transform: rotate(20deg); opacity: 0.6; }
    }

    @keyframes arena-spot-right {
      0%, 100% { transform: rotate(30deg); opacity: 0.4; }
      50% { transform: rotate(-20deg); opacity: 0.6; }
    }

    @keyframes arena-spot-center {
      0%, 100% { transform: translateX(-50%) rotate(-10deg); opacity: 0.25; }
      50% { transform: translateX(-50%) rotate(10deg); opacity: 0.4; }
    }

    @keyframes arena-spot-gold {
      0%, 100% { transform: rotate(-15deg); opacity: 0.2; }
      30% { transform: rotate(25deg); opacity: 0.35; }
      70% { transform: rotate(-5deg); opacity: 0.25; }
    }

    /* Laser Beams — Thin Sharp Lines */
    .arena-laser {
      position: absolute;
      top: 0;
      width: 2px;
      height: 120%;
      transform-origin: 50% 0%;
      opacity: 0.6;
    }

    .arena-laser::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      height: 100%;
      background: inherit;
      filter: blur(1px);
    }

    .arena-laser.cyan-1 {
      left: 20%;
      background: linear-gradient(180deg, var(--neon-cyan), transparent 80%);
      box-shadow: 0 0 8px var(--neon-cyan), 0 0 20px var(--neon-cyan);
      animation: laser-sweep-1 3s ease-in-out infinite;
    }

    .arena-laser.cyan-2 {
      left: 30%;
      background: linear-gradient(180deg, var(--neon-cyan), transparent 70%);
      box-shadow: 0 0 6px var(--neon-cyan);
      animation: laser-sweep-1 3.5s ease-in-out infinite;
      animation-delay: -1s;
      opacity: 0.4;
    }

    .arena-laser.pink-1 {
      right: 20%;
      left: auto;
      background: linear-gradient(180deg, var(--neon-pink), transparent 80%);
      box-shadow: 0 0 8px var(--neon-pink), 0 0 20px var(--neon-pink);
      animation: laser-sweep-2 3.2s ease-in-out infinite;
    }

    .arena-laser.pink-2 {
      right: 30%;
      left: auto;
      background: linear-gradient(180deg, var(--neon-pink), transparent 70%);
      box-shadow: 0 0 6px var(--neon-pink);
      animation: laser-sweep-2 4s ease-in-out infinite;
      animation-delay: -1.5s;
      opacity: 0.4;
    }

    .arena-laser.purple {
      left: 50%;
      background: linear-gradient(180deg, var(--neon-purple), transparent 60%);
      box-shadow: 0 0 10px var(--neon-purple);
      animation: laser-sweep-3 5s ease-in-out infinite;
      opacity: 0.5;
    }

    @keyframes laser-sweep-1 {
      0%, 100% { transform: rotate(-20deg); }
      50% { transform: rotate(15deg); }
    }

    @keyframes laser-sweep-2 {
      0%, 100% { transform: rotate(20deg); }
      50% { transform: rotate(-15deg); }
    }

    @keyframes laser-sweep-3 {
      0%, 100% { transform: rotate(-8deg); }
      50% { transform: rotate(8deg); }
    }

    /* Strobe Flash Effect */
    .arena-strobe {
      position: absolute;
      inset: 0;
      background: white;
      opacity: 0;
      animation: strobe-flash 8s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes strobe-flash {
      0%, 100% { opacity: 0; }
      49% { opacity: 0; }
      49.5% { opacity: 0.03; }
      50% { opacity: 0; }
      50.5% { opacity: 0.02; }
      51% { opacity: 0; }
      89% { opacity: 0; }
      89.5% { opacity: 0.04; }
      90% { opacity: 0; }
    }

    /* Disco Ball Light Scatter */
    .arena-disco-scatter {
      position: absolute;
      inset: 0;
      overflow: hidden;
    }

    .scatter-dot {
      position: absolute;
      width: 8px;
      height: 8px;
      background: white;
      border-radius: 50%;
      opacity: 0;
      animation: scatter-float 5s ease-in-out infinite;
      box-shadow: 0 0 10px white, 0 0 20px rgba(255,255,255,0.5);
    }

    .scatter-dot:nth-child(1) { left: 15%; top: 25%; animation-delay: 0s; }
    .scatter-dot:nth-child(2) { left: 35%; top: 40%; animation-delay: -0.7s; }
    .scatter-dot:nth-child(3) { left: 55%; top: 20%; animation-delay: -1.4s; }
    .scatter-dot:nth-child(4) { left: 75%; top: 50%; animation-delay: -2.1s; }
    .scatter-dot:nth-child(5) { left: 25%; top: 60%; animation-delay: -2.8s; }
    .scatter-dot:nth-child(6) { left: 65%; top: 70%; animation-delay: -3.5s; }
    .scatter-dot:nth-child(7) { left: 85%; top: 35%; animation-delay: -4.2s; }
    .scatter-dot:nth-child(8) { left: 45%; top: 55%; animation-delay: -4.9s; }
    .scatter-dot:nth-child(9) { left: 10%; top: 45%; animation-delay: -1.1s; }
    .scatter-dot:nth-child(10) { left: 90%; top: 65%; animation-delay: -2.5s; }

    @keyframes scatter-float {
      0%, 100% {
        opacity: 0;
        transform: translate(0, 0) scale(0.5);
      }
      15% {
        opacity: 0.9;
        transform: translate(15px, -20px) scale(1.2);
      }
      30% {
        opacity: 0.5;
        transform: translate(30px, -10px) scale(0.8);
      }
      50% {
        opacity: 0.8;
        transform: translate(20px, 15px) scale(1);
      }
      70% {
        opacity: 0.4;
        transform: translate(5px, 10px) scale(0.7);
      }
      85% {
        opacity: 0.6;
        transform: translate(-5px, -5px) scale(0.9);
      }
    }

    /* Atmospheric Haze in Arena */
    .arena-haze {
      position: absolute;
      inset: 0;
      background:
        radial-gradient(ellipse at 30% 20%, rgba(0, 245, 255, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 70% 20%, rgba(255, 0, 128, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 80%, rgba(191, 0, 255, 0.06) 0%, transparent 60%);
      animation: haze-shift 10s ease-in-out infinite;
    }

    @keyframes haze-shift {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* ═══════════════════════════════════════════════════════════════
       CENTER STAGE — Where the player stands before choosing
    ═══════════════════════════════════════════════════════════════ */
    .center-stage {
      position: absolute;
      left: 50%;
      bottom: 100px;
      transform: translateX(-50%);
      width: 100px;
      height: 60px;
      z-index: 45;
    }

    .stage-platform {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 90px;
      height: 14px;
      background: linear-gradient(180deg,
        rgba(255, 215, 0, 0.4),
        rgba(191, 0, 255, 0.3)
      );
      border-radius: 50%;
      box-shadow:
        0 0 20px rgba(255, 215, 0, 0.5),
        0 0 40px rgba(191, 0, 255, 0.3),
        inset 0 2px 0 rgba(255,255,255,0.3);
      animation: stage-pulse 2s ease-in-out infinite;
    }

    @keyframes stage-pulse {
      0%, 100% {
        box-shadow:
          0 0 20px rgba(255, 215, 0, 0.5),
          0 0 40px rgba(191, 0, 255, 0.3);
      }
      50% {
        box-shadow:
          0 0 30px rgba(255, 215, 0, 0.7),
          0 0 60px rgba(191, 0, 255, 0.5);
      }
    }

    .stage-glow {
      position: absolute;
      bottom: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 140px;
      height: 50px;
      background: radial-gradient(ellipse,
        rgba(255, 215, 0, 0.4),
        rgba(191, 0, 255, 0.2) 50%,
        transparent 70%
      );
      pointer-events: none;
      animation: glow-breathe 3s ease-in-out infinite;
    }

    @keyframes glow-breathe {
      0%, 100% { opacity: 0.8; transform: translateX(-50%) scale(1); }
      50% { opacity: 1; transform: translateX(-50%) scale(1.1); }
    }

    .stage-label {
      position: absolute;
      bottom: 22px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 9px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--neon-gold);
      white-space: nowrap;
      text-shadow: 0 0 10px var(--neon-gold);
      animation: label-blink 2s ease-in-out infinite;
    }

    @keyframes label-blink {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* ═══════════════════════════════════════════════════════════════
       LASER SHOW — Pure CSS, GPU-accelerated
    ═══════════════════════════════════════════════════════════════ */
    /* ═══════════════════════════════════════════════════════════════
       FESTIVAL LASER SHOW — Techno Energy
    ═══════════════════════════════════════════════════════════════ */
    .laser-show {
      position: absolute;
      top: 100px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 0;
      z-index: 3;
      pointer-events: none;
    }

    .laser-beam {
      position: absolute;
      left: 50%;
      top: 0;
      width: 3px;
      height: 400px;
      transform-origin: 50% 0%;
      opacity: 0.5;
      will-change: transform;
    }

    /* ═══════════════════════════════════════════════════════════════
       FESTIVAL TOTEMS — Side Energy Pillars
    ═══════════════════════════════════════════════════════════════ */
    .festival-totem {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 8px;
      height: 120px;
      border-radius: 4px;
      z-index: 2;
    }

    .festival-totem.left {
      left: 4px;
      background: linear-gradient(180deg, var(--neon-pink), transparent);
      box-shadow: 0 0 20px var(--neon-pink);
      animation: totem-pulse-pink 2s ease-in-out infinite;
    }

    .festival-totem.right {
      right: 4px;
      background: linear-gradient(180deg, var(--neon-cyan), transparent);
      box-shadow: 0 0 20px var(--neon-cyan);
      animation: totem-pulse-cyan 2s ease-in-out infinite;
      animation-delay: -1s;
    }

    .totem-glow {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 30px;
      height: 30px;
      border-radius: 50%;
      animation: totem-glow-pulse 1s ease-in-out infinite;
    }

    .festival-totem.left .totem-glow {
      background: radial-gradient(circle, var(--neon-pink), transparent 70%);
    }

    .festival-totem.right .totem-glow {
      background: radial-gradient(circle, var(--neon-cyan), transparent 70%);
    }

    @keyframes totem-pulse-pink {
      0%, 100% { box-shadow: 0 0 15px var(--neon-pink); }
      50% { box-shadow: 0 0 30px var(--neon-pink), 0 0 50px var(--neon-pink); }
    }

    @keyframes totem-pulse-cyan {
      0%, 100% { box-shadow: 0 0 15px var(--neon-cyan); }
      50% { box-shadow: 0 0 30px var(--neon-cyan), 0 0 50px var(--neon-cyan); }
    }

    @keyframes totem-glow-pulse {
      0%, 100% { opacity: 0.6; transform: translateX(-50%) scale(1); }
      50% { opacity: 1; transform: translateX(-50%) scale(1.3); }
    }

    .laser-beam.cyan {
      background: linear-gradient(to top, var(--neon-cyan), transparent 90%);
      box-shadow: 0 0 8px var(--neon-cyan), 0 0 15px var(--neon-cyan);
      animation: laser-sweep-right 4s ease-in-out infinite;
    }

    .laser-beam.pink {
      background: linear-gradient(to top, var(--neon-pink), transparent 90%);
      box-shadow: 0 0 8px var(--neon-pink), 0 0 15px var(--neon-pink);
      animation: laser-sweep-left 4.5s ease-in-out infinite;
    }

    .laser-beam.purple {
      background: linear-gradient(to top, var(--neon-purple), transparent 90%);
      box-shadow: 0 0 8px var(--neon-purple), 0 0 15px var(--neon-purple);
      animation: laser-sweep-right 5s ease-in-out infinite;
      animation-delay: -1s;
    }

    .laser-beam.gold {
      background: linear-gradient(to top, var(--neon-gold), transparent 90%);
      box-shadow: 0 0 8px var(--neon-gold), 0 0 15px var(--neon-gold);
      animation: laser-sweep-left 3.5s ease-in-out infinite;
      animation-delay: -0.5s;
    }

    @keyframes laser-sweep-right {
      0%, 100% { transform: translateX(-50%) rotate(-45deg); opacity: 0.3; }
      50% { transform: translateX(-50%) rotate(45deg); opacity: 0.6; }
    }

    @keyframes laser-sweep-left {
      0%, 100% { transform: translateX(-50%) rotate(40deg); opacity: 0.4; }
      50% { transform: translateX(-50%) rotate(-40deg); opacity: 0.6; }
    }

    /* ═══════════════════════════════════════════════════════════════
       ANIMAL CROSSING STYLE VILLAGERS
    ═══════════════════════════════════════════════════════════════ */
    .crowd-container {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }

    .villager {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
      transition: filter 0.3s ease;
      pointer-events: auto;
      left: var(--pos-x, 50%);
      top: var(--pos-y, 50%);
      transform: translate(-50%, -50%) scale(var(--scale, 1));
    }

    .villager:hover {
      filter: drop-shadow(0 0 12px var(--glow-color, rgba(255,255,255,0.5)));
    }

    .zone.yes .villager { --glow-color: var(--neon-cyan); }
    .zone.no .villager { --glow-color: var(--neon-pink); }

    /* Villager Avatar Container */
    .villager-avatar {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Stick Figure Body */
    .stick-body {
      position: relative;
      width: 24px;
      height: 32px;
      margin-top: -4px;
    }

    .stick-torso {
      position: absolute;
      left: 50%;
      top: 0;
      width: 3px;
      height: 16px;
      background: var(--body-color, #fff);
      transform: translateX(-50%);
      border-radius: 2px;
    }

    .stick-arm {
      position: absolute;
      top: 2px;
      width: 3px;
      height: 14px;
      background: var(--body-color, #fff);
      border-radius: 2px;
      transform-origin: top center;
    }

    .stick-arm.left {
      left: 2px;
      animation: arm-wave-left var(--dance-speed, 0.9s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }

    .stick-arm.right {
      right: 2px;
      animation: arm-wave-right var(--dance-speed, 0.9s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }

    .stick-leg {
      position: absolute;
      top: 14px;
      width: 3px;
      height: 16px;
      background: var(--body-color, #fff);
      border-radius: 2px;
      transform-origin: top center;
    }

    .stick-leg.left {
      left: 6px;
      animation: leg-kick-left var(--dance-speed, 0.9s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }

    .stick-leg.right {
      right: 6px;
      animation: leg-kick-right var(--dance-speed, 0.9s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }

    /* ═══════════════════════════════════════════════════════════════
       HABBO HOTEL / ANIMAL CROSSING DANCE STYLES — Nintendo Magic!
    ═══════════════════════════════════════════════════════════════ */

    /* Dance 1 - The Habbo Bounce (classic up-down) */
    .villager.dance-1 .villager-avatar {
      animation: habbo-bounce var(--dance-speed, 0.8s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-1 .stick-arm.left { animation: arms-pump-left var(--dance-speed, 0.8s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-1 .stick-arm.right { animation: arms-pump-right var(--dance-speed, 0.8s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-1 .stick-leg.left { animation: legs-march-left var(--dance-speed, 0.8s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-1 .stick-leg.right { animation: legs-march-right var(--dance-speed, 0.8s) ease-in-out infinite; animation-delay: var(--delay, 0s); }

    /* Dance 2 - The Side Step (Habbo classic) */
    .villager.dance-2 .villager-avatar {
      animation: habbo-sidestep var(--dance-speed, 0.9s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-2 .stick-arm { animation: arms-swing var(--dance-speed, 0.9s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-2 .stick-leg.left { animation: legs-step-left var(--dance-speed, 0.9s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-2 .stick-leg.right { animation: legs-step-right var(--dance-speed, 0.9s) ease-in-out infinite; animation-delay: var(--delay, 0s); }

    /* Dance 3 - The Animal Crossing Wiggle */
    .villager.dance-3 .villager-avatar {
      animation: ac-wiggle var(--dance-speed, 0.7s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-3 .stick-arm.left { animation: arms-wave-happy-left var(--dance-speed, 0.7s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-3 .stick-arm.right { animation: arms-wave-happy-right var(--dance-speed, 0.7s) ease-in-out infinite; animation-delay: var(--delay, 0s); }

    /* Dance 4 - The Jump & Pump */
    .villager.dance-4 .villager-avatar {
      animation: jump-pump var(--dance-speed, 1s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-4 .stick-arm { animation: arms-up var(--dance-speed, 1s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-4 .stick-leg { animation: legs-squat var(--dance-speed, 1s) ease-in-out infinite; animation-delay: var(--delay, 0s); }

    /* Dance 5 - THE FLOSS (Fortnite iconic!) */
    .villager.dance-5 .villager-avatar {
      animation: floss-hips var(--dance-speed, 0.4s) linear infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-5 .stick-arm.left { animation: floss-arm-left var(--dance-speed, 0.4s) linear infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-5 .stick-arm.right { animation: floss-arm-right var(--dance-speed, 0.4s) linear infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-5 .stick-leg.left { animation: floss-leg-left var(--dance-speed, 0.4s) linear infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-5 .stick-leg.right { animation: floss-leg-right var(--dance-speed, 0.4s) linear infinite; animation-delay: var(--delay, 0s); }

    /* Dance 6 - The Head Bob (chill vibes) */
    .villager.dance-6 .villager-avatar {
      animation: chill-bob var(--dance-speed, 1.2s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-6 .stick-arm { animation: arms-chill var(--dance-speed, 1.2s) ease-in-out infinite; animation-delay: var(--delay, 0s); }

    /* Dance 7 - The Running Man */
    .villager.dance-7 .villager-avatar {
      animation: running-man var(--dance-speed, 0.5s) ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-7 .stick-arm.left { animation: run-arm-left var(--dance-speed, 0.5s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-7 .stick-arm.right { animation: run-arm-right var(--dance-speed, 0.5s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-7 .stick-leg.left { animation: run-leg-left var(--dance-speed, 0.5s) ease-in-out infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-7 .stick-leg.right { animation: run-leg-right var(--dance-speed, 0.5s) ease-in-out infinite; animation-delay: var(--delay, 0s); }

    /* Dance 8 - The Robot */
    .villager.dance-8 .villager-avatar {
      animation: robot var(--dance-speed, 0.8s) steps(4) infinite;
      animation-delay: var(--delay, 0s);
    }
    .villager.dance-8 .stick-arm { animation: robot-arms var(--dance-speed, 0.8s) steps(4) infinite; animation-delay: var(--delay, 0s); }
    .villager.dance-8 .stick-leg { animation: robot-legs var(--dance-speed, 0.8s) steps(4) infinite; animation-delay: var(--delay, 0s); }

    /* ═══ BODY ANIMATIONS ═══ */
    @keyframes habbo-bounce {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-8px) scale(1.02); }
    }

    @keyframes habbo-sidestep {
      0%, 100% { transform: translateX(-4px) rotate(-2deg); }
      50% { transform: translateX(4px) rotate(2deg); }
    }

    @keyframes ac-wiggle {
      0%, 100% { transform: rotate(-8deg) translateY(0); }
      25% { transform: rotate(0deg) translateY(-3px); }
      50% { transform: rotate(8deg) translateY(0); }
      75% { transform: rotate(0deg) translateY(-3px); }
    }

    @keyframes jump-pump {
      0%, 100% { transform: translateY(0) scaleY(1); }
      20% { transform: translateY(3px) scaleY(0.9); }
      40% { transform: translateY(-15px) scaleY(1.1); }
      60% { transform: translateY(0) scaleY(0.95); }
      80% { transform: translateY(-5px) scaleY(1.02); }
    }

    @keyframes disco-twist {
      0%, 100% { transform: rotate(-10deg) translateX(-2px); }
      50% { transform: rotate(10deg) translateX(2px); }
    }

    /* ═══ THE FLOSS — Fortnite Iconic! ═══ */
    @keyframes floss-hips {
      0%, 100% { transform: translateX(-6px) rotate(5deg); }
      50% { transform: translateX(6px) rotate(-5deg); }
    }
    @keyframes floss-arm-left {
      0%, 100% { transform: rotate(60deg) translateX(8px); }  /* Behind right */
      50% { transform: rotate(-60deg) translateX(-8px); }      /* In front left */
    }
    @keyframes floss-arm-right {
      0%, 100% { transform: rotate(-60deg) translateX(-8px); } /* In front left */
      50% { transform: rotate(60deg) translateX(8px); }        /* Behind right */
    }
    @keyframes floss-leg-left {
      0%, 100% { transform: rotate(8deg); }
      50% { transform: rotate(-8deg); }
    }
    @keyframes floss-leg-right {
      0%, 100% { transform: rotate(-8deg); }
      50% { transform: rotate(8deg); }
    }

    @keyframes chill-bob {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      25% { transform: translateY(-3px) rotate(-2deg); }
      50% { transform: translateY(0) rotate(0deg); }
      75% { transform: translateY(-3px) rotate(2deg); }
    }

    @keyframes running-man {
      0%, 100% { transform: translateY(0) translateX(0); }
      25% { transform: translateY(-4px) translateX(-2px); }
      50% { transform: translateY(0) translateX(0); }
      75% { transform: translateY(-4px) translateX(2px); }
    }

    @keyframes robot {
      0%, 100% { transform: translateX(-3px) rotate(-5deg); }
      25% { transform: translateX(0) rotate(0deg); }
      50% { transform: translateX(3px) rotate(5deg); }
      75% { transform: translateX(0) rotate(0deg); }
    }

    /* ═══ ARM ANIMATIONS ═══ */
    @keyframes arms-pump-left {
      0%, 100% { transform: rotate(-60deg); }
      50% { transform: rotate(-20deg); }
    }
    @keyframes arms-pump-right {
      0%, 100% { transform: rotate(60deg); }
      50% { transform: rotate(20deg); }
    }
    @keyframes arms-swing {
      0%, 100% { transform: rotate(-30deg); }
      50% { transform: rotate(30deg); }
    }
    @keyframes arms-wave-happy-left {
      0%, 100% { transform: rotate(-70deg); }
      50% { transform: rotate(-110deg); }
    }
    @keyframes arms-wave-happy-right {
      0%, 100% { transform: rotate(70deg); }
      50% { transform: rotate(110deg); }
    }
    @keyframes arms-up {
      0%, 100% { transform: rotate(0deg); }
      15% { transform: rotate(-100deg); }
      30% { transform: rotate(-120deg); }
      45% { transform: rotate(-100deg); }
      60% { transform: rotate(0deg); }
    }
    @keyframes disco-point-left {
      0%, 100% { transform: rotate(-120deg); }
      50% { transform: rotate(-30deg); }
    }
    @keyframes disco-point-right {
      0%, 100% { transform: rotate(30deg); }
      50% { transform: rotate(120deg); }
    }
    @keyframes arms-chill {
      0%, 100% { transform: rotate(-20deg); }
      50% { transform: rotate(-25deg); }
    }
    @keyframes run-arm-left {
      0%, 100% { transform: rotate(-60deg); }
      50% { transform: rotate(30deg); }
    }
    @keyframes run-arm-right {
      0%, 100% { transform: rotate(30deg); }
      50% { transform: rotate(-60deg); }
    }
    @keyframes robot-arms {
      0%, 25%, 100% { transform: rotate(-90deg); }
      50%, 75% { transform: rotate(0deg); }
    }

    /* ═══ LEG ANIMATIONS ═══ */
    @keyframes legs-march-left {
      0%, 100% { transform: rotate(20deg); }
      50% { transform: rotate(-20deg); }
    }
    @keyframes legs-march-right {
      0%, 100% { transform: rotate(-20deg); }
      50% { transform: rotate(20deg); }
    }
    @keyframes legs-step-left {
      0%, 100% { transform: rotate(10deg) translateX(-2px); }
      50% { transform: rotate(-5deg) translateX(2px); }
    }
    @keyframes legs-step-right {
      0%, 100% { transform: rotate(-5deg) translateX(2px); }
      50% { transform: rotate(10deg) translateX(-2px); }
    }
    @keyframes legs-squat {
      0%, 100% { transform: rotate(0deg) scaleY(1); }
      20% { transform: rotate(5deg) scaleY(0.85); }
      40% { transform: rotate(0deg) scaleY(1); }
      70% { transform: rotate(-5deg) scaleY(0.85); }
      85% { transform: rotate(0deg) scaleY(1); }
    }
    @keyframes run-leg-left {
      0%, 100% { transform: rotate(40deg); }
      50% { transform: rotate(-30deg); }
    }
    @keyframes run-leg-right {
      0%, 100% { transform: rotate(-30deg); }
      50% { transform: rotate(40deg); }
    }
    @keyframes robot-legs {
      0%, 25%, 100% { transform: rotate(15deg); }
      50%, 75% { transform: rotate(-15deg); }
    }

    .villager-head {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      position: relative;
      background: var(--skin, #ffd5b8);
      box-shadow: 0 2px 0 rgba(0,0,0,0.1);
    }

    /* Hair */
    .villager-hair {
      position: absolute;
      top: -4px;
      left: 50%;
      transform: translateX(-50%);
      width: 28px;
      height: 14px;
      border-radius: 14px 14px 0 0;
      background: var(--hair, #4a3728);
    }

    .villager-hair.spiky {
      width: 36px;
      height: 12px;
      top: -6px;
      clip-path: polygon(10% 100%, 0% 40%, 15% 100%, 25% 20%, 35% 100%, 50% 0%, 65% 100%, 75% 20%, 85% 100%, 100% 40%, 90% 100%);
      border-radius: 0;
    }

    /* Eyes */
    .villager-eyes {
      position: absolute;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 6px;
    }

    .villager-eye {
      width: 5px;
      height: 6px;
      background: #1a1a1a;
      border-radius: 50%;
      position: relative;
      animation: eye-blink 4s ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }

    @keyframes eye-blink {
      0%, 95%, 100% { transform: scaleY(1); }
      97% { transform: scaleY(0.1); }
    }

    .villager-eye::after {
      content: '';
      position: absolute;
      top: 1px;
      right: 0;
      width: 2px;
      height: 2px;
      background: #fff;
      border-radius: 50%;
      animation: eye-sparkle 2s ease-in-out infinite;
    }

    @keyframes eye-sparkle {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }

    /* Team-colored eye glow */
    .zone.yes .villager-eye {
      box-shadow: 0 0 4px var(--neon-cyan);
    }

    .zone.no .villager-eye {
      box-shadow: 0 0 4px var(--neon-pink);
    }

    /* Blush */
    .villager-head::before {
      content: '';
      position: absolute;
      top: 18px;
      left: 4px;
      width: 6px;
      height: 3px;
      background: rgba(255,150,150,0.5);
      border-radius: 50%;
      box-shadow: 18px 0 0 rgba(255,150,150,0.5);
    }

    /* Body */
    .villager-body {
      width: 26px;
      height: 20px;
      background: var(--shirt, #fff);
      border-radius: 8px 8px 4px 4px;
      margin-top: -4px;
      position: relative;
      box-shadow: 0 2px 0 rgba(0,0,0,0.1);
    }

    /* Arms */
    .villager-body::before,
    .villager-body::after {
      content: '';
      position: absolute;
      top: 4px;
      width: 8px;
      height: 12px;
      background: var(--shirt, #fff);
      border-radius: 4px;
      animation: arm-swing 0.9375s ease-in-out infinite;
      animation-delay: var(--delay, 0s);
    }

    .villager-body::before {
      left: -6px;
      transform-origin: top center;
    }

    .villager-body::after {
      right: -6px;
      transform-origin: top center;
      animation-delay: calc(var(--delay, 0s) + 0.2s);
    }

    @keyframes arm-swing {
      0%, 100% { transform: rotate(-15deg); }
      50% { transform: rotate(15deg); }
    }

    /* Feet */
    .villager-feet {
      display: flex;
      gap: 4px;
      margin-top: -2px;
    }

    .villager-foot {
      width: 10px;
      height: 6px;
      background: #333;
      border-radius: 3px;
    }

    /* Nametag */
    .villager-name {
      font-size: 8px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-top: 4px;
      text-align: center;
      max-width: 50px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* ═══════════════════════════════════════════════════════════════
       THE PLAYER — You! White Stick Figure at the Door
    ═══════════════════════════════════════════════════════════════ */
    .player-container {
      position: absolute;
      left: 50%;
      bottom: 30px;
      transform: translateX(-50%);
      z-index: 300; /* Above tab-bar (z-200) */
      cursor: grab;
      touch-action: none;
      user-select: none;
      -webkit-user-select: none;
      -webkit-touch-callout: none;
      will-change: transform;
      pointer-events: auto !important;
    }

    .player-container:active {
      cursor: grabbing;
    }

    /* At door - INSIDE the dock circle */
    .player-container.at-door {
      left: 50%;
      bottom: 30px;
      transform: translateX(-50%);
      z-index: 300; /* MUST be above tab-bar (z-200) for drag to work! */
    }

    .player-container.on-stage {
      left: 50%;
      bottom: 30px;
      transform: translateX(-50%);
    }

    /* When being dragged - lifted doll feel */
    .player-container.dragging {
      z-index: 9999 !important;
      transition: none !important;
      cursor: grabbing;
    }

    /* Smooth return animation */
    .player-container.returning {
      transition: left 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
                  bottom 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
                  transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* Landing on a team */
    .player-container.landing {
      transition: left 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
                  bottom 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
                  transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .player-container.team-yes-pos {
      left: 75%;
      bottom: 35%;
      transform: translateX(-50%) translateY(50%);
      z-index: 50;
    }

    .player-container.team-no-pos {
      left: 25%;
      bottom: 35%;
      transform: translateX(-50%) translateY(50%);
      z-index: 50;
    }

    .player {
      display: flex;
      flex-direction: column;
      align-items: center;
      transform-origin: center bottom;
    }

    /* Doll wobble when lifted */
    .player.lifted {
      animation: doll-wobble 0.15s ease-in-out;
    }

    @keyframes doll-wobble {
      0% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.1) rotate(-3deg); }
      50% { transform: scale(1.15) rotate(2deg); }
      75% { transform: scale(1.12) rotate(-1deg); }
      100% { transform: scale(1.1) rotate(0deg); }
    }

    /* Doll swing while being dragged - controlled by JS */
    .player.dragging-active {
      animation: none;
      will-change: transform;
    }

    /* Dance only when on a team AND confirmed */
    .player.team-yes.confirmed,
    .player.team-no.confirmed {
      animation: james-brown-funk 0.46875s ease-in-out infinite;
    }

    /* Landing squash-stretch */
    .player.landing-squash {
      animation: landing-squash 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes landing-squash {
      0% { transform: scale(1.1, 0.9) translateY(-20px); }
      40% { transform: scale(0.9, 1.15) translateY(5px); }
      70% { transform: scale(1.05, 0.95) translateY(-3px); }
      100% { transform: scale(1, 1) translateY(0); }
    }

    /* James Brown funk dance */
    @keyframes james-brown-funk {
      0%, 100% { transform: translateY(0) rotate(-2deg); }
      25% { transform: translateY(-8px) rotate(3deg); }
      50% { transform: translateY(-2px) rotate(-3deg); }
      75% { transform: translateY(-10px) rotate(2deg); }
    }

    @keyframes player-bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }

    .player.dragging {
      animation: none;
    }

    .player-head {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: linear-gradient(145deg, #ffe4c4, #dbb896);
      position: relative;
      box-shadow: 0 3px 0 #c49b78, 0 6px 15px rgba(0,0,0,0.3);
    }

    /* Party Hat */
    .party-hat {
      position: absolute;
      top: -22px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 14px solid transparent;
      border-right: 14px solid transparent;
      border-bottom: 28px solid var(--neon-cyan);
      filter: drop-shadow(0 2px 8px rgba(0, 245, 255, 0.5));
    }

    .party-hat::before {
      content: '★';
      position: absolute;
      top: -6px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: var(--neon-gold);
    }

    .party-hat::after {
      content: '';
      position: absolute;
      top: 8px;
      left: -8px;
      width: 16px;
      height: 3px;
      background: var(--neon-pink);
      box-shadow: 0 6px 0 var(--neon-gold), 0 12px 0 var(--neon-pink);
    }

    .player-eyes {
      position: absolute;
      top: 16px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
    }

    .player-eye {
      width: 7px;
      height: 8px;
      background: #1a1a1a;
      border-radius: 50%;
      position: relative;
    }

    .player-eye::after {
      content: '';
      position: absolute;
      top: 2px;
      right: 1px;
      width: 3px;
      height: 3px;
      background: #fff;
      border-radius: 50%;
    }

    .player-head::before {
      content: '';
      position: absolute;
      top: 26px;
      left: 6px;
      width: 8px;
      height: 4px;
      background: rgba(255,150,150,0.5);
      border-radius: 50%;
      box-shadow: 24px 0 0 rgba(255,150,150,0.5);
    }

    .player-head::after {
      content: '';
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 6px;
      height: 3px;
      border-bottom: 2px solid #c47070;
      border-radius: 0 0 6px 6px;
    }

    .player-body {
      width: 36px;
      height: 28px;
      background: linear-gradient(180deg, #e8e8e8, #c8c8c8);
      border-radius: 10px 10px 6px 6px;
      margin-top: -6px;
      position: relative;
      box-shadow: 0 2px 0 #999;
    }

    .player.team-yes .player-body {
      background: linear-gradient(180deg, var(--neon-cyan), #00c8d8);
      box-shadow: 0 2px 0 #00a0b0, 0 0 20px rgba(0, 245, 255, 0.4);
    }

    .player.team-no .player-body {
      background: linear-gradient(180deg, var(--neon-pink), #d80060);
      box-shadow: 0 2px 0 #a00050, 0 0 20px rgba(255, 0, 128, 0.4);
    }

    .player-body::before,
    .player-body::after {
      content: '';
      position: absolute;
      top: 6px;
      width: 10px;
      height: 16px;
      background: inherit;
      border-radius: 5px;
      animation: player-arm 0.9375s ease-in-out infinite;
    }

    .player-body::before {
      left: -8px;
      animation-delay: 0s;
    }

    .player-body::after {
      right: -8px;
      animation-delay: 0.2s;
    }

    @keyframes player-arm {
      0%, 100% { transform: rotate(-20deg); }
      50% { transform: rotate(20deg); }
    }

    .player.dragging .player-body::before,
    .player.dragging .player-body::after {
      animation: none;
      transform: rotate(-45deg);
    }

    .player-feet {
      display: flex;
      gap: 6px;
      margin-top: -2px;
    }

    .player-foot {
      width: 14px;
      height: 8px;
      background: #2a2a2a;
      border-radius: 4px;
    }

    .player-label {
      margin-top: 8px;
      padding: 4px 12px;
      background: var(--glass);
      backdrop-filter: blur(10px);
      border-radius: 8px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-primary);
      border: 1px solid var(--glass-border);
    }

    /* ═══════════════════════════════════════════════════════════════
       FLOATING CHAT MESSAGES
    ═══════════════════════════════════════════════════════════════ */
    /* Hidden - replaced by speech bubbles above villager heads */
    .chat-container {
      display: none;
      position: absolute;
      left: 16px;
      right: 16px;
      bottom: 180px;
      flex-direction: column;
      gap: 8px;
      pointer-events: none;
      z-index: 40;
    }

    .chat-bubble {
      max-width: 70%;
      padding: 10px 14px;
      background: var(--glass);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 16px 16px 16px 4px;
      font-size: 13px;
      animation: chat-float 4s ease-out forwards;
      opacity: 0;
    }

    .chat-bubble.right {
      align-self: flex-end;
      border-radius: 16px 16px 4px 16px;
    }

    @keyframes chat-float {
      0% { opacity: 0; transform: translateY(20px); }
      10% { opacity: 1; transform: translateY(0); }
      80% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-20px); }
    }

    .chat-name {
      font-size: 10px;
      font-weight: 600;
      color: var(--neon-cyan);
      margin-bottom: 2px;
    }

    .chat-text {
      color: var(--text-primary);
      line-height: 1.3;
    }

    /* ═══════════════════════════════════════════════════════════════
       CONTROL DECK — Drag-Only Mode
    ═══════════════════════════════════════════════════════════════ */
    .control-deck {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 15px 16px calc(15px + var(--safe-bottom));
      background: linear-gradient(180deg, transparent, rgba(0,0,0,0.4) 60%);
      display: flex;
      z-index: 90; /* Below player-container */
      align-items: center;
      justify-content: center;
      pointer-events: none; /* Let clicks pass through to player */
    }

    /* NOTE: Removed .control-deck > * pointer-events: auto rule
       that was blocking player drag. Player-dock already has
       pointer-events: none which is what we want. */

    /* Player Home Base — Dock circle that surrounds the player */
    .player-dock {
      position: relative;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      background: radial-gradient(circle at 50% 50%, rgba(255,215,0,0.05), transparent 70%);
      border: 3px dashed rgba(255,215,0,0.5);
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding-bottom: 8px;
      animation: dock-breathe 2s ease-in-out infinite;
      box-shadow: 0 0 30px rgba(255,215,0,0.1), inset 0 0 20px rgba(255,215,0,0.05);
      pointer-events: none; /* Don't block player dragging */
    }

    @keyframes dock-breathe {
      0%, 100% { transform: scale(1); border-color: rgba(255,215,0,0.5); box-shadow: 0 0 30px rgba(255,215,0,0.1); }
      50% { transform: scale(1.03); border-color: rgba(255,215,0,0.8); box-shadow: 0 0 40px rgba(255,215,0,0.2); }
    }

    .drag-hint {
      font-size: 9px;
      font-weight: 700;
      color: rgba(255,215,0,0.9);
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 1px;
      animation: hint-pulse 2s ease-in-out infinite;
      text-shadow: 0 0 10px rgba(255,215,0,0.5);
    }

    @keyframes hint-pulse {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }

    .player-dock.hidden {
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.3s var(--bounce);
    }

    .player-dock.hidden .drag-hint {
      display: none;
    }

    /* ═══════════════════════════════════════════════════════════════
       TAB BAR — Nightclub Navigation
    ═══════════════════════════════════════════════════════════════ */
    .tab-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: calc(60px + var(--safe-bottom));
      padding-bottom: var(--safe-bottom);
      background: linear-gradient(180deg, rgba(15, 12, 41, 0.95), rgba(10, 8, 30, 0.98));
      backdrop-filter: blur(20px);
      border-top: 1px solid rgba(0, 245, 255, 0.15);
      display: flex;
      justify-content: space-around;
      align-items: flex-start;
      padding-top: 6px;
      z-index: 200;
      /* Fading edges for immersive fullscreen feel */
      -webkit-mask-image: linear-gradient(90deg,
        transparent 0%,
        black 8%,
        black 92%,
        transparent 100%
      );
      mask-image: linear-gradient(90deg,
        transparent 0%,
        black 8%,
        black 92%,
        transparent 100%
      );
    }

    .tab-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: 20%;
      right: 20%;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--neon-cyan), var(--neon-pink), transparent);
    }

    .tab-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      padding: 6px 14px;
      transition: all 0.2s var(--bounce);
      position: relative;
    }

    .tab-btn:active {
      transform: scale(0.92);
    }

    .tab-btn.active {
      color: var(--neon-cyan);
    }

    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 4px;
      background: var(--neon-cyan);
      border-radius: 50%;
      box-shadow: 0 0 8px var(--neon-cyan);
    }

    .tab-btn .icon {
      font-size: 20px;
      filter: drop-shadow(0 0 4px currentColor);
    }

    .tab-btn .label {
      font-size: 9px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .tab-btn.active .label {
      text-shadow: 0 0 8px var(--neon-cyan);
    }

    /* ═══════════════════════════════════════════════════════════════
       SLIDE-TO-CONFIRM PANEL — Glassmorphism 2.0
    ═══════════════════════════════════════════════════════════════ */
    /* ═══════════════════════════════════════════════════════════════
       COMPACT CONFIRM PANEL — High-Density 2026 Design
    ═══════════════════════════════════════════════════════════════ */
    .slide-confirm-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 430px;
      margin: 0 auto;
      background: rgba(15, 12, 41, 0.92);
      backdrop-filter: blur(20px) saturate(1.5);
      -webkit-backdrop-filter: blur(20px) saturate(1.5);
      border-top: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 20px 20px 0 0;
      padding: 12px 16px calc(12px + var(--safe-bottom));
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
      z-index: 500;
    }

    .slide-confirm-panel::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(255,255,255,0.06) 0%, transparent 40%);
      border-radius: inherit;
      pointer-events: none;
    }

    .slide-confirm-panel.active {
      transform: translateY(0);
    }

    .panel-handle {
      width: 32px;
      height: 3px;
      background: rgba(255,255,255,0.25);
      border-radius: 2px;
      margin: 0 auto 10px;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .panel-title {
      font-size: 16px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .panel-side-badge {
      padding: 6px 14px;
      border-radius: 100px;
      font-size: 14px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .panel-side-badge.yes {
      background: linear-gradient(135deg, var(--neon-cyan), #00c8d8);
      color: #000;
      box-shadow: 0 0 20px rgba(0, 245, 255, 0.4);
    }

    .panel-side-badge.no {
      background: linear-gradient(135deg, var(--neon-pink), #d80060);
      color: #fff;
      box-shadow: 0 0 20px rgba(255, 0, 128, 0.4);
    }

    .panel-close {
      width: 32px;
      height: 32px;
      background: rgba(255,255,255,0.1);
      border: none;
      border-radius: 50%;
      color: var(--text-secondary);
      font-size: 18px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .panel-close:active {
      transform: scale(0.9);
      background: rgba(255,255,255,0.2);
    }

    .panel-why {
      display: none; /* Hidden for compact 2026 design - can expand later */
      margin-bottom: 12px;
    }

    .panel-why-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
      display: block;
    }

    .panel-why-input {
      width: 100%;
      padding: 14px 16px;
      background: rgba(0,0,0,0.4);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 14px;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 15px;
      resize: none;
      outline: none;
      transition: all 0.2s ease;
    }

    .panel-why-input::placeholder {
      color: var(--text-muted);
    }

    .panel-why-input:focus {
      border-color: var(--neon-cyan);
      box-shadow: 0 0 0 3px rgba(0, 245, 255, 0.1);
    }

    /* The Magic: SWIPE UP to Confirm Track — Vertical */
    .slide-track {
      position: relative;
      width: 100%;
      height: 100px;
      background: rgba(0,0,0,0.5);
      border-radius: 50px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .slide-track-fill {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 0%;
      border-radius: 50px;
      transition: height 0.1s ease;
    }

    .slide-track-fill.yes {
      background: linear-gradient(0deg, var(--neon-cyan), rgba(0, 245, 255, 0.3));
    }

    .slide-track-fill.no {
      background: linear-gradient(0deg, var(--neon-pink), rgba(255, 0, 128, 0.3));
    }

    .slide-track-text {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding-top: 16px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
      letter-spacing: 1px;
      transition: opacity 0.2s ease;
    }

    .slide-track-text::before {
      content: '↑';
      font-size: 20px;
      margin-bottom: 4px;
      animation: bounce-up 1s ease-in-out infinite;
    }

    @keyframes bounce-up {
      0%, 100% { transform: translateY(0); opacity: 0.5; }
      50% { transform: translateY(-5px); opacity: 1; }
    }

    .slide-thumb {
      position: absolute;
      left: 50%;
      bottom: 4px;
      transform: translateX(-50%);
      width: 60px;
      height: 60px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: grab;
      touch-action: none;
      transition: transform 0.1s ease, box-shadow 0.2s ease;
      z-index: 2;
    }

    .slide-thumb.yes {
      background: linear-gradient(135deg, var(--neon-cyan), #00c8d8);
      box-shadow: 0 4px 25px rgba(0, 245, 255, 0.6);
    }

    .slide-thumb.no {
      background: linear-gradient(135deg, var(--neon-pink), #d80060);
      box-shadow: 0 4px 25px rgba(255, 0, 128, 0.6);
    }

    .slide-thumb:active {
      cursor: grabbing;
      transform: translateX(-50%) scale(1.1);
    }

    .slide-thumb-icon {
      font-size: 28px;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }

    .slide-thumb.yes .slide-thumb-icon { color: #000; }
    .slide-thumb.no .slide-thumb-icon { color: #fff; }

    .slide-success {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(0deg, var(--neon-cyan), var(--neon-green));
      border-radius: 50px;
      font-size: 16px;
      font-weight: 700;
      color: #000;
      opacity: 0;
      transform: scale(0.95);
      transition: all 0.3s var(--bounce);
    }

    .slide-success.active {
      opacity: 1;
      transform: scale(1);
    }

    /* ═══════════════════════════════════════════════════════════════
       DROP CONFIRMATION POPUP — Nintendo-style Yes/No Dialog
    ═══════════════════════════════════════════════════════════════ */
    .drop-confirm-popup {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: 800;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
    }

    .drop-confirm-popup.active {
      opacity: 1;
      pointer-events: auto;
    }

    .drop-confirm-card {
      background: linear-gradient(180deg, rgba(30, 20, 50, 0.95), rgba(15, 10, 30, 0.98));
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 24px;
      padding: 28px 32px;
      max-width: 320px;
      width: 90%;
      text-align: center;
      transform: scale(0.9) translateY(20px);
      transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5),
                  0 0 100px rgba(0, 245, 255, 0.1);
    }

    .drop-confirm-popup.active .drop-confirm-card {
      transform: scale(1) translateY(0);
    }

    .drop-confirm-title {
      font-size: 22px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .drop-confirm-side {
      display: inline-block;
      padding: 4px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 20px;
    }

    .drop-confirm-side.yes {
      background: var(--neon-cyan);
      color: #000;
    }

    .drop-confirm-side.no {
      background: var(--neon-pink);
      color: #fff;
    }

    .drop-confirm-question {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 24px;
      line-height: 1.4;
    }

    .drop-confirm-buttons {
      display: flex;
      gap: 12px;
    }

    .drop-confirm-btn {
      flex: 1;
      padding: 16px 20px;
      border: none;
      border-radius: 16px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .drop-confirm-btn:active {
      transform: scale(0.95);
    }

    .drop-confirm-btn.cancel {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-secondary);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .drop-confirm-btn.cancel:active {
      background: rgba(255, 255, 255, 0.15);
    }

    .drop-confirm-btn.confirm {
      background: linear-gradient(135deg, var(--neon-cyan), #00d4aa);
      color: #000;
      box-shadow: 0 4px 20px rgba(0, 245, 255, 0.3);
    }

    .drop-confirm-btn.confirm.no-side {
      background: linear-gradient(135deg, var(--neon-pink), #ff3366);
      color: #fff;
      box-shadow: 0 4px 20px rgba(255, 0, 128, 0.3);
    }

    /* ═══════════════════════════════════════════════════════════════
       NINTENDO VICTORY CELEBRATION — Epic Fireworks Overlay!
    ═══════════════════════════════════════════════════════════════ */
    .celebration-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at 50% 50%, rgba(0, 245, 255, 0.1), transparent 60%);
      pointer-events: none;
      z-index: 700;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .celebration-overlay.active {
      opacity: 1;
      animation: celebration-flash 0.6s ease-out;
    }

    @keyframes celebration-flash {
      0% { background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.4), transparent 60%); }
      100% { background: radial-gradient(circle at 50% 50%, rgba(0, 245, 255, 0.1), transparent 60%); }
    }

    .celebration-text {
      position: absolute;
      top: 35%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      font-size: 48px;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 4px;
      background: linear-gradient(135deg, var(--neon-cyan), var(--neon-gold), var(--neon-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 40px rgba(0, 245, 255, 0.8);
      opacity: 0;
    }

    .celebration-overlay.active .celebration-text {
      animation: celebration-pop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s forwards;
    }

    @keyframes celebration-pop {
      0% { opacity: 0; transform: translate(-50%, -50%) scale(0) rotate(-10deg); }
      50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2) rotate(5deg); }
      100% { opacity: 1; transform: translate(-50%, -50%) scale(1) rotate(0deg); }
    }

    .celebration-subtitle {
      position: absolute;
      top: 48%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 16px;
      font-weight: 600;
      color: var(--text-secondary);
      letter-spacing: 2px;
      opacity: 0;
    }

    .celebration-overlay.active .celebration-subtitle {
      animation: fade-in 0.4s ease 0.4s forwards;
    }

    @keyframes fade-in {
      to { opacity: 1; }
    }

    /* Firework Particles */
    .firework {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      opacity: 0;
    }

    .celebration-overlay.active .firework {
      animation: firework-burst 1s ease-out forwards;
    }

    .firework:nth-child(1) { top: 20%; left: 20%; background: var(--neon-cyan); animation-delay: 0ms; --tx: 50px; --ty: -80px; }
    .firework:nth-child(2) { top: 20%; left: 20%; background: var(--neon-pink); animation-delay: 50ms; --tx: -40px; --ty: -60px; }
    .firework:nth-child(3) { top: 20%; left: 20%; background: var(--neon-gold); animation-delay: 100ms; --tx: 30px; --ty: -90px; }
    .firework:nth-child(4) { top: 20%; left: 80%; background: var(--neon-pink); animation-delay: 150ms; --tx: -50px; --ty: -70px; }
    .firework:nth-child(5) { top: 20%; left: 80%; background: var(--neon-cyan); animation-delay: 200ms; --tx: 40px; --ty: -85px; }
    .firework:nth-child(6) { top: 20%; left: 80%; background: #fff; animation-delay: 250ms; --tx: -30px; --ty: -55px; }
    .firework:nth-child(7) { top: 60%; left: 15%; background: var(--neon-gold); animation-delay: 300ms; --tx: 60px; --ty: -40px; }
    .firework:nth-child(8) { top: 60%; left: 15%; background: var(--neon-purple); animation-delay: 350ms; --tx: -35px; --ty: -65px; }
    .firework:nth-child(9) { top: 60%; left: 85%; background: var(--neon-cyan); animation-delay: 200ms; --tx: -55px; --ty: -45px; }
    .firework:nth-child(10) { top: 60%; left: 85%; background: var(--neon-pink); animation-delay: 250ms; --tx: 45px; --ty: -75px; }
    .firework:nth-child(11) { top: 40%; left: 50%; background: #fff; animation-delay: 100ms; --tx: 0px; --ty: -100px; }
    .firework:nth-child(12) { top: 40%; left: 50%; background: var(--neon-gold); animation-delay: 150ms; --tx: -70px; --ty: -50px; }

    @keyframes firework-burst {
      0% { opacity: 1; transform: translate(0, 0) scale(2); box-shadow: 0 0 20px currentColor; }
      100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); box-shadow: 0 0 40px currentColor; }
    }

    /* Confetti Rain */
    .confetti {
      position: absolute;
      top: -10px;
      width: 10px;
      height: 10px;
      opacity: 0;
    }

    .celebration-overlay.active .confetti {
      animation: confetti-fall 1.5s ease-out forwards;
    }

    .confetti:nth-child(13) { left: 10%; background: var(--neon-cyan); animation-delay: 0ms; --rot: 720deg; }
    .confetti:nth-child(14) { left: 25%; background: var(--neon-pink); animation-delay: 100ms; --rot: -540deg; }
    .confetti:nth-child(15) { left: 40%; background: var(--neon-gold); animation-delay: 200ms; --rot: 630deg; }
    .confetti:nth-child(16) { left: 55%; background: var(--neon-purple); animation-delay: 50ms; --rot: -450deg; }
    .confetti:nth-child(17) { left: 70%; background: #fff; animation-delay: 150ms; --rot: 810deg; }
    .confetti:nth-child(18) { left: 85%; background: var(--neon-cyan); animation-delay: 250ms; --rot: -360deg; }

    @keyframes confetti-fall {
      0% { opacity: 1; transform: translateY(0) rotate(0deg); }
      100% { opacity: 0; transform: translateY(400px) rotate(var(--rot)); }
    }

    /* Legacy sparkle-burst for backwards compatibility */
    .sparkle-burst {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 0;
      height: 0;
      pointer-events: none;
      z-index: 600;
    }

    /* ═══════════════════════════════════════════════════════════════
       CHARACTER CUSTOMIZATION MODAL
    ═══════════════════════════════════════════════════════════════ */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(4px);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 400;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .modal {
      width: 100%;
      max-width: 340px;
      background: var(--bg-mid);
      border-radius: 24px;
      padding: 24px;
      transform: scale(0.9);
      transition: transform 0.3s var(--bounce);
    }

    .modal-overlay.active .modal {
      transform: scale(1);
    }

    .modal-title {
      font-size: 20px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 20px;
    }

    .customization-preview {
      display: flex;
      justify-content: center;
      margin-bottom: 24px;
    }

    .color-section {
      margin-bottom: 20px;
    }

    .color-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }

    .color-options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .color-option {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      border: 3px solid transparent;
      transition: all 0.2s ease;
    }

    .color-option:active {
      transform: scale(0.9);
    }

    .color-option.selected {
      border-color: var(--neon-cyan);
      box-shadow: 0 0 12px var(--neon-cyan);
    }

    .modal-close {
      width: 100%;
      padding: 14px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 14px;
      color: var(--text-primary);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 8px;
    }
      /* ═══════════════════════════════════════════════════════════════
       GLOBAL PARTY LIGHTS — Persistent Across All Screens
       These lights NEVER reset when switching screens!
    ═══════════════════════════════════════════════════════════════ */
    .global-party-lights {
      position: fixed;
      top: -20%;
      left: -20%;
      right: -20%;
      bottom: -20%;
      pointer-events: none;
      z-index: 0;
      overflow: visible;
    }

    .global-haze {
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at 50% 0%, rgba(138, 43, 226, 0.1) 0%, transparent 60%),
                  radial-gradient(ellipse at 20% 100%, rgba(255, 0, 128, 0.05) 0%, transparent 50%),
                  radial-gradient(ellipse at 80% 100%, rgba(0, 245, 255, 0.05) 0%, transparent 50%);
      animation: haze-drift 20s ease-in-out infinite;
    }

    @keyframes haze-drift {
      0%, 100% { opacity: 0.8; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.05); }
    }

    /* Global Spotlights - extend beyond viewport */
    .global-spotlight {
      position: absolute;
      top: -30%;
      width: 350px;
      height: 200%;
      transform-origin: 50% 0%;
      mix-blend-mode: screen;
    }

    .global-spotlight::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 100%;
      clip-path: polygon(35% 0%, 65% 0%, 100% 100%, 0% 100%);
    }

    .global-spotlight.g-cyan { left: 5%; animation: spotlight-sweep-1 8s ease-in-out infinite; }
    .global-spotlight.g-cyan::before {
      background: linear-gradient(180deg, rgba(0, 245, 255, 0.5) 0%, rgba(0, 245, 255, 0.1) 40%, transparent 80%);
    }

    .global-spotlight.g-pink { right: 5%; animation: spotlight-sweep-2 9s ease-in-out infinite; }
    .global-spotlight.g-pink::before {
      background: linear-gradient(180deg, rgba(255, 0, 128, 0.5) 0%, rgba(255, 0, 128, 0.1) 40%, transparent 80%);
    }

    .global-spotlight.g-purple { left: 35%; animation: spotlight-sweep-3 7s ease-in-out infinite; }
    .global-spotlight.g-purple::before {
      background: linear-gradient(180deg, rgba(138, 43, 226, 0.4) 0%, rgba(138, 43, 226, 0.1) 40%, transparent 80%);
    }

    .global-spotlight.g-gold { right: 35%; animation: spotlight-sweep-4 10s ease-in-out infinite; }
    .global-spotlight.g-gold::before {
      background: linear-gradient(180deg, rgba(255, 215, 0, 0.3) 0%, rgba(255, 215, 0, 0.05) 40%, transparent 80%);
    }

    @keyframes spotlight-sweep-1 { 0%, 100% { transform: rotate(-25deg); } 50% { transform: rotate(15deg); } }
    @keyframes spotlight-sweep-2 { 0%, 100% { transform: rotate(25deg); } 50% { transform: rotate(-15deg); } }
    @keyframes spotlight-sweep-3 { 0%, 100% { transform: rotate(-10deg); } 50% { transform: rotate(20deg); } }
    @keyframes spotlight-sweep-4 { 0%, 100% { transform: rotate(10deg); } 50% { transform: rotate(-20deg); } }

    /* Global Lasers - sharp beams that extend beyond screen */
    .global-laser {
      position: absolute;
      top: -10%;
      width: 3px;
      height: 150%;
      transform-origin: 50% 0%;
      mix-blend-mode: screen;
    }

    .global-laser.gl-cyan-1 { left: 15%; background: linear-gradient(180deg, rgba(0,245,255,0.9), rgba(0,245,255,0.3) 50%, transparent); animation: laser-1 6s ease-in-out infinite; }
    .global-laser.gl-cyan-2 { left: 25%; background: linear-gradient(180deg, rgba(0,245,255,0.7), rgba(0,245,255,0.2) 50%, transparent); animation: laser-2 7s ease-in-out infinite; }
    .global-laser.gl-pink-1 { right: 15%; background: linear-gradient(180deg, rgba(255,0,128,0.9), rgba(255,0,128,0.3) 50%, transparent); animation: laser-3 5s ease-in-out infinite; }
    .global-laser.gl-pink-2 { right: 25%; background: linear-gradient(180deg, rgba(255,0,128,0.7), rgba(255,0,128,0.2) 50%, transparent); animation: laser-4 8s ease-in-out infinite; }
    .global-laser.gl-purple { left: 50%; background: linear-gradient(180deg, rgba(138,43,226,0.8), rgba(138,43,226,0.2) 50%, transparent); animation: laser-5 9s ease-in-out infinite; }

    @keyframes laser-1 { 0%, 100% { transform: rotate(-35deg); opacity: 0.8; } 50% { transform: rotate(10deg); opacity: 1; } }
    @keyframes laser-2 { 0%, 100% { transform: rotate(-20deg); opacity: 0.6; } 50% { transform: rotate(25deg); opacity: 0.9; } }
    @keyframes laser-3 { 0%, 100% { transform: rotate(35deg); opacity: 0.8; } 50% { transform: rotate(-10deg); opacity: 1; } }
    @keyframes laser-4 { 0%, 100% { transform: rotate(20deg); opacity: 0.6; } 50% { transform: rotate(-25deg); opacity: 0.9; } }
    @keyframes laser-5 { 0%, 100% { transform: rotate(-5deg); opacity: 0.5; } 50% { transform: rotate(5deg); opacity: 0.8; } }

    /* Disco scatter dots - global */
    .global-disco-scatter {
      position: absolute;
      inset: 0;
      overflow: visible;
    }

    .global-disco-dot {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: white;
      animation: disco-twinkle 2s ease-in-out infinite;
    }

    @keyframes disco-twinkle {
      0%, 100% { opacity: 0.2; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.5); }
    }

    /* ═══════════════════════════════════════════════════════════════
       DESKTOP VISUAL ENHANCEMENTS — Maximum Wow Factor!
    ═══════════════════════════════════════════════════════════════ */
    @media (min-width: 769px) {
      /* More intense global party lights on desktop */
      .global-haze {
        background: radial-gradient(ellipse at 50% 0%, rgba(138, 43, 226, 0.15) 0%, transparent 60%),
                    radial-gradient(ellipse at 20% 100%, rgba(255, 0, 128, 0.1) 0%, transparent 50%),
                    radial-gradient(ellipse at 80% 100%, rgba(0, 245, 255, 0.1) 0%, transparent 50%);
      }

      /* Bigger spotlights */
      .global-spotlight {
        width: 500px;
      }

      /* Wider laser beams */
      .global-laser {
        width: 4px;
      }

      /* Bigger disco dots */
      .global-disco-dot {
        width: 6px;
        height: 6px;
      }

      /* Enhanced confirmation popup */
      .drop-confirm-content {
        padding: 32px 48px;
        border-radius: 24px;
      }

      .drop-confirm-side {
        font-size: 48px;
      }

      .drop-confirm-question {
        font-size: 20px;
      }

      .drop-confirm-btn {
        padding: 16px 48px;
        font-size: 16px;
        border-radius: 14px;
      }

      /* Hide back button on desktop (always showing sidebar) */
      #back-btn {
        display: none;
      }

      /* Enhanced chat bubbles for desktop */
      .chat-message {
        font-size: 14px;
        padding: 10px 16px;
        max-width: 300px;
      }

      /* Bigger celebration confetti */
      .celebration-particle {
        font-size: 32px;
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       DESKTOP EMPTY STATE — When no market is selected
    ═══════════════════════════════════════════════════════════════ */
    @media (min-width: 769px) {
      .arena-screen:not(.has-market) .nightclub::before {
        content: 'Select a market to join the party!';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
        color: var(--text-muted);
        text-align: center;
        z-index: 10;
        pointer-events: none;
        animation: pulse-text 2s ease-in-out infinite;
      }

      @keyframes pulse-text {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 0.8; }
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       TABLET OPTIMIZATIONS (769px - 1024px)
    ═══════════════════════════════════════════════════════════════ */
    @media (min-width: 769px) and (max-width: 1024px) {
      :root {
        --sidebar-width: 300px;
      }

      .market-card {
        padding: 10px;
      }

      .market-question {
        font-size: 12px;
      }

      .zone-label {
        font-size: 28px;
      }

      .villager-avatar {
        transform: scale(1.15);
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       TOSHIRO'S LAYER 1: CRT HARDWARE TEXTURE — Retro-Future Vibe
       Kills the "flat webpage" look. Phone feels like hardware.
    ═══════════════════════════════════════════════════════════════ */
    .crt-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 9999;
      mix-blend-mode: overlay;
      opacity: 0.04;
    }

    .crt-scanlines {
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.15) 2px,
        rgba(0, 0, 0, 0.15) 4px
      );
      animation: scanline-flicker 0.1s linear infinite;
    }

    @keyframes scanline-flicker {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.98; }
    }

    .crt-noise {
      position: absolute;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.5;
      animation: noise-shift 0.5s steps(10) infinite;
    }

    @keyframes noise-shift {
      0% { transform: translate(0, 0); }
      10% { transform: translate(-1%, -1%); }
      20% { transform: translate(1%, 1%); }
      30% { transform: translate(-1%, 1%); }
      40% { transform: translate(1%, -1%); }
      50% { transform: translate(0, 0); }
      60% { transform: translate(-1%, 0); }
      70% { transform: translate(1%, 1%); }
      80% { transform: translate(0, -1%); }
      90% { transform: translate(-1%, 1%); }
      100% { transform: translate(0, 0); }
    }

    /* ═══════════════════════════════════════════════════════════════
       PICTO-PARTY: AMBIENT GLASS FLOOR — Slow, Classy Breathing
       "Not a rave; a lounge. The floor breathes slowly." — Toshiro
    ═══════════════════════════════════════════════════════════════ */
    .floor-zone.yes {
      /* SLOWED: 10s for calm, ambient glow */
      animation: zone-breathe-cyan 10s ease-in-out infinite;
    }

    .floor-zone.no {
      /* SLOWED: 10s for calm, ambient glow */
      animation: zone-breathe-pink 10s ease-in-out infinite;
    }

    @keyframes zone-breathe-cyan {
      0%, 100% {
        box-shadow:
          inset 0 0 40px rgba(0, 240, 255, 0.1),
          0 0 30px rgba(0, 240, 255, 0.08);
      }
      50% {
        box-shadow:
          inset 0 0 60px rgba(0, 240, 255, 0.18),
          0 0 50px rgba(0, 240, 255, 0.12);
      }
    }

    @keyframes zone-breathe-pink {
      0%, 100% {
        box-shadow:
          inset 0 0 40px rgba(255, 0, 85, 0.1),
          0 0 30px rgba(255, 0, 85, 0.08);
      }
      50% {
        box-shadow:
          inset 0 0 60px rgba(255, 0, 85, 0.18),
          0 0 50px rgba(255, 0, 85, 0.12);
      }
    }

    /* ═══════════════════════════════════════════════════════════════
       TOSHIRO'S LAYER 3: CONFETTI PARTICLES — Vote Celebration!
    ═══════════════════════════════════════════════════════════════ */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1000;
      overflow: hidden;
    }

    .confetti-particle {
      position: absolute;
      width: 8px;
      height: 8px;
      opacity: 1;
      border-radius: 2px;
    }

    /* ═══════════════════════════════════════════════════════════════
       TOSHIRO'S LAYER 4: GLASS DOCK UPGRADE — OLED Luxury
    ═══════════════════════════════════════════════════════════════ */
    .tab-bar {
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.15),
        0 -4px 30px rgba(0, 0, 0, 0.4);
    }

    /* Desktop sidebar nav glass effect */
    .desktop-nav {
      backdrop-filter: blur(16px) saturate(160%);
      -webkit-backdrop-filter: blur(16px) saturate(160%);
      box-shadow:
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 -2px 20px rgba(0, 0, 0, 0.3);
    }
  </style>
</head>
<body>
  <!-- TOSHIRO'S CRT OVERLAY — Retro-Future Hardware Texture -->
  <div class="crt-overlay">
    <div class="crt-scanlines"></div>
    <div class="crt-noise"></div>
  </div>

  <!-- CONFETTI CONTAINER — For vote celebrations -->
  <div class="confetti-container" id="confetti-container"></div>

  <!-- GLOBAL PARTY LIGHTS — Always visible, never resets! -->
  <div class="global-party-lights" id="global-lights">
    <div class="global-haze"></div>
    <!-- Spotlights that extend beyond viewport -->
    <div class="global-spotlight g-cyan"></div>
    <div class="global-spotlight g-pink"></div>
    <div class="global-spotlight g-purple"></div>
    <div class="global-spotlight g-gold"></div>
    <!-- Sharp laser beams -->
    <div class="global-laser gl-cyan-1"></div>
    <div class="global-laser gl-cyan-2"></div>
    <div class="global-laser gl-pink-1"></div>
    <div class="global-laser gl-pink-2"></div>
    <div class="global-laser gl-purple"></div>
    <!-- Disco scatter -->
    <div class="global-disco-scatter" id="global-disco"></div>
  </div>

  <div class="app">
    <!-- ═══════════════════════════════════════════════════════════════
         HOME SCREEN
    ═══════════════════════════════════════════════════════════════ -->
    <div class="screen home-screen active" id="screen-home">
      <!-- Party Vibes — Now handled by global lights -->
      <div class="home-party-vibes" style="display: none;">
        <!-- Atmospheric Haze -->
        <div class="home-haze"></div>
        <!-- Stage Spotlights -->
        <div class="home-spotlight cyan"></div>
        <div class="home-spotlight pink"></div>
        <div class="home-spotlight purple"></div>
        <div class="home-spotlight gold"></div>
        <!-- Secondary Spotlights for extra drama -->
        <div class="home-spotlight cyan-2"></div>
        <div class="home-spotlight pink-2"></div>
        <!-- Laser Beams -->
        <div class="home-laser cyan-1"></div>
        <div class="home-laser cyan-2"></div>
        <div class="home-laser pink-1"></div>
        <div class="home-laser pink-2"></div>
        <div class="home-laser purple"></div>
        <!-- Floor Glow -->
        <div class="home-floor-glow"></div>
        <!-- Disco Ball Reflections -->
        <div class="home-disco-dots">
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
          <div class="disco-dot"></div>
        </div>
        <!-- Lens Flare -->
        <div class="home-lens-flare"></div>
      </div>

      <div class="hero">
        <div class="logo-container">
          <img src="/logologo.png" alt="PREDICTION PARTY" class="logo-image">
        </div>
      </div>

      <div class="section-header">
        <h2 class="section-title">
          <span class="icon">🔥</span>
          Hot Right Now
        </h2>
        <button class="see-all">See all</button>
      </div>

      <div class="market-grid" id="market-grid">
        <!-- Markets populated by JS -->
      </div>

      <!-- Desktop Sidebar Navigation (hidden on mobile) -->
      <nav class="desktop-nav" id="desktop-nav">
        <button class="tab-btn active" data-tab="home">
          <span class="icon">🏠</span>
          <span class="label">Home</span>
        </button>
        <button class="tab-btn" data-tab="leaderboard">
          <span class="icon">🏆</span>
          <span class="label">Leaders</span>
        </button>
        <button class="tab-btn" data-tab="profile">
          <span class="icon">👤</span>
          <span class="label">Profile</span>
        </button>
      </nav>
    </div>

    <!-- ═══════════════════════════════════════════════════════════════
         ARENA SCREEN — The Nightclub
    ═══════════════════════════════════════════════════════════════ -->
    <div class="screen arena-screen" id="screen-arena">
      <!-- Epic Arena Stage Lights -->
      <div class="arena-stage-lights" style="display: none;">
        <!-- Now using global-party-lights instead -->
        <div class="arena-haze"></div>
        <!-- Wide Spotlights -->
        <div class="arena-spotlight left-1"></div>
        <div class="arena-spotlight left-2"></div>
        <div class="arena-spotlight right-1"></div>
        <div class="arena-spotlight right-2"></div>
        <div class="arena-spotlight center"></div>
        <div class="arena-spotlight gold"></div>
        <!-- Sharp Laser Beams -->
        <div class="arena-laser cyan-1"></div>
        <div class="arena-laser cyan-2"></div>
        <div class="arena-laser pink-1"></div>
        <div class="arena-laser pink-2"></div>
        <div class="arena-laser purple"></div>
        <!-- Disco Ball Scatter -->
        <div class="arena-disco-scatter">
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
          <div class="scatter-dot"></div>
        </div>
        <!-- Subtle Strobe -->
        <div class="arena-strobe"></div>
      </div>

      <!-- === STAGE ROOF === Compact Global Nav -->
      <div class="stage-roof">
        <button class="roof-back" id="roof-back-btn">
          <span class="roof-back-arrow">←</span>
          <span>Back</span>
        </button>
        <div class="roof-live">
          <span class="roof-live-dot"></span>
          <span class="roof-live-text">LIVE</span>
        </div>
        <div class="roof-spacer"></div>
      </div>

      <!-- === THE JUMBOTRON === Massive LED Matrix Screen -->
      <div class="jumbotron">
        <div class="jumbotron-glow"></div>
        <div class="jumbotron-screen">
          <div class="jumbotron-pixels"></div>
          <div class="jumbotron-scanlines"></div>
          <div class="jumbotron-flash yes" id="jumbotron-flash-yes"></div>
          <div class="jumbotron-flash no" id="jumbotron-flash-no"></div>
          <div class="jumbotron-question" id="jumbotron-question">WILL BTC HIT $100K?</div>
          <div class="jumbotron-stats">
            <div class="jumbotron-stat no">
              <span class="jumbotron-stat-label">NO</span>
              <span class="jumbotron-stat-value" id="jumbotron-no-pct">35%</span>
            </div>
            <div class="jumbotron-divider"></div>
            <div class="jumbotron-stat yes">
              <span class="jumbotron-stat-label">YES</span>
              <span class="jumbotron-stat-value" id="jumbotron-yes-pct">65%</span>
            </div>
          </div>
          <div class="jumbotron-bar">
            <div class="jumbotron-bar-fill no" id="jumbotron-bar-no" style="width: 35%"></div>
            <div class="jumbotron-bar-fill yes" id="jumbotron-bar-yes" style="width: 65%"></div>
          </div>
        </div>
        <div class="stage-spotlight-cone"></div>
      </div>

      <!-- Nintendo-Style Header Bar (Hidden on desktop - replaced by Roof) -->
      <div class="arena-header">
        <button class="nav-btn" id="back-btn">
          <span class="nav-icon">←</span>
          <span class="nav-label">Back</span>
        </button>
        <div class="market-title-bar">
          <h1 class="market-title" id="arena-title">Will BTC hit $100k?</h1>
          <div class="market-meta">
            <div class="live-indicator">
              <span class="live-dot"></span>
              <span class="live-text">LIVE</span>
            </div>
            <div class="countdown-clock" id="countdown-clock">
              <span class="countdown-icon">⏰</span>
              <span class="countdown-time" id="countdown-time">--d --h --m</span>
            </div>
          </div>
        </div>
        <button class="nav-btn" id="markets-btn">
          <span class="nav-icon">☰</span>
          <span class="nav-label">Markets</span>
        </button>
      </div>

      <!-- Score Bar — Progress Bars -->
      <div class="scores-container">
        <!-- Kalshi Row -->
        <div class="score-row kalshi">
          <span class="score-source-label kalshi">Kalshi</span>
          <div class="score-progress-bar">
            <div class="score-fill-yes" id="kalshi-bar-yes" style="width: 65%">
              <span class="score-percent" id="kalshi-yes">65%</span>
            </div>
            <div class="score-fill-no">
              <span class="score-percent" id="kalshi-no">35%</span>
            </div>
          </div>
        </div>
        <!-- Party Row -->
        <div class="score-row party">
          <span class="score-source-label party">Party</span>
          <div class="score-progress-bar">
            <div class="score-fill-yes" id="party-bar-yes" style="width: 72%">
              <span class="score-percent" id="party-yes">72%</span>
            </div>
            <div class="score-fill-no">
              <span class="score-percent" id="party-no">28%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- The Nightclub -->
      <div class="nightclub">
        <!-- Wall Mounted Spotlights -->
        <div class="wall-lights">
          <div class="spotlight-mount">
            <div class="spotlight-arm"></div>
            <div class="spotlight-head pink">
              <div class="spotlight-beam pink"></div>
            </div>
          </div>
          <div class="spotlight-mount">
            <div class="spotlight-arm"></div>
            <div class="spotlight-head cyan">
              <div class="spotlight-beam cyan"></div>
            </div>
          </div>
          <div class="spotlight-mount">
            <div class="spotlight-arm"></div>
            <div class="spotlight-head gold">
              <div class="spotlight-beam gold"></div>
            </div>
          </div>
          <div class="spotlight-mount">
            <div class="spotlight-arm"></div>
            <div class="spotlight-head pink">
              <div class="spotlight-beam pink"></div>
            </div>
          </div>
          <div class="spotlight-mount">
            <div class="spotlight-arm"></div>
            <div class="spotlight-head cyan">
              <div class="spotlight-beam cyan"></div>
            </div>
          </div>
        </div>

        <!-- EPIC MARQUEE SIGN — Turntable.fm Style! -->
        <div class="marquee-sign">
          <div class="marquee-frame">
            <div class="marquee-lights">
              <span></span><span></span><span></span><span></span><span></span>
              <span></span><span></span><span></span><span></span><span></span>
            </div>
            <div class="marquee-content">
              <div class="marquee-vote-icon no">👎</div>
              <div class="marquee-center">
                <!-- LIVE Badge + Countdown -->
                <div class="marquee-live-row">
                  <div class="marquee-live">
                    <span class="live-dot"></span>
                    <span>LIVE</span>
                  </div>
                  <div class="marquee-countdown" id="marquee-countdown">
                    <span class="countdown-icon">⏰</span>
                    <span id="marquee-countdown-time">5h 18m</span>
                  </div>
                </div>
                <!-- Market Question -->
                <div class="marquee-question" id="marquee-question">Will BTC hit $100k by Dec 31?</div>
                <!-- Stacked Progress Bars: Kalshi + Party — YES (blue) on LEFT like sidebar! -->
                <div class="marquee-bars">
                  <!-- Kalshi Bar -->
                  <div class="marquee-bar-row kalshi">
                    <span class="marquee-bar-label">KALSHI</span>
                    <div class="marquee-bar-container">
                      <div class="marquee-bar yes kalshi" id="marquee-kalshi-yes" style="width: 65%"></div>
                      <div class="marquee-bar no kalshi-no" id="marquee-kalshi-no" style="width: 35%"></div>
                    </div>
                    <span class="marquee-bar-pct" id="marquee-kalshi-pct">65%</span>
                  </div>
                  <!-- Party Bar -->
                  <div class="marquee-bar-row party">
                    <span class="marquee-bar-label">PARTY</span>
                    <div class="marquee-bar-container">
                      <div class="marquee-bar yes" id="marquee-bar-yes" style="width: 72%"></div>
                      <div class="marquee-bar no" id="marquee-bar-no" style="width: 28%"></div>
                    </div>
                    <span class="marquee-bar-pct" id="marquee-yes-pct">72%</span>
                  </div>
                </div>
              </div>
              <div class="marquee-vote-icon yes">👍</div>
            </div>
            <div class="marquee-lights bottom">
              <span></span><span></span><span></span><span></span><span></span>
              <span></span><span></span><span></span><span></span><span></span>
            </div>
          </div>
        </div>

        <!-- DJ Booth -->
        <div class="dj-booth-visual">
          <div class="dj-character">
            <div class="dj-head">
              <div class="dj-headphones"></div>
            </div>
            <div class="dj-body">
              <div class="dj-arm left"></div>
              <div class="dj-arm right"></div>
            </div>
          </div>
          <div class="dj-table">
            <div class="turntable"></div>
            <div class="mixer">
              <div class="mixer-slider"></div>
              <div class="mixer-slider"></div>
            </div>
            <div class="turntable"></div>
          </div>
          <div class="dj-label">DJ PREDICT</div>
          <!-- Pulsating Speakers -->
          <div class="dj-speakers">
            <div class="speaker left">
              <div class="speaker-cone"></div>
              <div class="bass-wave"></div>
              <div class="bass-wave"></div>
              <div class="bass-wave"></div>
            </div>
            <div class="speaker right">
              <div class="speaker-cone"></div>
              <div class="bass-wave"></div>
              <div class="bass-wave"></div>
              <div class="bass-wave"></div>
            </div>
          </div>
        </div>

        <!-- NINTENDO CHARM — Stage Decorations! -->
        <div class="stage-decorations">
          <!-- Disco Ball -->
          <div class="disco-ball">
            <div class="disco-ball-top"></div>
            <div class="disco-ball-sphere">
              <div class="disco-facet"></div>
              <div class="disco-facet"></div>
              <div class="disco-facet"></div>
              <div class="disco-facet"></div>
            </div>
            <div class="disco-ball-reflection"></div>
          </div>
          <!-- Velvet Ropes -->
          <div class="velvet-rope left">
            <div class="rope-post"></div>
            <div class="rope-cord"></div>
          </div>
          <div class="velvet-rope right">
            <div class="rope-post"></div>
            <div class="rope-cord"></div>
          </div>
          <!-- Stage Edge Lights -->
          <div class="stage-edge-lights">
            <span></span><span></span><span></span><span></span><span></span>
            <span></span><span></span><span></span><span></span><span></span>
          </div>
        </div>

        <!-- FESTIVAL LASERS — Techno Energy -->
        <div class="laser-show">
          <div class="laser-beam cyan"></div>
          <div class="laser-beam pink"></div>
          <div class="laser-beam purple"></div>
          <div class="laser-beam gold"></div>
          <div class="laser-beam cyan" style="animation-delay: -2s"></div>
          <div class="laser-beam pink" style="animation-delay: -1.5s"></div>
        </div>

        <!-- FESTIVAL TOTEMS — Crowd Energy -->
        <div class="festival-totem left">
          <div class="totem-glow"></div>
        </div>
        <div class="festival-totem right">
          <div class="totem-glow"></div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════
             PAPER MARIO — THE CEILING SIGN (Hanging Jumbotron)
             "It HANGS from the ceiling. It floats ABOVE the DJ." — Toshiro
        ═══════════════════════════════════════════════════════════════ -->
        <div class="ceiling-sign" id="ceiling-sign">
          <div class="ceiling-chains">
            <div class="chain"></div>
            <div class="chain"></div>
          </div>
          <div class="sign-board">
            <div class="sign-question" id="sign-question">WILL BTC HIT $100K?</div>
            <div class="sign-progress-bar">
              <div class="sign-progress-no" id="sign-progress-no" style="width: 35%"></div>
              <div class="sign-progress-yes" id="sign-progress-yes" style="width: 65%"></div>
            </div>
            <div class="sign-live">
              <span class="sign-live-dot"></span>
              <span>LIVE</span>
            </div>
          </div>
        </div>

        <!-- Legacy HUD (hidden by CSS) -->
        <div class="hud-question" id="hud-question" style="display:none;">
          <div class="hud-question-text" id="hud-question-text">WILL BTC HIT $100K?</div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════
             VOLUMETRIC LIGHT BEAMS — Nightclub Atmosphere
        ═══════════════════════════════════════════════════════════════ -->
        <div class="volumetric-lights">
          <div class="light-beam pink"></div>
          <div class="light-beam pink-2"></div>
          <div class="light-beam cyan"></div>
          <div class="light-beam cyan-2"></div>
        </div>

        <div class="iso-room" id="iso-room">
          <!-- THE 3D WORLD — STRAIGHT ON VIEW (no Z rotation!) -->
          <div class="iso-world" id="iso-world">

            <!-- WALLS ARE NOW CHILDREN OF FLOOR ZONES — See .floor-zone .zone-wall -->

            <!-- THE JUMBOTRON — Wall-mounted screen (HIDDEN - data now on zone walls) -->
            <div class="iso-jumbotron" id="iso-jumbotron">
              <div class="iso-jumbotron-frame"></div>
              <div class="iso-jumbotron-screen">
                <div class="iso-jumbotron-question" id="iso-jumbotron-question">WILL BTC HIT $100K?</div>
                <div class="iso-jumbotron-bar">
                  <div class="iso-jumbotron-bar-yes" id="iso-bar-yes" style="width: 65%"></div>
                  <div class="iso-jumbotron-bar-no" id="iso-bar-no" style="width: 35%"></div>
                </div>
              </div>
              <div class="iso-jumbotron-light"></div>
            </div>

            <!-- THE DJ BOOTH — Physical 3D Block Structure -->
            <div class="iso-dj-booth">
              <div class="dj-booth-block">
                <!-- 3D Faces -->
                <div class="dj-booth-top">
                  <div class="dj-turntables">
                    <div class="dj-turntable"></div>
                    <div class="dj-turntable"></div>
                  </div>
                  <div class="dj-mixer">
                    <div class="dj-mixer-slider"></div>
                    <div class="dj-mixer-slider"></div>
                  </div>
                </div>
                <div class="dj-booth-front-left"></div>
                <div class="dj-booth-front-right"></div>
              </div>
              <!-- PICTO-PARTY: STICK FIGURE DJ with Headphones -->
              <div class="stick-dj">
                <div class="stick-dj-head">
                  <div class="stick-dj-headphones"></div>
                </div>
                <div class="stick-dj-body"></div>
                <div class="stick-dj-arms"></div>
                <div class="stick-dj-legs"></div>
                <div class="stick-dj-label">DJ PREDICT</div>
              </div>
            </div>

            <!-- THE TETRIS FLOOR — [NO (Pink/Left)] [YES (Cyan/Right)] -->
            <div class="iso-floor" id="iso-floor">

              <!-- NO Zone (LEFT) — Pink/Red — Wall is CHILD of zone -->
              <div class="floor-zone no" id="zone-no">
                <!-- HOLOGRAM: Energy curtain + floating label -->
                <div class="energy-curtain no"></div>
                <div class="hologram-label no" id="hologram-no">
                  NO
                  <span class="hologram-percent" id="hologram-no-pct">(35%)</span>
                </div>
                <!-- NO WALL — Sits "North" of NO floor, resizes with zone -->
                <div class="zone-wall no">
                  <div class="wall-label">NO</div>
                  <div class="wall-odds" id="wall-no-odds">35%</div>
                </div>
                <!-- PICTO-PARTY: 4x4 grid for WIDER tiles -->
                <div class="iso-tile-grid" id="iso-grid-no">
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                </div>
                <div class="crowd-area" id="crowd-no"></div>
              </div>

              <!-- YES Zone (RIGHT) — Cyan/Blue — Wall is CHILD of zone -->
              <div class="floor-zone yes" id="zone-yes">
                <!-- HOLOGRAM: Energy curtain + floating label -->
                <div class="energy-curtain yes"></div>
                <div class="hologram-label yes" id="hologram-yes">
                  YES
                  <span class="hologram-percent" id="hologram-yes-pct">(65%)</span>
                </div>
                <!-- YES WALL — Sits "North" of YES floor, resizes with zone -->
                <div class="zone-wall yes">
                  <div class="wall-label">YES</div>
                  <div class="wall-odds" id="wall-yes-odds">65%</div>
                </div>
                <!-- PICTO-PARTY: 4x4 grid for WIDER tiles -->
                <div class="iso-tile-grid" id="iso-grid-yes">
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                  <div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div><div class="iso-tile"></div>
                </div>
                <div class="crowd-area" id="crowd-yes"></div>
              </div>

            </div>

          </div><!-- /iso-world -->

          <!-- THE PLAYER — Outside iso-world for free dragging -->
          <div class="iso-player" id="iso-player">
            <div class="iso-player-shadow"></div>
            <div class="iso-player-sprite" id="iso-player-sprite">
              <div class="iso-player-crown">👑</div>
              <div class="iso-player-head">
                <div class="iso-player-photo" style="background-image: url('/tg/zac.jpg')"></div>
              </div>
              <div class="iso-player-body"></div>
            </div>
            <div class="player-speech" id="player-speech"></div>
          </div>

        </div><!-- /iso-room -->

        <!-- Player Dock / Drag Hint (stays outside room) -->
        <div class="control-deck">
          <div class="player-dock" id="player-dock">
            <div class="drag-hint">← NO &nbsp;|&nbsp; YES →</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab Bar -->
    <nav class="tab-bar" id="tab-bar">
      <button class="tab-btn active" data-tab="home">
        <span class="icon">🏠</span>
        <span class="label">Home</span>
      </button>
      <button class="tab-btn" data-tab="leaderboard">
        <span class="icon">🏆</span>
        <span class="label">Leaders</span>
      </button>
      <button class="tab-btn" data-tab="profile">
        <span class="icon">👤</span>
        <span class="label">Profile</span>
      </button>
    </nav>

    <!-- Slide-to-Confirm Panel -->
    <div class="slide-confirm-panel" id="slide-panel">
      <div class="panel-handle"></div>
      <div class="panel-header">
        <div class="panel-title">
          Confirm Bet
          <span class="panel-side-badge yes" id="panel-badge">YES</span>
        </div>
        <button class="panel-close" id="panel-close">✕</button>
      </div>
      <div class="panel-why">
        <label class="panel-why-label">Why? (optional)</label>
        <textarea class="panel-why-input" id="panel-why-input" placeholder="Share your reasoning with the party..." rows="2"></textarea>
      </div>
      <div class="slide-track" id="slide-track">
        <div class="slide-track-fill yes" id="slide-fill"></div>
        <div class="slide-track-text">Swipe UP</div>
        <div class="slide-thumb yes" id="slide-thumb">
          <span class="slide-thumb-icon">↑</span>
        </div>
        <div class="slide-success" id="slide-success">
          CONFIRMED!
        </div>
      </div>
    </div>

    <!-- Drop Confirmation Popup -->
    <div class="drop-confirm-popup" id="drop-confirm">
      <div class="drop-confirm-card">
        <div class="drop-confirm-title">Lock in your position?</div>
        <div class="drop-confirm-side yes" id="drop-confirm-side">YES</div>
        <div class="drop-confirm-question" id="drop-confirm-question">Are you sure you want to vote YES on this market?</div>
        <div class="drop-confirm-buttons">
          <button class="drop-confirm-btn cancel" id="drop-confirm-cancel">Go Back</button>
          <button class="drop-confirm-btn confirm" id="drop-confirm-yes">Let's Go!</button>
        </div>
      </div>
    </div>

    <!-- Nintendo Victory Celebration Overlay -->
    <div class="celebration-overlay" id="celebration">
      <div class="celebration-text">WOW!</div>
      <div class="celebration-subtitle">Your vote is locked in!</div>
      <!-- Fireworks -->
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <div class="firework"></div>
      <!-- Confetti -->
      <div class="confetti"></div>
      <div class="confetti"></div>
      <div class="confetti"></div>
      <div class="confetti"></div>
      <div class="confetti"></div>
      <div class="confetti"></div>
    </div>

    <!-- Legacy Sparkle Burst -->
    <div class="sparkle-burst" id="sparkle-burst"></div>

    <!-- Character Customization Modal -->
    <div class="modal-overlay" id="modal-customize">
      <div class="modal">
        <h2 class="modal-title">Customize Your Look</h2>
        <div class="customization-preview" id="customize-preview"></div>

        <div class="color-section">
          <div class="color-label">Skin Tone</div>
          <div class="color-options" id="skin-options"></div>
        </div>

        <div class="color-section">
          <div class="color-label">Hair Color</div>
          <div class="color-options" id="hair-options"></div>
        </div>

        <button class="modal-close" id="modal-close">Done</button>
      </div>
    </div>
  </div>

  <script>
    // ═══════════════════════════════════════════════════════════════
    // PREDICTION PARTY — Main Script
    // ═══════════════════════════════════════════════════════════════

    // AZFLIN'S AI EMPORIUM — Demo Data
    // REAL TELEGRAM AVATARS ONLY — The Party Crew!
    const MEMBERS = [
      { name: 'AzFlin', photo: '/tg/AzFlin.jpg' },
      { name: 'biz', photo: '/tg/biz.jpg' },
      { name: 'Ferengi', photo: '/tg/ferengi.jpg' },
      { name: 'Frosty', photo: '/tg/frostyflakes.jpg' },
      { name: 'jin', photo: '/tg/jin.jpg' },
      { name: 'Phanes', photo: '/tg/phanes.jpg' },
      { name: 'Pupul', photo: '/tg/pupul.jpg' },
      { name: 'Rob', photo: '/tg/rob.jpg' },
      { name: 'Shinkiro', photo: '/tg/shinkiro14.jpg' },
      { name: 'Skely', photo: '/tg/skely.jpg' },
      { name: 'Tintin', photo: '/tg/Tintin.jpg' },
      { name: 'VN', photo: '/tg/vn.jpg' },
      { name: 'Ultra', photo: '/tg/ultra.png' },
      { name: 'Icobeast', photo: '/tg/icobeast.jpg' },
      { name: 'Bandit', photo: '/tg/bandit.jpg' }
    ];

    const MARKETS = [
      {
        id: 1,
        question: "Will BTC hit $100k by Dec 31?",
        kalshiYes: 65,
        partyYes: 72,
        count: 74,
        volume: "$2.4M",
        endDate: new Date('2025-12-31T23:59:59')
      },
      {
        id: 2,
        question: "Will Elon visit Mars before 2030?",
        kalshiYes: 6,
        partyYes: 12,
        count: 39,
        volume: "$890K",
        endDate: new Date('2030-01-01T00:00:00')
      },
      {
        id: 3,
        question: "Will there be a US recession in 2025?",
        kalshiYes: 38,
        partyYes: 45,
        count: 47,
        volume: "$1.2M",
        endDate: new Date('2025-12-31T23:59:59')
      },
      {
        id: 4,
        question: "Will GPT-5 release by June 2025?",
        kalshiYes: 71,
        partyYes: 68,
        count: 28,
        volume: "$560K",
        endDate: new Date('2025-06-30T23:59:59')
      }
    ];

    const CHAT_MESSAGES = [
      { name: 'AzFlin', text: 'BTC to the moon! 🚀', side: 'left' },
      { name: 'Chris', text: 'Nah, we\'re gonna dump', side: 'right' },
      { name: 'Rina', text: 'Already past 95k tho...', side: 'left' },
      { name: 'biz', text: 'WAGMI', side: 'right' },
      { name: 'satsmonkes', text: 'Stack sats!', side: 'left' },
      { name: 'Skely', text: 'ded either way', side: 'right' }
    ];

    // Villager speech bubble messages - Miiverse style
    const VILLAGER_THOUGHTS = {
      yes: ['LFG! 🚀', 'WAGMI', 'bullish!', '📈📈', 'ez money', 'to the moon', 'we got this', '100%', 'stack it', 'lfgggg'],
      no: ['ngmi', 'ded 💀', 'rekt soon', '📉📉', 'nah fam', 'its over', 'sell sell', 'dump it', 'RIP', 'bearish']
    };

    let currentMarket = null;
    let playerTeam = null;

    // ═══════════════════════════════════════════════════════════════
    // NINTENDO SPRING PHYSICS CONFIG — The "Snappy" Feel
    // ═══════════════════════════════════════════════════════════════
    const SPRING = {
      stiffness: 400,
      damping: 25,
      mass: 0.8
    };

    // Spring physics state
    let springVelocity = { x: 0, y: 0 };
    let lastDragPos = { x: 0, y: 0 };

    // DOM Elements
    const screenHome = document.getElementById('screen-home');
    const screenArena = document.getElementById('screen-arena');
    const marketGrid = document.getElementById('market-grid');
    const tabBar = document.getElementById('tab-bar');
    // HABBO 2026 — New isometric player elements
    const isoPlayer = document.getElementById('iso-player');
    const isoPlayerSprite = document.getElementById('iso-player-sprite');
    const isoRoom = document.getElementById('iso-room');
    // Legacy aliases for compatibility
    const player = isoPlayerSprite;
    const playerContainer = isoPlayer;
    const slidePanel = document.getElementById('slide-panel');
    const zoneYes = document.getElementById('zone-yes');
    const zoneNo = document.getElementById('zone-no');

    // ═══════════════════════════════════════════════════════════════
    // INITIALIZE
    // ═══════════════════════════════════════════════════════════════
    function init() {
      renderMarkets();
      setupTabBar();
      setupVoting();
      setupDragging();
      setupSlideToConfirm();
      createDiscoReflections();
      createGlobalDiscoDots();

      // AUTO-OPEN FIRST MARKET — INSTANT PARTY VIBES!
      // Users should land DIRECTLY in the party, not an empty lobby.
      // This is the turntable.fm moment: you walk in and people are already dancing.

      // DESKTOP: Both screens must be visible!
      if (isDesktop()) {
        screenHome.classList.add('active');
        screenArena.classList.add('active');
        tabBar.style.display = 'none';
      }

      setTimeout(() => {
        openMarket(0);
        // Highlight first card in sidebar
        highlightActiveMarket(0);
      }, 100); // Tiny delay for DOM to settle

      // Handle window resize for responsive behavior
      window.addEventListener('resize', () => {
        if (isDesktop()) {
          // Ensure both screens visible on desktop
          screenHome.classList.add('active');
          screenArena.classList.add('active');
          tabBar.style.display = 'none';
        } else {
          // On mobile, keep arena active if market is open
          if (currentMarket) {
            screenArena.classList.add('active');
            screenHome.classList.remove('active');
          }
        }
      });
    }

    // Create persistent global disco scatter dots
    function createGlobalDiscoDots() {
      const container = document.getElementById('global-disco');
      if (!container) return;

      // Create 30 scattered disco dots
      for (let i = 0; i < 30; i++) {
        const dot = document.createElement('div');
        dot.className = 'global-disco-dot';
        dot.style.left = `${Math.random() * 140 - 20}%`;
        dot.style.top = `${Math.random() * 140 - 20}%`;
        dot.style.animationDelay = `${Math.random() * 2}s`;
        dot.style.animationDuration = `${1.5 + Math.random() * 2}s`;
        const colors = ['#fff', '#00f5ff', '#ff0080', '#ffd700', '#8a2be2'];
        dot.style.background = colors[Math.floor(Math.random() * colors.length)];
        container.appendChild(dot);
      }
    }

    // ═══════════════════════════════════════════════════════════════
    // RENDER MARKET CARDS
    // ═══════════════════════════════════════════════════════════════
    function renderMarkets() {
      marketGrid.innerHTML = MARKETS.map((market, index) => {
        const partyDiff = market.partyYes - market.kalshiYes;
        const partyLabel = partyDiff > 0 ? `+${partyDiff}% YES` : `${partyDiff}% YES`;

        return `
          <div class="market-card" data-market="${index}">
            <div class="party-score">
              <span class="fluent-emoji" data-emoji="party" style="width:14px;height:14px;"></span>
              <span>${partyLabel}</span>
            </div>
            <div class="market-card-header">
              <span class="market-question">${market.question}</span>
            </div>
            <div class="card-scores">
              <div class="card-score-row kalshi">
                <span class="card-source-label">KALSHI</span>
                <div class="card-progress-bar">
                  <div class="card-fill-yes" style="width: ${market.kalshiYes}%">
                    <span class="card-percent">${market.kalshiYes}%</span>
                  </div>
                  <div class="card-fill-no">
                    <span class="card-percent">${100 - market.kalshiYes}%</span>
                  </div>
                </div>
              </div>
              <div class="card-score-row party">
                <span class="card-source-label">PARTY</span>
                <div class="card-progress-bar">
                  <div class="card-fill-yes" style="width: ${market.partyYes}%">
                    <span class="card-percent">${market.partyYes}%</span>
                  </div>
                  <div class="card-fill-no">
                    <span class="card-percent">${100 - market.partyYes}%</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="market-footer">
              <div class="market-crowd">
                <div class="crowd-avatars">
                  ${[0,1,2].map(i => '<div class="mini-avatar" style="background-image: url(' + MEMBERS[(i + index) % MEMBERS.length].photo + '); background-size: cover;"></div>').join('')}
                </div>
                <span class="crowd-count">${market.count} in party</span>
              </div>
              <span class="market-volume">${market.volume} <span class="vol-label">VOL</span></span>
            </div>
          </div>
        `;
      }).join('');

      // Add click handlers
      document.querySelectorAll('.market-card').forEach(card => {
        card.addEventListener('click', () => {
          const marketIndex = parseInt(card.dataset.market);
          openMarket(marketIndex);
        });
      });
    }

    // ═══════════════════════════════════════════════════════════════
    // COUNTDOWN TIMER
    // ═══════════════════════════════════════════════════════════════
    let countdownInterval = null;

    function updateCountdown() {
      if (!currentMarket || !currentMarket.endDate) return;

      const now = new Date();
      const diff = currentMarket.endDate - now;

      if (diff <= 0) {
        document.getElementById('countdown-time').textContent = 'ENDED';
        const marqueeCountdown = document.getElementById('marquee-countdown-time');
        if (marqueeCountdown) marqueeCountdown.textContent = 'ENDED';
        return;
      }

      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

      let timeStr = '';
      if (days > 0) {
        timeStr = `${days}d ${hours}h`;
      } else if (hours > 0) {
        timeStr = `${hours}h ${mins}m`;
      } else {
        const secs = Math.floor((diff % (1000 * 60)) / 1000);
        timeStr = `${mins}m ${secs}s`;
      }

      document.getElementById('countdown-time').textContent = timeStr;
      // Also update marquee countdown
      const marqueeCountdown = document.getElementById('marquee-countdown-time');
      if (marqueeCountdown) marqueeCountdown.textContent = timeStr;
    }

    function startCountdown() {
      updateCountdown();
      if (countdownInterval) clearInterval(countdownInterval);
      countdownInterval = setInterval(updateCountdown, 1000);
    }

    function stopCountdown() {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }
    }

    // ═══════════════════════════════════════════════════════════════
    // RESPONSIVE HELPERS
    // ═══════════════════════════════════════════════════════════════
    function isDesktop() {
      return window.innerWidth >= 769;
    }

    function highlightActiveMarket(index) {
      // Remove active class from all cards
      document.querySelectorAll('.market-card').forEach(card => {
        card.classList.remove('active');
      });
      // Add active class to selected card
      const cards = document.querySelectorAll('.market-card');
      if (cards[index]) {
        cards[index].classList.add('active');
      }
    }

    // ═══════════════════════════════════════════════════════════════
    // HABBO 2026 — DYNAMIC "TETRIS" FLOOR TERRITORY
    // "The floor tells the story. 70% NO = 70% Pink territory." — Toshiro
    //
    // MINIMUM CLAMP: Even if YES is 1%, it gets 15% visual width (3 tiles)
    // so avatars can still stand there.
    // ═══════════════════════════════════════════════════════════════
    function setMarketRatio(yesPercentage) {
      const floor = document.getElementById('iso-floor');
      if (!floor) return;

      // THE WIDTH ALGORITHM — 20% MINIMUM (Minimum Viable Dancefloor!)
      // If yesPercentage = 2%, visual = 20% so dancers have room to dance
      // If yesPercentage = 98%, visual = 80% (so NO gets 20%)
      // Note: Display REAL text percentages on walls, but CHEAT the floor visuals for UX
      const MIN_WIDTH = 0.20; // 20% minimum for either zone — ROOM TO DANCE!
      const MAX_WIDTH = 1 - MIN_WIDTH; // 80% maximum

      let yesRatio = yesPercentage / 100;
      let noRatio = 1 - yesRatio;

      // Apply minimum clamp
      if (yesRatio < MIN_WIDTH) {
        yesRatio = MIN_WIDTH;
        noRatio = MAX_WIDTH;
      } else if (noRatio < MIN_WIDTH) {
        noRatio = MIN_WIDTH;
        yesRatio = MAX_WIDTH;
      }

      // Update CSS custom properties for dynamic flex sizing
      floor.style.setProperty('--yes-ratio', yesRatio);
      floor.style.setProperty('--no-ratio', noRatio);

      // Update wall screen stats (use ACTUAL percentages, not clamped)
      const wallYesOdds = document.getElementById('wall-yes-odds');
      const wallNoOdds = document.getElementById('wall-no-odds');
      const wallYesKalshi = document.getElementById('wall-yes-kalshi');
      const wallNoKalshi = document.getElementById('wall-no-kalshi');

      if (wallYesOdds) wallYesOdds.textContent = `${yesPercentage}%`;
      if (wallNoOdds) wallNoOdds.textContent = `${100 - yesPercentage}%`;
      if (wallYesKalshi) wallYesKalshi.textContent = `${yesPercentage}¢`;
      if (wallNoKalshi) wallNoKalshi.textContent = `${100 - yesPercentage}¢`;

      // PICTO-PARTY: Update HUD progress bar
      const hudProgressYes = document.getElementById('hud-progress-yes');
      const hudProgressNo = document.getElementById('hud-progress-no');
      if (hudProgressYes) hudProgressYes.style.width = `${yesPercentage}%`;
      if (hudProgressNo) hudProgressNo.style.width = `${100 - yesPercentage}%`;

      // PAPER MARIO: Update ceiling sign progress bar
      const signProgressYes = document.getElementById('sign-progress-yes');
      const signProgressNo = document.getElementById('sign-progress-no');
      if (signProgressYes) signProgressYes.style.width = `${yesPercentage}%`;
      if (signProgressNo) signProgressNo.style.width = `${100 - yesPercentage}%`;

      // HOLOGRAM: Update floating 3D labels above the crowd
      const hologramYesPct = document.getElementById('hologram-yes-pct');
      const hologramNoPct = document.getElementById('hologram-no-pct');
      if (hologramYesPct) hologramYesPct.textContent = `(${yesPercentage}%)`;
      if (hologramNoPct) hologramNoPct.textContent = `(${100 - yesPercentage}%)`;

      console.log(`[PICTO-PARTY] Market: ${yesPercentage}% YES → Floor: ${Math.round(yesRatio * 100)}% YES / ${Math.round(noRatio * 100)}% NO`);
    }

    // ═══════════════════════════════════════════════════════════════
    // OPEN MARKET (ARENA)
    // ═══════════════════════════════════════════════════════════════
    function openMarket(index) {
      currentMarket = MARKETS[index];

      // Mark that we have an active market (hides "Select a market" text)
      screenArena.classList.add('has-market');

      // Update arena UI
      document.getElementById('arena-title').textContent = currentMarket.question;

      // Update the epic marquee sign behind DJ booth!
      const marqueeQuestion = document.getElementById('marquee-question');
      if (marqueeQuestion) {
        marqueeQuestion.textContent = currentMarket.question;
      }
      // Update marquee stats + progress bars (Party)
      const yesPercent = currentMarket.partyYes;
      const noPercent = 100 - yesPercent;
      const marqueeYes = document.getElementById('marquee-yes-pct');
      const marqueeBarYes = document.getElementById('marquee-bar-yes');
      const marqueeBarNo = document.getElementById('marquee-bar-no');
      if (marqueeYes) marqueeYes.textContent = `${yesPercent}%`;
      if (marqueeBarYes) marqueeBarYes.style.width = `${yesPercent}%`;
      if (marqueeBarNo) marqueeBarNo.style.width = `${noPercent}%`;

      // Update marquee Kalshi bar
      const kalshiYes = currentMarket.kalshiYes;
      const kalshiNo = 100 - kalshiYes;
      const marqueeKalshiYes = document.getElementById('marquee-kalshi-yes');
      const marqueeKalshiNo = document.getElementById('marquee-kalshi-no');
      const marqueeKalshiPct = document.getElementById('marquee-kalshi-pct');
      if (marqueeKalshiYes) marqueeKalshiYes.style.width = `${kalshiYes}%`;
      if (marqueeKalshiNo) marqueeKalshiNo.style.width = `${kalshiNo}%`;
      if (marqueeKalshiPct) marqueeKalshiPct.textContent = `${kalshiYes}%`;

      // Update the JUMBOTRON (Toshiro's Stage Architecture!)
      const jumbotronQuestion = document.getElementById('jumbotron-question');
      const jumbotronYesPct = document.getElementById('jumbotron-yes-pct');
      const jumbotronNoPct = document.getElementById('jumbotron-no-pct');
      const jumbotronBarYes = document.getElementById('jumbotron-bar-yes');
      const jumbotronBarNo = document.getElementById('jumbotron-bar-no');
      if (jumbotronQuestion) jumbotronQuestion.textContent = currentMarket.question.toUpperCase();
      if (jumbotronYesPct) jumbotronYesPct.textContent = `${yesPercent}%`;
      if (jumbotronNoPct) jumbotronNoPct.textContent = `${noPercent}%`;
      if (jumbotronBarYes) jumbotronBarYes.style.width = `${yesPercent}%`;
      if (jumbotronBarNo) jumbotronBarNo.style.width = `${noPercent}%`;

      // ═══ HABBO 2026 — Update Isometric Jumbotron ═══
      const isoQuestion = document.getElementById('iso-jumbotron-question');
      const isoBarYes = document.getElementById('iso-bar-yes');
      const isoBarNo = document.getElementById('iso-bar-no');
      if (isoQuestion) isoQuestion.textContent = currentMarket.question.toUpperCase();
      if (isoBarYes) isoBarYes.style.width = `${yesPercent}%`;
      if (isoBarNo) isoBarNo.style.width = `${noPercent}%`;

      // Update progress bars with percentages
      document.getElementById('kalshi-yes').textContent = `${currentMarket.kalshiYes}%`;
      document.getElementById('kalshi-no').textContent = `${100 - currentMarket.kalshiYes}%`;
      document.getElementById('kalshi-bar-yes').style.width = `${currentMarket.kalshiYes}%`;

      document.getElementById('party-yes').textContent = `${currentMarket.partyYes}%`;
      document.getElementById('party-no').textContent = `${100 - currentMarket.partyYes}%`;
      document.getElementById('party-bar-yes').style.width = `${currentMarket.partyYes}%`;

      // ═══ HABBO 2026 — Dynamic floor territory based on market probability ═══
      setMarketRatio(yesPercent);

      // Start countdown timer
      startCountdown();

      // Populate crowds
      populateCrowds();

      // ═══ HABBO 2026 — Reset isometric player to starting position ═══
      playerTeam = null;
      if (isoPlayer) {
        isoPlayer.style.left = '50%';
        isoPlayer.style.bottom = '60px';
        isoPlayer.style.transform = 'translateX(-50%)';
        isoPlayer.style.zIndex = '';
        isoPlayer.classList.remove('lifted');
        isoPlayer.dataset.zone = '';
        delete isoPlayer.dataset.currentRow;
      }
      document.getElementById('player-dock').classList.remove('hidden');

      // Desktop vs Mobile behavior
      if (isDesktop()) {
        // Desktop: Keep sidebar visible, highlight selected market
        highlightActiveMarket(index);
        // Ensure arena is visible (CSS handles this, but make sure)
        screenArena.classList.add('active');
      } else {
        // Mobile: Full screen transition
        screenHome.classList.remove('active');
        screenArena.classList.add('active');
        tabBar.style.display = 'none';
      }

      // Start chat, disco, and BILLIE JEAN LIGHTING!
      startChat();
      startDiscoReflections();
      startBillieJeanLighting();
    }

    // ═══════════════════════════════════════════════════════════════
    // POPULATE CROWDS — One unique character per side for demo
    // ═══════════════════════════════════════════════════════════════
    // Grid-based positioning to prevent overlaps
    function calculateGridPositions(count, cols = 4) {
      const positions = [];
      const rows = Math.ceil(count / cols);
      const cellWidth = 80 / cols;  // 80% usable width (10% padding each side)
      const cellHeight = 80 / rows; // 80% usable height (10% padding each side)

      for (let i = 0; i < count; i++) {
        const row = Math.floor(i / cols);
        const col = i % cols;
        // Add small random offset within cell for organic feel (max 20% of cell)
        const jitterX = (Math.random() - 0.5) * cellWidth * 0.4;
        const jitterY = (Math.random() - 0.5) * cellHeight * 0.4;
        positions.push({
          x: 10 + col * cellWidth + cellWidth / 2 + jitterX,
          y: 10 + row * cellHeight + cellHeight / 2 + jitterY
        });
      }
      // Shuffle positions for variety
      return positions.sort(() => Math.random() - 0.5);
    }

    function populateCrowds() {
      const crowdNo = document.getElementById('crowd-no');
      const crowdYes = document.getElementById('crowd-yes');

      crowdNo.innerHTML = '';
      crowdYes.innerHTML = '';

      // Shuffle members for random distribution
      const shuffled = [...MEMBERS].sort(() => Math.random() - 0.5);

      // Split members between YES and NO - each person appears only ONCE
      const yesRatio = currentMarket.partyYes / 100;
      const splitIndex = Math.floor(shuffled.length * yesRatio);

      const yesMembers = shuffled.slice(0, splitIndex);
      const noMembers = shuffled.slice(splitIndex);

      // Calculate grid positions for each crowd (2-3 cols for narrower vertical zones)
      const yesPositions = calculateGridPositions(yesMembers.length, Math.min(3, Math.max(2, Math.ceil(Math.sqrt(yesMembers.length)))));
      const noPositions = calculateGridPositions(noMembers.length, Math.min(3, Math.max(2, Math.ceil(Math.sqrt(noMembers.length)))));

      // NO crowd - unique members only with grid positions
      noMembers.forEach((member, i) => {
        crowdNo.appendChild(createVillager(member, i, 'no', noPositions[i]));
      });

      // YES crowd - unique members only with grid positions
      yesMembers.forEach((member, i) => {
        crowdYes.appendChild(createVillager(member, i, 'yes', yesPositions[i]));
      });
    }

    // ═══════════════════════════════════════════════════════════════
    // AVATAR ENGINE — TG Group Members with Real Photos + Names
    // "This is a TG group prediction party! Show the REAL faces!" — Toshiro
    //
    // Uses member.photo from MEMBERS array, with stick figure fallback.
    // ═══════════════════════════════════════════════════════════════
    function createVillager(member, index, team, position) {
      const avatar = document.createElement('div');

      // 🕺 EPIC DANCES: 12 unique moves including shuffle & orange justice!
      const danceTypes = [
        'dance-bounce',    // Classic jump
        'dance-floss',     // Fortnite classic
        'dance-robot',     // Mechanical precision
        'dance-wave',      // Smooth body roll
        'dance-jumpjack',  // High energy
        'dance-headbang',  // Rock on!
        'dance-disco',     // Saturday Night Fever
        'dance-runman',    // Classic hip hop
        'dance-dab',       // Iconic move
        'dance-twist',     // Classic 60s
        'dance-shuffle',   // Melbourne Shuffle!
        'dance-orange'     // Orange Justice - Fortnite!
      ];
      const randomDance = danceTypes[Math.floor(Math.random() * danceTypes.length)];

      // Add bet-yes or bet-no class for outfit coloring, sky-drop for entrance
      const betClass = team === 'yes' ? 'bet-yes' : 'bet-no';
      avatar.className = `iso-avatar sky-drop ${randomDance} ${betClass}`;

      // Random animation delay for staggered sky drops and dancing
      const dropDelay = index * 0.08 + Math.random() * 0.2;
      const danceDelay = Math.random() * 2; // Desync the dancing
      avatar.style.animationDelay = `${dropDelay.toFixed(2)}s, ${danceDelay.toFixed(2)}s`;

      // Position within the crowd area
      const posX = position ? position.x : 50;
      const posY = position ? position.y : 50;
      avatar.style.left = `${posX}%`;
      avatar.style.top = `${posY}%`;

      // Z-index based on Y position (isometric depth)
      const zIndex = 10 + Math.floor(posY);
      avatar.style.zIndex = zIndex;

      // Random punctuation face for fallback
      const faces = ['happy', 'cool', 'angry', 'surprised', 'wink', 'smirk'];
      const randomFace = faces[Math.floor(Math.random() * faces.length)];

      // TG GROUP: Use member's real photo and name!
      const memberName = member?.name || `User ${index + 1}`;
      const memberPhoto = member?.photo || `/tg/user_${index + 1}.jpg`;

      // SPEECH BUBBLES: Funny vote messages! Way more personality!
      const yesPhrases = [
        'YES!', 'YAAAS!', 'LFG!', '🚀', 'WAGMI!', 'BET!',
        'SEND IT!', '100%!', 'MOON!', 'BULLISH!', 'LETS GO!',
        'FOR SURE!', 'OBVIOUSLY!', 'EASY!', 'LOCK IT!', 'BASED!'
      ];
      const noPhrases = [
        'NO!', 'NOPE!', 'NAH!', '💀', 'NGMI!', 'CAP!',
        'DOUBT!', 'BEARISH!', 'RIP!', 'FADE!', 'NO WAY!',
        'NEVER!', 'NOOOO!', 'PASS!', 'SELL!', 'REKT!'
      ];
      const phrases = team === 'yes' ? yesPhrases : noPhrases;
      const voteText = phrases[Math.floor(Math.random() * phrases.length)];

      avatar.innerHTML = `
        <div class="iso-avatar-sprite">
          <div class="iso-avatar-shadow"></div>
          <!-- SPEECH BUBBLE — Shows their vote! -->
          <div class="vote-name">${memberName}</div>
          <div class="vote-bubble">${voteText}</div>
          <div class="stick-head">
            <!-- TG Avatar Photo with onerror fallback -->
            <img
              src="${memberPhoto}"
              alt="${memberName}"
              class="avatar-photo"
              onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
            />
            <!-- Fallback: Stick Figure Face (hidden by default, shown on error) -->
            <span class="stick-face ${randomFace}" style="display: none;"></span>
          </div>
          <div class="stick-body"></div>
          <div class="stick-arms"></div>
          <div class="stick-legs"></div>
        </div>
      `;

      // Remove sky-drop class after animation completes (to allow dancing)
      setTimeout(() => {
        avatar.classList.remove('sky-drop');
      }, 600 + dropDelay * 1000);

      return avatar;
    }

    // ═══════════════════════════════════════════════════════════════
    // CHAT SYSTEM
    // ═══════════════════════════════════════════════════════════════
    let chatInterval = null;
    let chatIndex = 0;

    function startChat() {
      const container = document.getElementById('chat-container');
      if (!container) return; // Chat container may not exist

      container.innerHTML = '';
      chatIndex = 0;

      if (chatInterval) clearInterval(chatInterval);

      chatInterval = setInterval(() => {
        if (chatIndex >= CHAT_MESSAGES.length) {
          chatIndex = 0;
        }

        const msg = CHAT_MESSAGES[chatIndex];
        const bubble = document.createElement('div');
        bubble.className = `chat-bubble ${msg.side === 'right' ? 'right' : ''}`;
        bubble.innerHTML = `
          <div class="chat-name">${msg.name}</div>
          <div class="chat-text">${msg.text}</div>
        `;

        container.appendChild(bubble);

        // Remove old bubbles
        if (container.children.length > 3) {
          container.removeChild(container.firstChild);
        }

        chatIndex++;
      }, 3000);
    }

    function stopChat() {
      if (chatInterval) {
        clearInterval(chatInterval);
        chatInterval = null;
      }
    }

    // ═══════════════════════════════════════════════════════════════
    // TAB BAR
    // ═══════════════════════════════════════════════════════════════
    function setupTabBar() {
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');

          // Haptic feedback
          if (navigator.vibrate) navigator.vibrate(5);
        });
      });

      // Back button (original header)
      document.getElementById('back-btn').addEventListener('click', () => {
        if (isDesktop()) {
          // Desktop: Just clear selection (arena stays visible)
          document.querySelectorAll('.market-card').forEach(card => {
            card.classList.remove('active');
          });
        } else {
          // Mobile: Go back to home screen
          screenArena.classList.remove('active');
          screenHome.classList.add('active');
          tabBar.style.display = 'flex';
        }
        stopChat();
        stopCountdown();
        if (navigator.vibrate) navigator.vibrate(5);
      });

      // Roof back button (Toshiro's Stage Architecture)
      const roofBackBtn = document.getElementById('roof-back-btn');
      if (roofBackBtn) {
        roofBackBtn.addEventListener('click', () => {
          if (isDesktop()) {
            // Desktop: Just clear selection (arena stays visible)
            document.querySelectorAll('.market-card').forEach(card => {
              card.classList.remove('active');
            });
          } else {
            // Mobile: Go back to home screen
            screenArena.classList.remove('active');
            screenHome.classList.add('active');
            tabBar.style.display = 'flex';
          }
          stopChat();
          stopCountdown();
          if (navigator.vibrate) navigator.vibrate(5);
        });
      }

      // Markets button (same as back for now - goes to home)
      document.getElementById('markets-btn').addEventListener('click', () => {
        if (isDesktop()) {
          // Desktop: Just clear selection
          document.querySelectorAll('.market-card').forEach(card => {
            card.classList.remove('active');
          });
        } else {
          // Mobile: Go back to home screen
          screenArena.classList.remove('active');
          screenHome.classList.add('active');
          tabBar.style.display = 'flex';
        }
        stopChat();
        stopCountdown();
        if (navigator.vibrate) navigator.vibrate(5);
      });
    }

    // ═══════════════════════════════════════════════════════════════
    // VOTING
    // ═══════════════════════════════════════════════════════════════
    function setupVoting() {
      // Vote buttons may not exist (drag-and-drop is primary voting method now)
      const voteYes = document.getElementById('vote-yes');
      const voteNo = document.getElementById('vote-no');
      if (voteYes) voteYes.addEventListener('click', () => vote('yes'));
      if (voteNo) voteNo.addEventListener('click', () => vote('no'));
    }

    // Player speech reactions
    const PLAYER_REACTIONS = {
      yes: ['LFG! 🚀', 'bullish af', 'ez call', 'to the moon!', 'WAGMI', 'lets goooo', '100%', 'no doubt'],
      no: ['nah fam', 'its over', 'ded 💀', 'rekt incoming', 'sell sell sell', 'ngmi', 'bearish', 'dump it']
    };

    function showPlayerSpeech(side) {
      const speechEl = document.getElementById('player-speech');
      const reactions = PLAYER_REACTIONS[side];
      const reaction = reactions[Math.floor(Math.random() * reactions.length)];

      speechEl.textContent = reaction;
      speechEl.classList.add('visible');

      // Hide after 2.5 seconds
      setTimeout(() => {
        speechEl.classList.remove('visible');
      }, 2500);
    }

    function vote(side) {
      playerTeam = side;

      // Hide the dock when player moves to vote
      document.getElementById('player-dock').classList.add('hidden');

      // ═══ HABBO 2026 — Hop to random tile ═══
      const gridId = side === 'yes' ? 'iso-grid-yes' : 'iso-grid-no';
      const tiles = document.querySelectorAll(`#${gridId} .iso-tile`);

      if (tiles.length > 0 && isoRoom) {
        const randomTile = tiles[Math.floor(Math.random() * tiles.length)];
        const row = parseInt(randomTile.dataset.row) || 0;
        const tileRect = randomTile.getBoundingClientRect();
        const roomRect = isoRoom.getBoundingClientRect();

        const tileCenterX = tileRect.left - roomRect.left + tileRect.width / 2;
        const tileCenterY = roomRect.bottom - tileRect.top - tileRect.height / 2;

        isoPlayer.dataset.currentRow = row;
        isoPlayer.dataset.zone = side;
        isoPlayer.style.transition = 'all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)';
        isoPlayer.style.left = tileCenterX + 'px';
        isoPlayer.style.bottom = tileCenterY + 'px';
        isoPlayer.style.zIndex = 50 + row;

        // Flash the tile
        randomTile.classList.add(side === 'yes' ? 'flash-cyan' : 'flash-pink');
        setTimeout(() => {
          randomTile.classList.remove('flash-cyan', 'flash-pink');
          isoPlayer.style.transition = '';
        }, 350);
      }

      // Show player's reaction speech bubble
      showPlayerSpeech(side);

      // Show slide-to-confirm panel
      showSlidePanel(side);

      // Haptic
      if (navigator.vibrate) navigator.vibrate(20);
    }

    // ═══════════════════════════════════════════════════════════════
    // SLIDE-TO-CONFIRM — The iPhone-style Commitment
    // ═══════════════════════════════════════════════════════════════
    let slideIsDragging = false;
    let slideStartX = 0;
    let slideThumbEl, slideFillEl, slideTrackEl, slideSuccessEl;

    function setupSlideToConfirm() {
      slideThumbEl = document.getElementById('slide-thumb');
      slideFillEl = document.getElementById('slide-fill');
      slideTrackEl = document.getElementById('slide-track');
      slideSuccessEl = document.getElementById('slide-success');

      document.getElementById('panel-close').addEventListener('click', cancelBet);

      // Slide thumb drag - support both pointer and touch events
      slideThumbEl.addEventListener('pointerdown', startSlide);
      slideThumbEl.addEventListener('touchstart', startSlide, { passive: false });

      document.addEventListener('pointermove', moveSlide);
      document.addEventListener('touchmove', moveSlide, { passive: false });

      document.addEventListener('pointerup', endSlide);
      document.addEventListener('touchend', endSlide);
      document.addEventListener('touchcancel', endSlide);
    }

    function showSlidePanel(side) {
      const badge = document.getElementById('panel-badge');
      const whyInput = document.getElementById('panel-why-input');

      badge.textContent = side.toUpperCase();
      badge.className = `panel-side-badge ${side}`;
      slideThumbEl.className = `slide-thumb ${side}`;
      slideFillEl.className = `slide-track-fill ${side}`;
      whyInput.value = '';

      // Reset slider position (vertical)
      slideThumbEl.style.bottom = '4px';
      slideFillEl.style.height = '0%';
      slideSuccessEl.classList.remove('active');

      slidePanel.classList.add('active');
    }

    let slideStartY = 0;
    let slideCurrentY = 0;

    function startSlide(e) {
      e.preventDefault();
      slideIsDragging = true;
      slideStartY = e.clientY || (e.touches && e.touches[0].clientY);
      slideCurrentY = slideStartY;

      // Use setPointerCapture for better drag tracking
      if (e.pointerId !== undefined) {
        slideThumbEl.setPointerCapture(e.pointerId);
      }

      if (navigator.vibrate) navigator.vibrate(5);
    }

    function moveSlide(e) {
      if (!slideIsDragging) return;
      e.preventDefault();

      // Get Y position (support both pointer and touch)
      const clientY = e.clientY || (e.touches && e.touches[0].clientY);
      if (clientY === undefined) return;

      slideCurrentY = clientY;

      // Vertical swipe UP (negative Y direction)
      const trackHeight = slideTrackEl.offsetHeight - slideThumbEl.offsetHeight - 8;
      const deltaY = slideStartY - slideCurrentY; // Inverted for swipe UP
      const newBottom = Math.max(4, Math.min(4 + deltaY, trackHeight));
      const progress = (newBottom - 4) / trackHeight;

      slideThumbEl.style.bottom = `${newBottom}px`;
      slideFillEl.style.height = `${progress * 100}%`;

      // Check if we've reached the top
      if (progress >= 0.85) {
        confirmBet();
      }
    }

    function endSlide(e) {
      if (!slideIsDragging) return;
      slideIsDragging = false;

      // Spring back if not confirmed
      const trackHeight = slideTrackEl.offsetHeight - slideThumbEl.offsetHeight - 8;
      const currentBottom = parseFloat(slideThumbEl.style.bottom) || 4;
      const progress = (currentBottom - 4) / trackHeight;

      if (progress < 0.85) {
        // Spring back with Nintendo feel
        slideThumbEl.style.transition = `bottom 0.4s cubic-bezier(0.25, 1.5, 0.5, 1)`;
        slideFillEl.style.transition = `height 0.4s cubic-bezier(0.25, 1.5, 0.5, 1)`;
        slideThumbEl.style.bottom = '4px';
        slideFillEl.style.height = '0%';

        setTimeout(() => {
          slideThumbEl.style.transition = '';
          slideFillEl.style.transition = '';
        }, 400);
      }
    }

    function cancelBet() {
      slidePanel.classList.remove('active');

      // ═══ HABBO 2026 — Reset isometric player to start ═══
      playerTeam = null;
      if (isoPlayer) {
        isoPlayer.style.transition = 'all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)';
        isoPlayer.style.left = '50%';
        isoPlayer.style.bottom = '60px';
        isoPlayer.style.transform = 'translateX(-50%)';
        isoPlayer.style.zIndex = '';
        isoPlayer.classList.remove('lifted');
        isoPlayer.dataset.zone = '';
        delete isoPlayer.dataset.currentRow;

        setTimeout(() => {
          isoPlayer.style.transition = '';
        }, 400);
      }

      // Show the dock again
      document.getElementById('player-dock').classList.remove('hidden');

      if (navigator.vibrate) navigator.vibrate(10);
    }

    function confirmBet() {
      slideIsDragging = false;

      // Show success state on slider
      slideSuccessEl.classList.add('active');

      // Trigger celebration
      showCelebration();

      // Hide panel immediately, keep celebration visible
      setTimeout(() => {
        slidePanel.classList.remove('active');
        slideSuccessEl.classList.remove('active');
      }, 300);
    }

    // ═══════════════════════════════════════════════════════════════
    // NINTENDO CELEBRATION — The Epic Moment!
    // ═══════════════════════════════════════════════════════════════
    let lastVoteWasYes = true; // Track which zone for confetti color

    function showCelebration() {
      const celebration = document.getElementById('celebration');
      celebration.classList.add('active');

      // TOSHIRO'S JUMBOTRON FLASH — The screen lights up!
      flashJumbotron(lastVoteWasYes);

      // TOSHIRO'S CONFETTI — Explode from center of screen!
      const centerX = window.innerWidth / 2;
      const centerY = window.innerHeight / 2;
      triggerConfetti(centerX, centerY, lastVoteWasYes);
      // Fire a second burst slightly delayed for extra impact
      setTimeout(() => triggerConfetti(centerX, centerY, lastVoteWasYes), 150);

      // Nintendo-style haptic pattern: short-pause-long-pause-short
      if (navigator.vibrate) navigator.vibrate([30, 50, 100, 50, 30]);

      // Hide celebration after the epic moment
      setTimeout(() => {
        celebration.classList.remove('active');
      }, 2000);
    }

    // ═══════════════════════════════════════════════════════════════
    // TOSHIRO'S CONFETTI PARTICLE ENGINE — Vote Celebration!
    // 30 pixel-art squares explode upward with physics & rotation
    // ═══════════════════════════════════════════════════════════════
    function triggerConfetti(x, y, isYes = true) {
      const container = document.getElementById('confetti-container');
      if (!container) return;

      // YES = Cyan + White, NO = Hot Pink + Red
      const colors = isYes
        ? ['#4da6ff', '#00d4ff', '#ffffff', '#80e0ff']
        : ['#ff4b9b', '#ff3366', '#ff6090', '#ff0066'];

      const particleCount = 30;

      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'confetti-particle';
        particle.style.left = `${x}px`;
        particle.style.top = `${y}px`;
        particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        particle.style.width = `${6 + Math.random() * 6}px`;
        particle.style.height = `${6 + Math.random() * 6}px`;

        container.appendChild(particle);

        // Physics: random velocity, gravity, rotation
        const vx = (Math.random() - 0.5) * 20;
        const vy = -15 - Math.random() * 15; // Explode upward
        const gravity = 0.5;
        const drag = 0.98;
        const rotationSpeed = (Math.random() - 0.5) * 20;
        let rotation = Math.random() * 360;
        let posX = 0;
        let posY = 0;
        let velX = vx;
        let velY = vy;
        let opacity = 1;

        function animateParticle() {
          velX *= drag;
          velY += gravity;
          velY *= drag;
          posX += velX;
          posY += velY;
          rotation += rotationSpeed;
          opacity -= 0.015;

          particle.style.transform = `translate(${posX}px, ${posY}px) rotate(${rotation}deg)`;
          particle.style.opacity = opacity;

          if (opacity > 0) {
            requestAnimationFrame(animateParticle);
          } else {
            particle.remove();
          }
        }

        requestAnimationFrame(animateParticle);
      }

      // Haptic feedback
      if (navigator.vibrate) navigator.vibrate(20);
    }

    // ═══════════════════════════════════════════════════════════════
    // JUMBOTRON FLASH — Bet Drop Celebration!
    // ═══════════════════════════════════════════════════════════════
    function flashJumbotron(isYes = true) {
      const flashEl = isYes
        ? document.getElementById('jumbotron-flash-yes')
        : document.getElementById('jumbotron-flash-no');
      if (!flashEl) return;

      // Remove and re-add class to restart animation
      flashEl.classList.remove('active');
      void flashEl.offsetWidth; // Force reflow
      flashEl.classList.add('active');

      // Clean up after animation
      setTimeout(() => flashEl.classList.remove('active'), 600);
    }

    // ═══════════════════════════════════════════════════════════════
    // DISCO BALL REFLECTIONS
    // ═══════════════════════════════════════════════════════════════
    let discoInterval = null;

    function createDiscoReflections() {
      const container = document.getElementById('disco-reflections');
      if (!container) return;

      // Create initial dots
      for (let i = 0; i < 15; i++) {
        createDiscoDot(container, i * 0.5);
      }
    }

    function createDiscoDot(container, delay = 0) {
      const dot = document.createElement('div');
      dot.className = 'disco-dot';
      dot.style.left = `${Math.random() * 100}%`;
      dot.style.animationDelay = `${delay}s`;
      dot.style.animationDuration = `${6 + Math.random() * 4}s`;

      // Random colors
      const colors = ['rgba(0, 245, 255, 0.8)', 'rgba(255, 0, 128, 0.8)', 'rgba(255, 215, 0, 0.8)', 'rgba(191, 0, 255, 0.8)', 'rgba(255, 255, 255, 0.9)'];
      dot.style.background = colors[Math.floor(Math.random() * colors.length)];

      container.appendChild(dot);

      // Remove and recreate after animation
      dot.addEventListener('animationend', () => {
        dot.remove();
        createDiscoDot(container, 0);
      });
    }

    function startDiscoReflections() {
      // Disco is always running via CSS animations
    }

    // ═══════════════════════════════════════════════════════════════
    // TOSHIRO'S "BILLIE JEAN" TILE LIGHTING ENGINE
    // Random tiles flash at 128 BPM — Pure disco energy!
    // ═══════════════════════════════════════════════════════════════
    let billieJeanInterval = null;

    function startBillieJeanLighting() {
      // Already running?
      if (billieJeanInterval) return;

      const yesTiles = document.querySelectorAll('#iso-grid-yes .iso-tile');
      const noTiles = document.querySelectorAll('#iso-grid-no .iso-tile');

      if (yesTiles.length === 0 && noTiles.length === 0) return;

      // 128 BPM = 468.75ms per beat, flash every beat
      const beatMs = 60000 / 128;

      billieJeanInterval = setInterval(() => {
        // Flash 2-4 random tiles in YES zone (cyan)
        const yesFlashCount = 2 + Math.floor(Math.random() * 3);
        for (let i = 0; i < yesFlashCount; i++) {
          const randomTile = yesTiles[Math.floor(Math.random() * yesTiles.length)];
          if (randomTile && !randomTile.classList.contains('flash-cyan')) {
            randomTile.classList.add('flash-cyan');
            // Remove flash after transition
            setTimeout(() => randomTile.classList.remove('flash-cyan'), 200);
          }
        }

        // Flash 2-4 random tiles in NO zone (pink)
        const noFlashCount = 2 + Math.floor(Math.random() * 3);
        for (let i = 0; i < noFlashCount; i++) {
          const randomTile = noTiles[Math.floor(Math.random() * noTiles.length)];
          if (randomTile && !randomTile.classList.contains('flash-pink')) {
            randomTile.classList.add('flash-pink');
            // Remove flash after transition
            setTimeout(() => randomTile.classList.remove('flash-pink'), 200);
          }
        }
      }, beatMs);

      console.log('🪩 Billie Jean lighting ACTIVATED at 128 BPM!');
    }

    function stopBillieJeanLighting() {
      if (billieJeanInterval) {
        clearInterval(billieJeanInterval);
        billieJeanInterval = null;
        // Clear all flashing tiles
        document.querySelectorAll('.iso-tile.flash-cyan, .iso-tile.flash-pink').forEach(tile => {
          tile.classList.remove('flash-cyan', 'flash-pink');
        });
      }
    }

    // ═══════════════════════════════════════════════════════════════
    // HABBO 2026 — LIFT-AND-DROP DRAG PHYSICS
    // Avatar lifts off the isometric grid, shadow stays on floor
    // ═══════════════════════════════════════════════════════════════
    function setupDragging() {
      console.log('🎮 Setting up HABBO 2026 drag system...');

      let pendingVote = null;
      let isDragging = false;
      let startX = 0;
      let startY = 0;
      let currentX = 0;
      let currentY = 0;

      const ZONE_THRESHOLD = 0.25;

      // Confirmation popup elements
      const dropConfirm = document.getElementById('drop-confirm');
      const dropConfirmSide = document.getElementById('drop-confirm-side');
      const dropConfirmQuestion = document.getElementById('drop-confirm-question');
      const dropConfirmCancel = document.getElementById('drop-confirm-cancel');
      const dropConfirmYes = document.getElementById('drop-confirm-yes');

      // Position player at starting position (bottom center of room)
      function resetPlayerToStart() {
        isoPlayer.style.left = '50%';
        isoPlayer.style.bottom = '60px';
        isoPlayer.style.transform = 'translateX(-50%)';
        isoPlayer.classList.remove('lifted');
        isoPlayer.dataset.zone = '';
      }

      // Initialize player position
      resetPlayerToStart();

      // Get touch/mouse position
      function getEventPos(e) {
        if (e.touches && e.touches.length > 0) {
          return { x: e.touches[0].clientX, y: e.touches[0].clientY };
        }
        return { x: e.clientX, y: e.clientY };
      }

      // ═══ DRAG START — Lift the avatar off the grid ═══
      function onDragStart(e) {
        e.preventDefault();
        e.stopPropagation();

        if (isDragging) return;
        isDragging = true;

        const pos = getEventPos(e);
        startX = pos.x;
        startY = pos.y;

        // Get current position
        const rect = isoPlayer.getBoundingClientRect();
        const parentRect = isoRoom.getBoundingClientRect();
        currentX = rect.left - parentRect.left + rect.width / 2;
        currentY = parentRect.bottom - rect.bottom;

        // LIFT the avatar — shadow stays on floor (CSS handles this)
        isoPlayer.classList.add('lifted');
        isoPlayer.style.transition = 'none';
        isoPlayer.style.left = currentX + 'px';
        isoPlayer.style.bottom = currentY + 'px';
        isoPlayer.style.transform = 'translateX(-50%)';

        document.getElementById('player-dock').classList.add('hidden');

        // Haptic lift
        if (navigator.vibrate) navigator.vibrate(10);

        console.log('🎮 Avatar LIFTED! Ready to drag.');
      }

      // ═══ DRAG MOVE — Float the avatar ═══
      // PAPER MARIO: Using elementFromPoint raycasting for proper isometric hit detection
      function onDragMove(e) {
        if (!isDragging) return;
        e.preventDefault();

        const pos = getEventPos(e);
        const deltaX = pos.x - startX;
        const deltaY = pos.y - startY;

        // Move the lifted avatar
        const newX = currentX + deltaX;
        const newY = currentY - deltaY;

        isoPlayer.style.left = newX + 'px';
        isoPlayer.style.bottom = newY + 'px';

        // PAPER MARIO: Zone detection using elementFromPoint raycasting
        // Hide the player temporarily so we can see what's underneath
        const playerDisplay = isoPlayer.style.pointerEvents;
        isoPlayer.style.pointerEvents = 'none';

        const elementUnder = document.elementFromPoint(pos.x, pos.y);

        // Restore pointer events
        isoPlayer.style.pointerEvents = playerDisplay;

        // Check if element is within NO zone or YES zone
        const isOverNo = elementUnder && (
          elementUnder.closest('#floor-no') ||
          elementUnder.closest('.floor-zone.no-zone')
        );
        const isOverYes = elementUnder && (
          elementUnder.closest('#floor-yes') ||
          elementUnder.closest('.floor-zone.yes-zone')
        );

        // Highlight zones with WHITE glow as player hovers over them
        if (isOverNo) {
          zoneNo.classList.add('hovering');
          zoneYes.classList.remove('hovering');
        } else if (isOverYes) {
          zoneYes.classList.add('hovering');
          zoneNo.classList.remove('hovering');
        } else {
          zoneNo.classList.remove('hovering');
          zoneYes.classList.remove('hovering');
        }
      }

      // ═══ FIND NEAREST TILE — For grid snapping ═══
      function findNearestTile(screenX, screenY, zoneSide) {
        const gridId = zoneSide === 'yes' ? 'iso-grid-yes' : 'iso-grid-no';
        const tiles = document.querySelectorAll(`#${gridId} .iso-tile`);
        if (!tiles.length) return null;

        let nearestTile = null;
        let nearestDist = Infinity;

        tiles.forEach(tile => {
          const rect = tile.getBoundingClientRect();
          const tileCenterX = rect.left + rect.width / 2;
          const tileCenterY = rect.top + rect.height / 2;
          const dist = Math.sqrt(
            Math.pow(screenX - tileCenterX, 2) +
            Math.pow(screenY - tileCenterY, 2)
          );
          if (dist < nearestDist) {
            nearestDist = dist;
            nearestTile = tile;
          }
        });

        return nearestTile;
      }

      // ═══ HOP TO TILE — Avatar "hops" into place ═══
      function hopToTile(tile, zoneSide) {
        if (!tile) return;

        const row = parseInt(tile.dataset.row) || 0;
        const tileRect = tile.getBoundingClientRect();
        const roomRect = isoRoom.getBoundingClientRect();

        // Calculate tile center relative to room
        const tileCenterX = tileRect.left - roomRect.left + tileRect.width / 2;
        const tileCenterY = roomRect.bottom - tileRect.top - tileRect.height / 2;

        // Store tile data
        isoPlayer.dataset.currentRow = row;
        isoPlayer.dataset.zone = zoneSide;

        // DROP animation — player "hops" down onto tile
        isoPlayer.classList.remove('lifted');
        isoPlayer.style.transition = 'all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1)';
        isoPlayer.style.left = tileCenterX + 'px';
        isoPlayer.style.bottom = tileCenterY + 'px';

        // Z-index based on row (isometric depth)
        isoPlayer.style.zIndex = 50 + row;

        // Flash the landing tile
        tile.classList.add(zoneSide === 'yes' ? 'flash-cyan' : 'flash-pink');
        setTimeout(() => {
          tile.classList.remove('flash-cyan', 'flash-pink');
          isoPlayer.style.transition = '';
        }, 350);

        console.log(`🎮 Hopped to tile row ${row} in ${zoneSide} zone!`);
      }

      // ═══ DRAG END — Drop the avatar ═══
      // PAPER MARIO: Using elementFromPoint raycasting for proper isometric hit detection
      function onDragEnd(e) {
        if (!isDragging) return;
        isDragging = false;

        // Get final position for zone detection
        const rect = isoPlayer.getBoundingClientRect();
        const screenX = rect.left + rect.width / 2;
        const screenY = rect.top + rect.height / 2;

        // PAPER MARIO: Use elementFromPoint raycasting for accurate zone detection
        isoPlayer.style.pointerEvents = 'none';
        const elementUnder = document.elementFromPoint(screenX, screenY);
        isoPlayer.style.pointerEvents = '';

        const isOverNo = elementUnder && (
          elementUnder.closest('#floor-no') ||
          elementUnder.closest('.floor-zone.no-zone')
        );
        const isOverYes = elementUnder && (
          elementUnder.closest('#floor-yes') ||
          elementUnder.closest('.floor-zone.yes-zone')
        );

        console.log('🎮 DROP! elementFromPoint:', elementUnder?.className, 'NO:', isOverNo, 'YES:', isOverYes);

        // Clear zone hover states
        zoneNo.classList.remove('hovering');
        zoneYes.classList.remove('hovering');

        // Determine vote based on elementFromPoint raycasting
        let targetVote = null;
        if (isOverNo) {
          targetVote = 'no';
        } else if (isOverYes) {
          targetVote = 'yes';
        }

        if (targetVote) {
          pendingVote = targetVote;
          lastVoteWasYes = (targetVote === 'yes');

          // Find nearest tile and HOP to it
          const nearestTile = findNearestTile(screenX, screenY, targetVote);
          if (nearestTile) {
            hopToTile(nearestTile, targetVote);
          } else {
            // Fallback — just drop in place
            isoPlayer.classList.remove('lifted');
          }

          // Show confirmation popup
          showDropConfirm(targetVote);
          if (navigator.vibrate) navigator.vibrate([15, 40, 25]);
        } else {
          // Not in a zone — snap back to start
          snapBackToStart();
        }
      }

      // ═══ SNAP BACK TO START ═══
      function snapBackToStart() {
        isoPlayer.style.transition = 'all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)';
        resetPlayerToStart();

        setTimeout(() => {
          isoPlayer.style.transition = '';
        }, 400);

        playerTeam = null;
        document.getElementById('player-dock').classList.remove('hidden');
        if (navigator.vibrate) navigator.vibrate(12);
      }

      // ═══ CONFIRMATION POPUP ═══
      function showDropConfirm(side) {
        dropConfirmSide.textContent = side.toUpperCase();
        dropConfirmSide.className = `drop-confirm-side ${side}`;
        dropConfirmQuestion.textContent = `Lock in your ${side.toUpperCase()} position?`;
        document.getElementById('drop-confirm-yes').className = `drop-confirm-btn confirm ${side === 'no' ? 'no-side' : ''}`;
        dropConfirm.classList.add('active');
        if (navigator.vibrate) navigator.vibrate(10);
      }

      dropConfirmCancel.addEventListener('click', () => {
        dropConfirm.classList.remove('active');
        pendingVote = null;
        snapBackToStart();
      });

      dropConfirmYes.addEventListener('click', () => {
        dropConfirm.classList.remove('active');
        if (pendingVote) {
          playerTeam = pendingVote;
          showPlayerSpeech(pendingVote);
          showCelebration();
          if (navigator.vibrate) navigator.vibrate([20, 50, 30, 50, 40]);
        }
        pendingVote = null;
      });

      // ═══ EVENT LISTENERS — Attach to isometric player ═══
      isoPlayer.addEventListener('touchstart', onDragStart, { passive: false });
      document.addEventListener('touchmove', onDragMove, { passive: false });
      document.addEventListener('touchend', onDragEnd);
      document.addEventListener('touchcancel', onDragEnd);

      isoPlayer.addEventListener('mousedown', onDragStart);
      document.addEventListener('mousemove', onDragMove);
      document.addEventListener('mouseup', onDragEnd);

      console.log('🎮 HABBO 2026 drag system ready! Lift and drop your avatar.');
    }

    // ═══════════════════════════════════════════════════════════════
    // START
    // ═══════════════════════════════════════════════════════════════
    init();
  </script>
</body>
</html>
